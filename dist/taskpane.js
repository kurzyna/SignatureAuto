/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={80517:function(e,t,n){e.exports=n.p+"assets/akmf_logo.png"},81499:function(e,t,n){e.exports=n.p+"2cd9c3ad0512e6fd05bf.css"},58394:function(e,t,n){e.exports=n.p+"5231ba6eddae75f86207.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(t,n,r){return(n=function(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}var o,i={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},a=[i.OPENID_SCOPE,i.PROFILE_SCOPE,i.OFFLINE_ACCESS_SCOPE],c=[].concat(a,[i.EMAIL_SCOPE]),u="Retry-After",s="X-AnchorMailbox",l="x-ms-request-id",f="idtoken",p="client.info",h="adal.idtoken",d="error",y="error.description",v="active-account",m="active-account-filters",g="common",b="organizations",w="consumers",k="access_token",S={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},O={PLAIN:"plain",S256:"S256"},C={QUERY:"query",FRAGMENT:"fragment"},T=n(n({},C),{},{FORM_POST:"form_post"}),A="Generic",I={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},P={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},x="appmetadata",E="1",j="authority-metadata",_="config",R="cache",N="network",M="hardcoded_values",q={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},G={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},F="throttling";function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,D(r.key),r)}}function D(e){var t=function(e){if("object"!=B(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==B(t)?t:t+""}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(o||(o={}));var U=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=o.Info;var a=t||e.createDefaultLoggerOptions();this.localCallback=a.loggerCallback||function(){},this.piiLoggingEnabled=a.piiLoggingEnabled||!1,this.level="number"==typeof a.logLevel?a.logLevel:o.Info,this.correlationId=a.correlationId||i.EMPTY_STRING,this.packageName=n||i.EMPTY_STRING,this.packageVersion=r||i.EMPTY_STRING}return t=e,r=[{key:"createDefaultLoggerOptions",value:function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:o.Info}}}],(n=[{key:"clone",value:function(t,n,r){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},t,n)}},{key:"logMessage",value:function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var n=(new Date).toUTCString(),r="[".concat(n,"] : [").concat(t.correlationId||this.correlationId||"","]"),i="".concat(r," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(o[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,i,t.containsPii||!1)}}},{key:"executeCallback",value:function(e,t,n){this.localCallback&&this.localCallback(e,t,n)}},{key:"error",value:function(e,t){this.logMessage(e,{logLevel:o.Error,containsPii:!1,correlationId:t||i.EMPTY_STRING})}},{key:"errorPii",value:function(e,t){this.logMessage(e,{logLevel:o.Error,containsPii:!0,correlationId:t||i.EMPTY_STRING})}},{key:"warning",value:function(e,t){this.logMessage(e,{logLevel:o.Warning,containsPii:!1,correlationId:t||i.EMPTY_STRING})}},{key:"warningPii",value:function(e,t){this.logMessage(e,{logLevel:o.Warning,containsPii:!0,correlationId:t||i.EMPTY_STRING})}},{key:"info",value:function(e,t){this.logMessage(e,{logLevel:o.Info,containsPii:!1,correlationId:t||i.EMPTY_STRING})}},{key:"infoPii",value:function(e,t){this.logMessage(e,{logLevel:o.Info,containsPii:!0,correlationId:t||i.EMPTY_STRING})}},{key:"verbose",value:function(e,t){this.logMessage(e,{logLevel:o.Verbose,containsPii:!1,correlationId:t||i.EMPTY_STRING})}},{key:"verbosePii",value:function(e,t){this.logMessage(e,{logLevel:o.Verbose,containsPii:!0,correlationId:t||i.EMPTY_STRING})}},{key:"trace",value:function(e,t){this.logMessage(e,{logLevel:o.Trace,containsPii:!1,correlationId:t||i.EMPTY_STRING})}},{key:"tracePii",value:function(e,t){this.logMessage(e,{logLevel:o.Trace,containsPii:!0,correlationId:t||i.EMPTY_STRING})}},{key:"isPiiLoggingEnabled",value:function(){return this.piiLoggingEnabled||!1}}])&&H(t.prototype,n),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}(),L="AAD",K="OIDC",z="none",Q="unexpected_error",W="post_request_failed";function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,te(r.key),r)}}function J(e){var t="function"==typeof Map?new Map:void 0;return J=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(Z())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&X(o,n.prototype),o}(e,arguments,$(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),X(n,e)},J(e)}function Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Z=function(){return!!e})()}function X(e,t){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},X(e,t)}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}function ee(e,t,n){return(t=te(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e){var t=function(e){if("object"!=Y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Y(t)?t:t+""}var ne=ee(ee({},Q,"Unexpected error in authentication."),W,"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."),re=(ne[Q],ne[W],function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t,n){return t=$(t),function(e,t){if(t&&("object"==Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Z()?Reflect.construct(t,n||[],$(e).constructor):t.apply(e,n))}(this,t,[n?"".concat(e,": ").concat(n):e]),Object.setPrototypeOf(o,t.prototype),o.errorCode=e||i.EMPTY_STRING,o.errorMessage=n||i.EMPTY_STRING,o.subError=r||i.EMPTY_STRING,o.name="AuthError",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(t,e),n=t,(r=[{key:"setCorrelationId",value:function(e){this.correlationId=e}}])&&V(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(J(Error)));function oe(e,t){return new re(e,t?"".concat(ne[e]," ").concat(t):ne[e])}var ie,ae="client_info_decoding_error",ce="client_info_empty_error",ue="token_parsing_error",se="null_or_empty_token",le="endpoints_resolution_error",fe="network_error",pe="openid_config_error",he="hash_not_deserialized",de="invalid_state",ye="state_mismatch",ve="state_not_found",me="nonce_mismatch",ge="auth_time_not_found",be="max_age_transpired",we="multiple_matching_tokens",ke="multiple_matching_accounts",Se="multiple_matching_appMetadata",Oe="request_cannot_be_made",Ce="cannot_remove_empty_scope",Te="cannot_append_scopeset",Ae="empty_input_scopeset",Ie="device_code_polling_cancelled",Pe="device_code_expired",xe="device_code_unknown_error",Ee="no_account_in_silent_request",je="invalid_cache_record",_e="invalid_cache_environment",Re="no_account_found",Ne="no_crypto_object",Me="unexpected_credential_type",qe="invalid_assertion",Ge="invalid_client_credential",Fe="token_refresh_required",Be="user_timeout_reached",He="token_claims_cnf_required_for_signedjwt",De="authorization_code_missing_from_server_response",Ue="binding_key_not_removed",Le="end_session_endpoint_not_supported",Ke="key_id_missing",ze="no_network_connectivity",Qe="user_canceled",We="missing_tenant_id_error",Ye="method_not_implemented",Ve="nested_app_auth_bridge_disabled";function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Ze(e,t,n){return t=$e(t),function(e,t){if(t&&("object"==Je(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Xe()?Reflect.construct(t,n||[],$e(e).constructor):t.apply(e,n))}function Xe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Xe=function(){return!!e})()}function $e(e){return $e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$e(e)}function et(e,t){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},et(e,t)}function tt(e,t,n){return(t=nt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nt(e){var t=function(e){if("object"!=Je(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Je(t)?t:t+""}var rt=(tt(tt(tt(tt(tt(tt(tt(tt(tt(tt(ie={},ae,"The client info could not be parsed/decoded correctly"),ce,"The client info was empty"),ue,"Token cannot be parsed"),se,"The token is null or empty"),le,"Endpoints cannot be resolved"),fe,"Network request failed"),pe,"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."),he,"The hash parameters could not be deserialized"),de,"State was not the expected format"),ye,"State mismatch error"),tt(tt(tt(tt(tt(tt(tt(tt(tt(tt(ie,ve,"State not found"),me,"Nonce mismatch error"),ge,"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."),be,"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."),we,"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."),ke,"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"),Se,"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"),Oe,"Token request cannot be made without authorization code or refresh token."),Ce,"Cannot remove null or empty scope from ScopeSet"),Te,"Cannot append ScopeSet"),tt(tt(tt(tt(tt(tt(tt(tt(tt(tt(ie,Ae,"Empty input ScopeSet cannot be processed"),Ie,"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."),Pe,"Device code is expired."),xe,"Device code stopped polling for unknown reasons."),Ee,"Please pass an account object, silent flow is not supported without account information"),je,"Cache record object was null or undefined."),_e,"Invalid environment when attempting to create cache entry"),Re,"No account found in cache for given key."),Ne,"No crypto object detected."),Me,"Unexpected credential type."),tt(tt(tt(tt(tt(tt(tt(tt(tt(tt(ie,qe,"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"),Ge,"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"),Fe,"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."),Be,"User defined timeout for device code polling reached"),He,"Cannot generate a POP jwt if the token_claims are not populated"),De,"Server response does not contain an authorization code to proceed"),Ue,"Could not remove the credential's binding key from storage."),Le,"The provided authority does not support logout"),Ke,"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."),ze,"No network connectivity. Check your internet connection."),tt(tt(tt(tt(ie,Qe,"User cancelled the flow."),We,"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow."),Ye,"This method has not been implemented"),Ve,"The nested app auth bridge is disabled")),ot=(rt[ae],rt[ce],rt[ue],rt[se],rt[le],rt[fe],rt[pe],rt[he],rt[de],rt[ye],rt[ve],rt[me],rt[ge],rt[be],rt[we],rt[ke],rt[Se],rt[Oe],rt[Ce],rt[Te],rt[Ae],rt[Ie],rt[Pe],rt[xe],rt[Ee],rt[je],rt[_e],rt[Re],rt[Ne],rt[Me],rt[qe],rt[Ge],rt[Fe],rt[Be],rt[He],rt[De],rt[Ue],rt[Le],rt[Ke],rt[ze],rt[Qe],rt[We],rt[Ve],function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Ze(this,t,[e,n?"".concat(rt[e],": ").concat(n):rt[e]])).name="ClientAuthError",Object.setPrototypeOf(r,t.prototype),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&et(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(re));function it(e,t){return new ot(e,t)}function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function ct(){var e=ht(),t=e.m(ct),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,ut(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ct=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new yt(e,t)},AsyncIterator:pt,async:function(e,t,n,o,a){return(r(t)?ft:lt)(i(e),t,n,o,a)},keys:st,values:ut}})()}function ut(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(at(e)+" is not iterable")}function st(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function lt(e,t,n,r,o){var i=ft(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function ft(e,t,n,r,o){return new pt(ht().w(e,t,n,r),o||Promise)}function pt(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof yt?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(dt(pt.prototype),dt(pt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),dt(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function ht(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return dt(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(dt(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,dt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,dt(f,"constructor",s),dt(s,"constructor",u),u.displayName="GeneratorFunction",dt(s,o,"GeneratorFunction"),dt(f),dt(f,o,"Generator"),dt(f,r,(function(){return this})),dt(f,"toString",(function(){return"[object Generator]"})),(ht=function(){return{w:i,m:p}})()}function dt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}dt=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){dt(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},dt(e,t,n,r)}function yt(e,t){this.v=e,this.k=t}function vt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function mt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){vt(i,r,o,a,c,"next",e)}function c(e){vt(i,r,o,a,c,"throw",e)}a(void 0)}))}}var gt={createNewGuid:function(){throw it(Ye)},base64Decode:function(){throw it(Ye)},base64Encode:function(){throw it(Ye)},base64UrlEncode:function(){throw it(Ye)},encodeKid:function(){throw it(Ye)},getPublicKeyThumbprint:function(){return mt(ct().mark((function e(){return ct().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)})))()},removeTokenBindingKey:function(){return mt(ct().mark((function e(){return ct().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)})))()},clearKeystore:function(){return mt(ct().mark((function e(){return ct().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)})))()},signJwt:function(){return mt(ct().mark((function e(){return ct().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)})))()},hashString:function(){return mt(ct().mark((function e(){return ct().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)})))()}},bt="@azure/msal-common",wt="14.15.0";function kt(e,t){var n=function(e){if(!e)throw it(se);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw it(ue);return t[2]}(e);try{var r=t(n);return JSON.parse(r)}catch(e){throw it(ue)}}function St(e,t){if(0===t||Date.now()-3e5>e+t)throw it(be)}function Ot(){return Math.round((new Date).getTime()/1e3)}function Ct(e,t){var n=Number(e)||0;return Ot()+t>n}function Tt(e){return Number(e)>Ot()}function At(e){return[Nt(e),Mt(e),qt(e),Gt(e),Ft(e)].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}function It(e,t,n,r,o){return{credentialType:P.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:o}}function Pt(e,t,n,r,o,i,a,c,u,s,l,f,p,h,d){var y,v,m={homeAccountId:e,credentialType:P.ACCESS_TOKEN,secret:n,cachedAt:Ot().toString(),expiresOn:a.toString(),extendedExpiresOn:c.toString(),environment:t,clientId:r,realm:o,target:i,tokenType:l||G.BEARER};if(f&&(m.userAssertionHash=f),s&&(m.refreshOn=s.toString()),h&&(m.requestedClaims=h,m.requestedClaimsHash=d),(null===(y=m.tokenType)||void 0===y?void 0:y.toLowerCase())!==G.BEARER.toLowerCase())switch(m.credentialType=P.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case G.POP:var g=kt(n,u);if(null==g||null===(v=g.cnf)||void 0===v||!v.kid)throw it(He);m.keyId=g.cnf.kid;break;case G.SSH:m.keyId=p}return m}function xt(e,t,n,r,o,i,a){var c={credentialType:P.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n};return i&&(c.userAssertionHash=i),o&&(c.familyId=o),a&&(c.expiresOn=a.toString()),c}function Et(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function jt(e){return!!e&&Et(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===P.ACCESS_TOKEN||e.credentialType===P.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function _t(e){return!!e&&Et(e)&&e.hasOwnProperty("realm")&&e.credentialType===P.ID_TOKEN}function Rt(e){return!!e&&Et(e)&&e.credentialType===P.REFRESH_TOKEN}function Nt(e){return[e.homeAccountId,e.environment].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}function Mt(e){var t=e.credentialType===P.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}function qt(e){return(e.target||"").toLowerCase()}function Gt(e){return(e.requestedClaimsHash||"").toLowerCase()}function Ft(e){return e.tokenType&&e.tokenType.toLowerCase()!==G.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function Bt(){return Ot()+86400}function Ht(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function Dt(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function Ut(e){return e.expiresAt<=Ot()}var Lt,Kt="redirect_uri_empty",zt="claims_request_parsing_error",Qt="authority_uri_insecure",Wt="url_parse_error",Yt="empty_url_error",Vt="empty_input_scopes_error",Jt="invalid_prompt_value",Zt="invalid_claims",Xt="token_request_empty",$t="logout_request_empty",en="invalid_code_challenge_method",tn="pkce_params_missing",nn="invalid_cloud_discovery_metadata",rn="invalid_authority_metadata",on="untrusted_authority",an="missing_ssh_jwk",cn="missing_ssh_kid",un="missing_nonce_authentication_header",sn="invalid_authentication_header",ln="cannot_set_OIDCOptions",fn="cannot_allow_native_broker",pn="authority_mismatch";function hn(e){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(e)}function dn(e,t,n){return t=vn(t),function(e,t){if(t&&("object"==hn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,yn()?Reflect.construct(t,n||[],vn(e).constructor):t.apply(e,n))}function yn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yn=function(){return!!e})()}function vn(e){return vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vn(e)}function mn(e,t){return mn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mn(e,t)}function gn(e,t,n){return(t=bn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bn(e){var t=function(e){if("object"!=hn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==hn(t)?t:t+""}var wn=(gn(gn(gn(gn(gn(gn(gn(gn(gn(gn(Lt={},Kt,"A redirect URI is required for all calls, and none has been set."),zt,"Could not parse the given claims request object."),Qt,"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"),Wt,"URL could not be parsed into appropriate segments."),Yt,"URL was empty or null."),Vt,"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."),Jt,"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"),Zt,"Given claims parameter must be a stringified JSON object."),Xt,"Token request was empty and not found in cache."),$t,"The logout request was null or undefined."),gn(gn(gn(gn(gn(gn(gn(gn(gn(gn(Lt,en,'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'),tn,"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"),nn,"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"),rn,"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."),on,"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."),an,"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."),cn,"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."),un,"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."),sn,"Invalid authentication header provided"),ln,"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority."),gn(gn(Lt,fn,"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode."),pn,"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.")),kn=(wn[Kt],wn[zt],wn[Qt],wn[Wt],wn[Yt],wn[Vt],wn[Jt],wn[Zt],wn[Xt],wn[$t],wn[en],wn[tn],wn[nn],wn[rn],wn[on],wn[an],wn[cn],wn[un],wn[sn],wn[ln],wn[fn],wn[pn],function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=dn(this,t,[e,wn[e]])).name="ClientConfigurationError",Object.setPrototypeOf(n,t.prototype),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mn(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(re));function Sn(e){return new kn(e)}function On(e){return On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},On(e)}function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,An(r.key),r)}}function An(e){var t=function(e){if("object"!=On(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=On(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==On(t)?t:t+""}var In=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"isEmptyObj",value:function(e){if(e)try{var t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}},{key:"startsWith",value:function(e,t){return 0===e.indexOf(t)}},{key:"endsWith",value:function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}},{key:"queryStringToObject",value:function(e){var t={},n=e.split("&"),r=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return n.forEach((function(e){if(e.trim()){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split(/=(.+)/g,2),2),o=n[0],i=n[1];o&&i&&(t[r(o)]=r(i))}})),t}},{key:"trimArrayEntries",value:function(e){return e.map((function(e){return e.trim()}))}},{key:"removeEmptyStringsFromArray",value:function(e){return e.filter((function(e){return!!e}))}},{key:"jsonParseHelper",value:function(e){try{return JSON.parse(e)}catch(e){return null}}},{key:"matchPattern",value:function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}],null&&Tn(e.prototype,null),t&&Tn(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function Pn(e){return Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pn(e)}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function En(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jn(r.key),r)}}function jn(e){var t=function(e){if("object"!=Pn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Pn(t)?t:t+""}var _n=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t?In.trimArrayEntries(function(e){return function(e){if(Array.isArray(e))return xn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return xn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t)):[],o=r?In.removeEmptyStringsFromArray(r):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach((function(e){return n.scopes.add(e)}))}return t=e,r=[{key:"fromString",value:function(t){return new e((t||i.EMPTY_STRING).split(" "))}},{key:"createSearchScopes",value:function(t){var n=new e(t);return n.containsOnlyOIDCScopes()?n.removeScope(i.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}}],(n=[{key:"validateInputScopes",value:function(e){if(!e||e.length<1)throw Sn(Vt)}},{key:"containsScope",value:function(t){var n=new e(this.printScopesLowerCase().split(" "));return!!t&&n.scopes.has(t.toLowerCase())}},{key:"containsScopeSet",value:function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)}))}},{key:"containsOnlyOIDCScopes",value:function(){var e=this,t=0;return c.forEach((function(n){e.containsScope(n)&&(t+=1)})),this.scopes.size===t}},{key:"appendScope",value:function(e){e&&this.scopes.add(e.trim())}},{key:"appendScopes",value:function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw it(Te)}}},{key:"removeScope",value:function(e){if(!e)throw it(Ce);this.scopes.delete(e.trim())}},{key:"removeOIDCScopes",value:function(){var e=this;c.forEach((function(t){e.scopes.delete(t)}))}},{key:"unionScopeSets",value:function(e){if(!e)throw it(Ae);var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t}},{key:"intersectingScopeSets",value:function(e){if(!e)throw it(Ae);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}},{key:"getScopeCount",value:function(){return this.scopes.size}},{key:"asArray",value:function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e}},{key:"printScopes",value:function(){return this.scopes?this.asArray().join(" "):i.EMPTY_STRING}},{key:"printScopesLowerCase",value:function(){return this.printScopes().toLowerCase()}}])&&En(t.prototype,n),r&&En(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function Rn(e,t){if(!e)throw it(ce);try{var n=t(e);return JSON.parse(n)}catch(e){throw it(ae)}}function Nn(e){if(!e)throw it(ae);var t=e.split(I.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?i.EMPTY_STRING:t[1]}}function Mn(e){return Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mn(e)}var qn=["isHomeTenant"],Gn=["isHomeTenant"];function Fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){Hn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hn(e,t,n){return(t=function(e){var t=function(e){if("object"!=Mn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Mn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Mn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Un(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Ln(e,t,n,r){if(r){var o=r.oid,i=r.sub,a=r.tid,c=r.name,u=r.tfp,s=r.acr,l=a||u||s||"";return{tenantId:l,localAccountId:o||i||"",name:c,isHomeTenant:Un(l,e)}}return{tenantId:n,localAccountId:t,isHomeTenant:Un(n,e)}}function Kn(e,t,n,r){var o=e;if(t){t.isHomeTenant;var i=Dn(t,qn);o=Bn(Bn({},e),i)}if(n){var a=Ln(e.homeAccountId,e.localAccountId,e.tenantId,n),c=(a.isHomeTenant,Dn(a,Gn));return Bn(Bn(Bn({},o),c),{},{idTokenClaims:n,idToken:r})}return o}function zn(e){return e&&(e.tid||e.tfp||e.acr)||null}function Qn(e){return Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qn(e)}function Wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yn(r.key),r)}}function Yn(e){var t=function(e){if("object"!=Qn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Qn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Qn(t)?t:t+""}var Vn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"generateAccountCacheKey",value:function(e){var t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}},{key:"createAccount",value:function(t,n,r){var o,i,a,c,u,s,l,f,p,h=new e;1===n.authorityType?h.authorityType="ADFS":n.protocolMode===L?h.authorityType="MSSTS":h.authorityType=A,t.clientInfo&&r&&(p=Rn(t.clientInfo,r)),h.clientInfo=t.clientInfo,h.homeAccountId=t.homeAccountId,h.nativeAccountId=t.nativeAccountId;var d=t.environment||n&&n.getPreferredCache();if(!d)throw it(_e);h.environment=d,h.realm=(null===(o=p)||void 0===o?void 0:o.utid)||zn(t.idTokenClaims)||"",h.localAccountId=(null===(i=p)||void 0===i?void 0:i.uid)||(null===(a=t.idTokenClaims)||void 0===a?void 0:a.oid)||(null===(c=t.idTokenClaims)||void 0===c?void 0:c.sub)||"";var y=(null===(u=t.idTokenClaims)||void 0===u?void 0:u.preferred_username)||(null===(s=t.idTokenClaims)||void 0===s?void 0:s.upn),v=null!==(l=t.idTokenClaims)&&void 0!==l&&l.emails?t.idTokenClaims.emails[0]:null;if(h.username=y||v||"",h.name=(null===(f=t.idTokenClaims)||void 0===f?void 0:f.name)||"",h.cloudGraphHostName=t.cloudGraphHostName,h.msGraphHost=t.msGraphHost,t.tenantProfiles)h.tenantProfiles=t.tenantProfiles;else{var m=Ln(t.homeAccountId,h.localAccountId,h.realm,t.idTokenClaims);h.tenantProfiles=[m]}return h}},{key:"createFromAccountInfo",value:function(t,n,r){var o,i=new e;return i.authorityType=t.authorityType||A,i.homeAccountId=t.homeAccountId,i.localAccountId=t.localAccountId,i.nativeAccountId=t.nativeAccountId,i.realm=t.tenantId,i.environment=t.environment,i.username=t.username,i.name=t.name,i.cloudGraphHostName=n,i.msGraphHost=r,i.tenantProfiles=Array.from((null===(o=t.tenantProfiles)||void 0===o?void 0:o.values())||[]),i}},{key:"generateHomeAccountId",value:function(e,t,n,r,o){if(1!==t&&2!==t){if(e)try{var i=Rn(e,r.base64Decode);if(i.uid&&i.utid)return"".concat(i.uid,".").concat(i.utid)}catch(e){}n.warning("No client info in response")}return(null==o?void 0:o.sub)||""}},{key:"isAccountEntity",value:function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}},{key:"accountInfoIsEqual",value:function(e,t,n){if(!e||!t)return!1;var r=!0;if(n){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};r=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}],(n=[{key:"generateAccountId",value:function(){return[this.homeAccountId,this.environment].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}},{key:"generateAccountKey",value:function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}},{key:"getAccountInfo",value:function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((function(e){return[e.tenantId,e]})))}}},{key:"isSingleTenant",value:function(){return!this.tenantProfiles}}])&&Wn(t.prototype,n),r&&Wn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function Jn(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function Zn(e){if(!e||e.indexOf("=")<0)return null;try{var t=Jn(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.error||n.error_description||n.state)return n}catch(e){throw it(he)}return null}function Xn(e){return Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xn(e)}function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,er(r.key),r)}}function er(e){var t=function(e){if("object"!=Xn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Xn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xn(t)?t:t+""}var tr=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._urlString=t,!this._urlString)throw Sn(Yt);t.includes("#")||(this._urlString=e.canonicalizeUri(t))}return t=e,r=[{key:"canonicalizeUri",value:function(e){if(e){var t=e.toLowerCase();return In.endsWith(t,"?")?t=t.slice(0,-1):In.endsWith(t,"?/")&&(t=t.slice(0,-2)),In.endsWith(t,"/")||(t+="/"),t}return e}},{key:"appendQueryString",value:function(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}},{key:"removeHashFromUrl",value:function(t){return e.canonicalizeUri(t.split("#")[0])}},{key:"getDomainFromUrl",value:function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Sn(Wt);return n[2]}},{key:"getAbsoluteUrl",value:function(t,n){if(t[0]===i.FORWARD_SLASH){var r=new e(n).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+t}return t}},{key:"constructAuthorityUriFromObject",value:function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))}},{key:"hashContainsKnownProperties",value:function(e){return!!Zn(e)}}],(n=[{key:"urlString",get:function(){return this._urlString}},{key:"validateAsUri",value:function(){var e;try{e=this.getUrlComponents()}catch(e){throw Sn(Wt)}if(!e.HostNameAndPort||!e.PathSegments)throw Sn(Wt);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Sn(Qt)}},{key:"replaceTenantPath",value:function(t){var n=this.getUrlComponents(),r=n.PathSegments;return!t||0===r.length||r[0]!==g&&r[0]!==b||(r[0]=t),e.constructAuthorityUriFromObject(n)}},{key:"getUrlComponents",value:function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Sn(Wt);var n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},r=n.AbsolutePath.split("/");return r=r.filter((function(e){return e&&e.length>0})),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}}])&&$n(t.prototype,n),r&&$n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}(),nr={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},rr={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},or=new Set;function ir(e,t,n,r){if(null==r||r.trace("getAliasesFromMetadata called with source: ".concat(n)),e&&t){var o=ar(t,e);if(o)return null==r||r.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(n,", returning aliases")),o.aliases;null==r||r.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(n))}return null}function ar(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.aliases.includes(t))return r}return null}rr.metadata.forEach((function(e){e.aliases.forEach((function(e){or.add(e)}))}));var cr="cache_quota_exceeded",ur="cache_error_unknown";function sr(e){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sr(e)}function lr(e){var t="function"==typeof Map?new Map:void 0;return lr=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(fr())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&pr(o,n.prototype),o}(e,arguments,hr(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),pr(n,e)},lr(e)}function fr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fr=function(){return!!e})()}function pr(e,t){return pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pr(e,t)}function hr(e){return hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hr(e)}function dr(e,t,n){return(t=yr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yr(e){var t=function(e){if("object"!=sr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=sr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==sr(t)?t:t+""}var vr=dr(dr({},cr,"Exceeded cache storage capacity."),ur,"Unexpected error occurred when using cache storage."),mr=function(e){function t(e,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=n||(vr[e]?vr[e]:vr[ur]);return r=function(e,t,n){return t=hr(t),function(e,t){if(t&&("object"==sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fr()?Reflect.construct(t,n||[],hr(e).constructor):t.apply(e,n))}(this,t,["".concat(e,": ").concat(o)]),Object.setPrototypeOf(r,t.prototype),r.name="CacheError",r.errorCode=e,r.errorMessage=o,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pr(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(lr(Error));function gr(e,t,n){return t=wr(t),function(e,t){if(t&&("object"==Sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,br()?Reflect.construct(t,n||[],wr(e).constructor):t.apply(e,n))}function br(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(br=function(){return!!e})()}function wr(e){return wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wr(e)}function kr(e,t){return kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kr(e,t)}function Sr(e){return Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sr(e)}function Or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Or(Object(n),!0).forEach((function(t){Tr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Or(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tr(e,t,n){return(t=Hr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ar(){var e=_r(),t=e.m(Ar),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Ir(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ar=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Nr(e,t)},AsyncIterator:jr,async:function(e,t,n,o,a){return(r(t)?Er:xr)(i(e),t,n,o,a)},keys:Pr,values:Ir}})()}function Ir(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Sr(e)+" is not iterable")}function Pr(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function xr(e,t,n,r,o){var i=Er(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Er(e,t,n,r,o){return new jr(_r().w(e,t,n,r),o||Promise)}function jr(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Nr?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Rr(jr.prototype),Rr(jr.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Rr(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function _r(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Rr(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Rr(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Rr(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Rr(f,"constructor",s),Rr(s,"constructor",u),u.displayName="GeneratorFunction",Rr(s,o,"GeneratorFunction"),Rr(f),Rr(f,o,"Generator"),Rr(f,r,(function(){return this})),Rr(f,"toString",(function(){return"[object Generator]"})),(_r=function(){return{w:i,m:p}})()}function Rr(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Rr=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Rr(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Rr(e,t,n,r)}function Nr(e,t){this.v=e,this.k=t}function Mr(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function qr(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Mr(i,r,o,a,c,"next",e)}function c(e){Mr(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hr(r.key),r)}}function Br(e,t,n){return t&&Fr(e.prototype,t),n&&Fr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hr(e){var t=function(e){if("object"!=Sr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Sr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Sr(t)?t:t+""}var Dr=function(){function e(t,n,r,o){Gr(this,e),this.clientId=t,this.cryptoImpl=n,this.commonLogger=r.clone(bt,wt),this.staticAuthorityOptions=o}return Br(e,[{key:"getAllAccounts",value:function(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}},{key:"getAccountInfoFilteredBy",value:function(e){var t=this.getAllAccounts(e);return t.length>1?t.sort((function(e){return e.idTokenClaims?-1:1}))[0]:1===t.length?t[0]:null}},{key:"getBaseAccountInfo",value:function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}},{key:"buildTenantProfiles",value:function(e,t){var n=this;return e.flatMap((function(e){return n.getTenantProfilesFromAccountEntity(e,null==t?void 0:t.tenantId,t)}))}},{key:"getTenantedAccountInfoByFilter",value:function(e,t,n,r){var o;if(r&&!this.tenantProfileMatchesFilter(n,r))return null;var i=this.getIdToken(e,t,n.tenantId);return i&&(o=kt(i.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,r))?null:Kn(e,n,o,null==i?void 0:i.secret)}},{key:"getTenantProfilesFromAccountEntity",value:function(e,t,n){var r=this,o=e.getAccountInfo(),i=o.tenantProfiles||new Map,a=this.getTokenKeys();if(t){var c=i.get(t);if(!c)return[];i=new Map([[t,c]])}var u=[];return i.forEach((function(e){var t=r.getTenantedAccountInfoByFilter(o,a,e,n);t&&u.push(t)})),u}},{key:"tenantProfileMatchesFilter",value:function(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}},{key:"idTokenClaimsMatchTenantProfileFilter",value:function(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}},{key:"saveCacheRecord",value:(a=qr(Ar().mark((function e(t,n,r){var o,i,a,c;return Ar().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw it(je);case 2:if(e.prev=2,t.account&&this.setAccount(t.account),t.idToken&&!1!==(null==n?void 0:n.idToken)&&this.setIdTokenCredential(t.idToken),!t.accessToken||!1===(null==n?void 0:n.accessToken)){e.next=8;break}return e.next=8,this.saveAccessToken(t.accessToken);case 8:t.refreshToken&&!1!==(null==n?void 0:n.refreshToken)&&this.setRefreshTokenCredential(t.refreshToken),t.appMetadata&&this.setAppMetadata(t.appMetadata),e.next=27;break;case 12:if(e.prev=12,e.t0=e.catch(2),null===(o=this.commonLogger)||void 0===o||o.error("CacheManager.saveCacheRecord: failed"),!(e.t0 instanceof Error)){e.next=25;break}if(null===(i=this.commonLogger)||void 0===i||i.errorPii("CacheManager.saveCacheRecord: ".concat(e.t0.message),r),"QuotaExceededError"!==e.t0.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.t0.name&&!e.t0.message.includes("exceeded the quota")){e.next=22;break}throw null===(a=this.commonLogger)||void 0===a||a.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new mr(cr);case 22:throw new mr(e.t0.name,e.t0.message);case 23:e.next=27;break;case 25:throw null===(c=this.commonLogger)||void 0===c||c.errorPii("CacheManager.saveCacheRecord: ".concat(e.t0),r),new mr(ur);case 27:case"end":return e.stop()}}),e,this,[[2,12]])}))),function(e,t,n){return a.apply(this,arguments)})},{key:"saveAccessToken",value:(i=qr(Ar().mark((function e(t){var n,r,o,i,a=this;return Ar().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={clientId:t.clientId,credentialType:t.credentialType,environment:t.environment,homeAccountId:t.homeAccountId,realm:t.realm,tokenType:t.tokenType,requestedClaimsHash:t.requestedClaimsHash},r=this.getTokenKeys(),o=_n.fromString(t.target),i=[],r.accessToken.forEach((function(e){if(a.accessTokenKeyMatchesFilter(e,n,!1)){var t=a.getAccessTokenCredential(e);t&&a.credentialMatchesFilter(t,n)&&_n.fromString(t.target).intersectingScopeSets(o)&&i.push(a.removeAccessToken(e))}})),e.next=7,Promise.all(i);case 7:this.setAccessTokenCredential(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getAccountsFilteredBy",value:function(e){var t=this,n=this.getAccountKeys(),r=[];return n.forEach((function(n){var o;if(t.isAccountKey(n,e.homeAccountId)){var i=t.getAccount(n,t.commonLogger);if(i&&(!e.homeAccountId||t.matchHomeAccountId(i,e.homeAccountId))&&(!e.username||t.matchUsername(i.username,e.username))&&(!e.environment||t.matchEnvironment(i,e.environment))&&(!e.realm||t.matchRealm(i,e.realm))&&(!e.nativeAccountId||t.matchNativeAccountId(i,e.nativeAccountId))&&(!e.authorityType||t.matchAuthorityType(i,e.authorityType))){var a={localAccountId:null==e?void 0:e.localAccountId,name:null==e?void 0:e.name},c=null===(o=i.tenantProfiles)||void 0===o?void 0:o.filter((function(e){return t.tenantProfileMatchesFilter(e,a)}));c&&0===c.length||r.push(i)}}})),r}},{key:"isAccountKey",value:function(e,t,n){return!(e.split(I.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}},{key:"isCredentialKey",value:function(e){if(e.split(I.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(-1===t.indexOf(P.ID_TOKEN.toLowerCase())&&-1===t.indexOf(P.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(P.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(P.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(P.REFRESH_TOKEN.toLowerCase())>-1){var n="".concat(P.REFRESH_TOKEN).concat(I.CACHE_KEY_SEPARATOR).concat(this.clientId).concat(I.CACHE_KEY_SEPARATOR),r="".concat(P.REFRESH_TOKEN).concat(I.CACHE_KEY_SEPARATOR).concat(E).concat(I.CACHE_KEY_SEPARATOR);if(-1===t.indexOf(n.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}},{key:"credentialMatchesFilter",value:function(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===P.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===G.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}},{key:"getAppMetadataFilteredBy",value:function(e){var t=this,n=this.getKeys(),r={};return n.forEach((function(n){if(t.isAppMetadata(n)){var o=t.getAppMetadata(n);o&&(e.environment&&!t.matchEnvironment(o,e.environment)||e.clientId&&!t.matchClientId(o,e.clientId)||(r[n]=o))}})),r}},{key:"getAuthorityMetadataByAlias",value:function(e){var t=this,n=this.getAuthorityMetadataKeys(),r=null;return n.forEach((function(n){if(t.isAuthorityMetadata(n)&&-1!==n.indexOf(t.clientId)){var o=t.getAuthorityMetadata(n);o&&-1!==o.aliases.indexOf(e)&&(r=o)}})),r}},{key:"removeAllAccounts",value:(o=qr(Ar().mark((function e(){var t,n,r=this;return Ar().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getAccountKeys(),n=[],t.forEach((function(e){n.push(r.removeAccount(e))})),e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"removeAccount",value:(r=qr(Ar().mark((function e(t){var n;return Ar().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getAccount(t,this.commonLogger)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.removeAccountContext(n);case 5:this.removeItem(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"removeAccountContext",value:(n=qr(Ar().mark((function e(t){var n,r,o,i=this;return Ar().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getTokenKeys(),r=t.generateAccountId(),o=[],n.idToken.forEach((function(e){0===e.indexOf(r)&&i.removeIdToken(e)})),n.accessToken.forEach((function(e){0===e.indexOf(r)&&o.push(i.removeAccessToken(e))})),n.refreshToken.forEach((function(e){0===e.indexOf(r)&&i.removeRefreshToken(e)})),e.next=8,Promise.all(o);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateOutdatedCachedAccount",value:function(t,n,r){var o=this;if(n&&n.isSingleTenant()){var i;null===(i=this.commonLogger)||void 0===i||i.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");var a=this.getAccountKeys().filter((function(e){return e.startsWith(n.homeAccountId)})),c=[];a.forEach((function(e){var t=o.getCachedAccountEntity(e);t&&c.push(t)}));var u=c.find((function(e){return Un(e.realm,e.homeAccountId)}))||c[0];u.tenantProfiles=c.map((function(e){return{tenantId:e.realm,localAccountId:e.localAccountId,name:e.name,isHomeTenant:Un(e.realm,e.homeAccountId)}}));var s=e.toObject(new Vn,Cr({},u)),l=s.generateAccountKey();return a.forEach((function(e){e!==l&&o.removeOutdatedAccount(t)})),this.setAccount(s),null==r||r.verbose("Updated an outdated account entity in the cache"),s}return n}},{key:"removeAccessToken",value:(t=qr(Ar().mark((function e(t){var n,r;return Ar().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getAccessTokenCredential(t)){e.next=3;break}return e.abrupt("return");case 3:if(n.credentialType.toLowerCase()!==P.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()){e.next=16;break}if(n.tokenType!==G.POP){e.next=16;break}if(!(r=n.keyId)){e.next=16;break}return e.prev=8,e.next=11,this.cryptoImpl.removeTokenBindingKey(r);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(8),it(Ue);case 16:return e.abrupt("return",this.removeItem(t));case 17:case"end":return e.stop()}}),e,this,[[8,13]])}))),function(e){return t.apply(this,arguments)})},{key:"removeAppMetadata",value:function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0}},{key:"readAccountFromCache",value:function(e){var t=Vn.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}},{key:"getIdToken",value:function(e,t,n,r,o){var i=this;this.commonLogger.trace("CacheManager - getIdToken called");var a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:P.ID_TOKEN,clientId:this.clientId,realm:n},c=this.getIdTokensByFilter(a,t),u=c.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(u>1){var s=c;if(!n){var l=new Map;c.forEach((function(t,n){t.realm===e.tenantId&&l.set(n,t)}));var f=l.size;if(f<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),c.values().next().value;if(1===f)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),l.values().next().value;s=l}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),s.forEach((function(e,t){i.removeIdToken(t)})),r&&o&&r.addFields({multiMatchedID:c.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),c.values().next().value}},{key:"getIdTokensByFilter",value:function(e,t){var n=this,r=t&&t.idToken||this.getTokenKeys().idToken,o=new Map;return r.forEach((function(t){if(n.idTokenKeyMatchesFilter(t,Cr({clientId:n.clientId},e))){var r=n.getIdTokenCredential(t);r&&n.credentialMatchesFilter(r,e)&&o.set(t,r)}})),o}},{key:"idTokenKeyMatchesFilter",value:function(e,t){var n=e.toLowerCase();return!(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))}},{key:"removeIdToken",value:function(e){this.removeItem(e)}},{key:"removeRefreshToken",value:function(e){this.removeItem(e)}},{key:"getAccessToken",value:function(e,t,n,r,o,i){var a=this;this.commonLogger.trace("CacheManager - getAccessToken called");var c=_n.createSearchScopes(t.scopes),u=t.authenticationScheme||G.BEARER,s=u&&u.toLowerCase()!==G.BEARER.toLowerCase()?P.ACCESS_TOKEN_WITH_AUTH_SCHEME:P.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:r||e.tenantId,target:c,tokenType:u,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},f=n&&n.accessToken||this.getTokenKeys().accessToken,p=[];f.forEach((function(e){if(a.accessTokenKeyMatchesFilter(e,l,!0)){var t=a.getAccessTokenCredential(e);t&&a.credentialMatchesFilter(t,l)&&p.push(t)}}));var h=p.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),p.forEach((function(e){a.removeAccessToken(At(e))})),o&&i&&o.addFields({multiMatchedAT:p.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),p[0])}},{key:"accessTokenKeyMatchesFilter",value:function(e,t,n){var r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var o=t.target.asArray(),i=0;i<o.length;i++){if(n&&!r.includes(o[i].toLowerCase()))return!1;if(!n&&r.includes(o[i].toLowerCase()))return!0}return!0}},{key:"getAccessTokensByFilter",value:function(e){var t=this,n=this.getTokenKeys(),r=[];return n.accessToken.forEach((function(n){if(t.accessTokenKeyMatchesFilter(n,e,!0)){var o=t.getAccessTokenCredential(n);o&&t.credentialMatchesFilter(o,e)&&r.push(o)}})),r}},{key:"getRefreshToken",value:function(e,t,n,r,o){var i=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var a=t?E:void 0,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:P.REFRESH_TOKEN,clientId:this.clientId,familyId:a},u=n&&n.refreshToken||this.getTokenKeys().refreshToken,s=[];u.forEach((function(e){if(i.refreshTokenKeyMatchesFilter(e,c)){var t=i.getRefreshTokenCredential(e);t&&i.credentialMatchesFilter(t,c)&&s.push(t)}}));var l=s.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&r&&o&&r.addFields({multiMatchedRT:l},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),s[0])}},{key:"refreshTokenKeyMatchesFilter",value:function(e,t){var n=e.toLowerCase();return!(t.familyId&&-1===n.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))}},{key:"readAppMetadataFromCache",value:function(e){var t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map((function(e){return n[e]})),o=r.length;if(o<1)return null;if(o>1)throw it(Se);return r[0]}},{key:"isAppMetadataFOCI",value:function(e){var t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==E)}},{key:"matchHomeAccountId",value:function(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}},{key:"matchLocalAccountIdFromTokenClaims",value:function(e,t){return t===(e.oid||e.sub)}},{key:"matchLocalAccountIdFromTenantProfile",value:function(e,t){return e.localAccountId===t}},{key:"matchName",value:function(e,t){var n;return!(t.toLowerCase()!==(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()))}},{key:"matchUsername",value:function(e,t){return!(!e||"string"!=typeof e||(null==t?void 0:t.toLowerCase())!==e.toLowerCase())}},{key:"matchUserAssertionHash",value:function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}},{key:"matchEnvironment",value:function(e,t){if(this.staticAuthorityOptions){var n=function(e,t){var n,r=e.canonicalAuthority;if(r){var o,i=new tr(r).getUrlComponents().HostNameAndPort;n=ir(i,null===(o=e.cloudDiscoveryMetadata)||void 0===o?void 0:o.metadata,_,t)||ir(i,rr.metadata,M,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}},{key:"matchCredentialType",value:function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}},{key:"matchClientId",value:function(e,t){return!(!e.clientId||t!==e.clientId)}},{key:"matchFamilyId",value:function(e,t){return!(!e.familyId||t!==e.familyId)}},{key:"matchRealm",value:function(e,t){var n;return!((null===(n=e.realm)||void 0===n?void 0:n.toLowerCase())!==t.toLowerCase())}},{key:"matchNativeAccountId",value:function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}},{key:"matchLoginHintFromTokenClaims",value:function(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}},{key:"matchSid",value:function(e,t){return e.sid===t}},{key:"matchAuthorityType",value:function(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}},{key:"matchTarget",value:function(e,t){return!(e.credentialType!==P.ACCESS_TOKEN&&e.credentialType!==P.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&_n.fromString(e.target).containsScopeSet(t)}},{key:"matchTokenType",value:function(e,t){return!(!e.tokenType||e.tokenType!==t)}},{key:"matchKeyId",value:function(e,t){return!(!e.keyId||e.keyId!==t)}},{key:"isAppMetadata",value:function(e){return-1!==e.indexOf(x)}},{key:"isAuthorityMetadata",value:function(e){return-1!==e.indexOf(j)}},{key:"generateAuthorityMetadataCacheKey",value:function(e){return"".concat(j,"-").concat(this.clientId,"-").concat(e)}}],[{key:"toObject",value:function(e,t){for(var n in t)e[n]=t[n];return e}}]);var t,n,r,o,i,a}(),Ur=function(e){function t(){return Gr(this,t),gr(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kr(e,t)}(t,e),Br(t,[{key:"setAccount",value:function(){throw it(Ye)}},{key:"getAccount",value:function(){throw it(Ye)}},{key:"getCachedAccountEntity",value:function(){throw it(Ye)}},{key:"setIdTokenCredential",value:function(){throw it(Ye)}},{key:"getIdTokenCredential",value:function(){throw it(Ye)}},{key:"setAccessTokenCredential",value:function(){throw it(Ye)}},{key:"getAccessTokenCredential",value:function(){throw it(Ye)}},{key:"setRefreshTokenCredential",value:function(){throw it(Ye)}},{key:"getRefreshTokenCredential",value:function(){throw it(Ye)}},{key:"setAppMetadata",value:function(){throw it(Ye)}},{key:"getAppMetadata",value:function(){throw it(Ye)}},{key:"setServerTelemetry",value:function(){throw it(Ye)}},{key:"getServerTelemetry",value:function(){throw it(Ye)}},{key:"setAuthorityMetadata",value:function(){throw it(Ye)}},{key:"getAuthorityMetadata",value:function(){throw it(Ye)}},{key:"getAuthorityMetadataKeys",value:function(){throw it(Ye)}},{key:"setThrottlingCache",value:function(){throw it(Ye)}},{key:"getThrottlingCache",value:function(){throw it(Ye)}},{key:"removeItem",value:function(){throw it(Ye)}},{key:"getKeys",value:function(){throw it(Ye)}},{key:"getAccountKeys",value:function(){throw it(Ye)}},{key:"getTokenKeys",value:function(){throw it(Ye)}},{key:"clear",value:(n=qr(Ar().mark((function e(){return Ar().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"updateCredentialCacheKey",value:function(){throw it(Ye)}},{key:"removeOutdatedAccount",value:function(){throw it(Ye)}}]);var n}(Dr);function Lr(e){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lr(e)}function Kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kr(Object(n),!0).forEach((function(t){Qr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qr(e,t,n){return(t=function(e){var t=function(e){if("object"!=Lr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Lr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Lr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wr(){var e=$r(),t=e.m(Wr),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Yr(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Wr=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new to(e,t)},AsyncIterator:Xr,async:function(e,t,n,o,a){return(r(t)?Zr:Jr)(i(e),t,n,o,a)},keys:Vr,values:Yr}})()}function Yr(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Lr(e)+" is not iterable")}function Vr(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Jr(e,t,n,r,o){var i=Zr(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Zr(e,t,n,r,o){return new Xr($r().w(e,t,n,r),o||Promise)}function Xr(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof to?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(eo(Xr.prototype),eo(Xr.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),eo(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function $r(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return eo(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(eo(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,eo(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,eo(f,"constructor",s),eo(s,"constructor",u),u.displayName="GeneratorFunction",eo(s,o,"GeneratorFunction"),eo(f),eo(f,o,"Generator"),eo(f,r,(function(){return this})),eo(f,"toString",(function(){return"[object Generator]"})),($r=function(){return{w:i,m:p}})()}function eo(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}eo=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){eo(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},eo(e,t,n,r)}function to(e,t){this.v=e,this.k=t}function no(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ro(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){no(i,r,o,a,c,"next",e)}function c(e){no(i,r,o,a,c,"throw",e)}a(void 0)}))}}var oo={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},io={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:o.Info,correlationId:i.EMPTY_STRING},ao={claimsBasedCachingEnabled:!1},co={sendGetRequestAsync:function(){return ro(Wr().mark((function e(){return Wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)})))()},sendPostRequestAsync:function(){return ro(Wr().mark((function e(){return Wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw it(Ye);case 1:case"end":return e.stop()}}),e)})))()}},uo={sku:i.SKU,version:wt,cpu:i.EMPTY_STRING,os:i.EMPTY_STRING},so={clientSecret:i.EMPTY_STRING,clientAssertion:void 0},lo={azureCloudInstance:z,tenant:"".concat(i.DEFAULT_COMMON_TENANT)},fo={application:{appName:"",appVersion:""}};function po(e){return e.authOptions.authority.options.protocolMode===K}var ho={sendGetRequestAsync:function(){return Promise.reject(it(Ye))},sendPostRequestAsync:function(){return Promise.reject(it(Ye))}},yo={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},vo=(new Map([[yo.AcquireTokenByCode,"ATByCode"],[yo.AcquireTokenByRefreshToken,"ATByRT"],[yo.AcquireTokenSilent,"ATS"],[yo.AcquireTokenSilentAsync,"ATSAsync"],[yo.AcquireTokenPopup,"ATPopup"],[yo.AcquireTokenRedirect,"ATRedirect"],[yo.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[yo.CryptoOptsSignJwt,"CryptoSignJwt"],[yo.SilentCacheClientAcquireToken,"SltCacheClientAT"],[yo.SilentIframeClientAcquireToken,"SltIframeClientAT"],[yo.SilentRefreshClientAcquireToken,"SltRClientAT"],[yo.SsoSilent,"SsoSlt"],[yo.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[yo.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[yo.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[yo.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[yo.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[yo.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[yo.BrokerHandhshake,"BrokerHandshake"],[yo.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[yo.AcquireTokenByBroker,"ATByBroker"],[yo.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[yo.RefreshTokenClientAcquireToken,"RTClientAT"],[yo.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[yo.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[yo.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[yo.AcquireTokenFromCache,"ATFromCache"],[yo.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[yo.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[yo.AcquireTokenBySilentIframe,"ATBySltIframe"],[yo.InitializeBaseRequest,"InitBaseReq"],[yo.InitializeSilentRequest,"InitSltReq"],[yo.InitializeClientApplication,"InitClientApplication"],[yo.SilentIframeClientTokenHelper,"SIClientTHelper"],[yo.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[yo.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[yo.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[yo.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[yo.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[yo.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[yo.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[yo.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[yo.GetAuthCodeUrl,"GetAuthCodeUrl"],[yo.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[yo.HandleCodeResponse,"HandleCodeResp"],[yo.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[yo.AuthClientAcquireToken,"AuthClientAT"],[yo.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[yo.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[yo.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[yo.PopTokenGenerateCnf,"PopTGenCnf"],[yo.PopTokenGenerateKid,"PopTGenKid"],[yo.HandleServerTokenResponse,"HandleServerTRes"],[yo.DeserializeResponse,"DeserializeRes"],[yo.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[yo.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[yo.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[yo.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[yo.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[yo.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[yo.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[yo.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[yo.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[yo.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[yo.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[yo.AcquireTokenByCodeAsync,"ATByCodeAsync"],[yo.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[yo.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[yo.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[yo.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[yo.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[yo.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[yo.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[yo.NativeGenerateAuthResult,"NtvGenAuthRes"],[yo.RemoveHiddenIframe,"RemoveHiddenIframe"],[yo.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[yo.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[yo.GeneratePkceCodes,"GenPkceCodes"],[yo.GenerateCodeVerifier,"GenCodeVerifier"],[yo.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[yo.Sha256Digest,"Sha256Digest"],[yo.GetRandomValues,"GetRandomValues"]]),1);function mo(e){return mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mo(e)}function go(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ko(r.key),r)}}function wo(e,t,n){return t&&bo(e.prototype,t),n&&bo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ko(e){var t=function(e){if("object"!=mo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=mo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==mo(t)?t:t+""}new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]);var So,Oo=function(){return wo((function e(){go(this,e)}),[{key:"startMeasurement",value:function(){}},{key:"endMeasurement",value:function(){}},{key:"flushMeasurement",value:function(){return null}}])}(),Co=function(){return wo((function e(){go(this,e)}),[{key:"generateId",value:function(){return"callback-id"}},{key:"startMeasurement",value:function(e,t){return{end:function(){return null},discard:function(){},add:function(){},increment:function(){},event:{eventId:this.generateId(),status:vo,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Oo}}},{key:"startPerformanceMeasurement",value:function(){return new Oo}},{key:"calculateQueuedTime",value:function(){return 0}},{key:"addQueueMeasurement",value:function(){}},{key:"setPreQueueTime",value:function(){}},{key:"endMeasurement",value:function(){return null}},{key:"discardMeasurements",value:function(){}},{key:"removePerformanceCallback",value:function(){return!0}},{key:"addPerformanceCallback",value:function(){return""}},{key:"emitEvents",value:function(){}},{key:"addFields",value:function(){}},{key:"incrementFields",value:function(){}},{key:"cacheEventByCorrelationId",value:function(){}}])}(),To={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Ao="53ee284d-920a-4b59-9d30-a60315b26836",Io="ppnbnpeolgkicgegkbkbjmhlideopiji",Po="Handshake",xo="GetToken",Eo="localStorage",jo="sessionStorage",_o="memoryStorage",Ro="request.state",No="request.origin",Mo="urlHash",qo="request.params",Go="interaction.status",Fo="ccs.credential",Bo="request.correlationId",Ho="request.native",Do="msal.account.keys",Uo="msal.token.keys",Lo="wrapper.sku",Ko="wrapper.version",zo=861,Qo=862;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(So||(So={}));var Wo={scopes:a},Yo="jwk",Vo="msal.db",Jo="".concat(Vo,".keys"),Zo=[0,5,4];function Xo(e){return Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xo(e)}function $o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ei(r.key),r)}}function ei(e){var t=function(e){if("object"!=Xo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Xo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xo(t)?t:t+""}var ti,ni=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"defaultNavigateWindow",value:function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))}}],(n=[{key:"navigateInternal",value:function(t,n){return e.defaultNavigateWindow(t,n)}},{key:"navigateExternal",value:function(t,n){return e.defaultNavigateWindow(t,n)}}])&&$o(t.prototype,n),r&&$o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}(),ri="pkce_not_created",oi="crypto_nonexistent",ii="empty_navigate_uri",ai="hash_empty_error",ci="no_state_in_hash",ui="hash_does_not_contain_known_properties",si="unable_to_parse_state",li="state_interaction_type_mismatch",fi="interaction_in_progress",pi="popup_window_error",hi="empty_window_error",di="user_cancelled",yi="monitor_popup_timeout",vi="monitor_window_timeout",mi="redirect_in_iframe",gi="block_iframe_reload",bi="block_nested_popups",wi="iframe_closed_prematurely",ki="silent_logout_unsupported",Si="no_account_error",Oi="silent_prompt_value_error",Ci="no_token_request_cache_error",Ti="unable_to_parse_token_request_cache_error",Ai="no_cached_authority_error",Ii="auth_request_not_set_error",Pi="invalid_cache_type",xi="non_browser_environment",Ei="database_not_open",ji="no_network_connectivity",_i="post_request_failed",Ri="get_request_failed",Ni="failed_to_parse_response",Mi="unable_to_load_token",qi="crypto_key_not_found",Gi="auth_code_required",Fi="auth_code_or_nativeAccountId_required",Bi="spa_code_and_nativeAccountId_present",Hi="database_unavailable",Di="unable_to_acquire_token_from_native_platform",Ui="native_handshake_timeout",Li="native_extension_not_installed",Ki="native_connection_not_established",zi="uninitialized_public_client_application",Qi="native_prompt_not_supported",Wi="invalid_base64_string",Yi="invalid_pop_token_request";function Vi(e){return Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vi(e)}function Ji(e,t,n){return t=Xi(t),function(e,t){if(t&&("object"==Vi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Zi()?Reflect.construct(t,n||[],Xi(e).constructor):t.apply(e,n))}function Zi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Zi=function(){return!!e})()}function Xi(e){return Xi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xi(e)}function $i(e,t){return $i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$i(e,t)}function ea(e,t,n){return(t=ta(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ta(e){var t=function(e){if("object"!=Vi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Vi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Vi(t)?t:t+""}var na="For more visit: aka.ms/msaljs/browser-errors",ra=(ea(ea(ea(ea(ea(ea(ea(ea(ea(ea(ti={},ri,"The PKCE code challenge and verifier could not be generated."),oi,"The crypto object or function is not available."),ii,"Navigation URI is empty. Please check stack trace for more info."),ai,"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(na)),ci,"Hash does not contain state. Please verify that the request originated from msal."),ui,"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(na)),si,"Unable to parse state. Please verify that the request originated from msal."),li,"Hash contains state but the interaction type does not match the caller."),fi,"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(na)),pi,"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."),ea(ea(ea(ea(ea(ea(ea(ea(ea(ea(ti,hi,"window.open returned null or undefined window object."),di,"User cancelled the flow."),yi,"Token acquisition in popup failed due to timeout.  ".concat(na)),vi,"Token acquisition in iframe failed due to timeout.  ".concat(na)),mi,"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."),gi,"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(na)),bi,"Request was blocked inside a popup because MSAL detected it was running in a popup."),wi,"The iframe being monitored was closed prematurely."),ki,"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."),Si,"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."),ea(ea(ea(ea(ea(ea(ea(ea(ea(ea(ti,Oi,"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."),Ci,"No token request found in cache."),Ti,"The cached token request could not be parsed."),Ai,"No cached authority found."),Ii,"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"),Pi,"Invalid cache type"),xi,"Login and token requests are not supported in non-browser environments."),Ei,"Database is not open!"),ji,"No network connectivity. Check your internet connection."),_i,"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"),ea(ea(ea(ea(ea(ea(ea(ea(ea(ea(ti,Ri,"Network request failed. Please check the network trace to determine root cause."),Ni,"Failed to parse network response. Check network trace."),Mi,"Error loading token to cache."),qi,"Cryptographic Key or Keypair not found in browser storage."),Gi,"An authorization code must be provided (as the `code` property on the request) to this flow."),Fi,"An authorization code or nativeAccountId must be provided to this flow."),Bi,"Request cannot contain both spa code and native account id."),Hi,"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."),Di,"Unable to acquire token from native platform.  ".concat(na)),Ui,"Timed out while attempting to establish connection to browser extension"),ea(ea(ea(ea(ea(ea(ti,Li,"Native extension is not installed. If you think this is a mistake call the initialize function."),Ki,"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(na)),zi,"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(na)),Qi,"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."),Wi,"Invalid base64 encoded string."),Yi,"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.")),oa=(ra[ri],ra[oi],ra[ii],ra[ai],ra[ci],ra[ui],ra[si],ra[li],ra[fi],ra[pi],ra[hi],ra[di],ra[yi],ra[vi],ra[mi],ra[gi],ra[bi],ra[wi],ra[ki],ra[Si],ra[Oi],ra[Ci],ra[Ti],ra[Ai],ra[Ii],ra[Pi],ra[xi],ra[Ei],ra[ji],ra[_i],ra[Ri],ra[Ni],ra[Mi],ra[qi],ra[Gi],ra[Fi],ra[Bi],ra[Hi],ra[Di],ra[Ui],ra[Li],ra[Ki],ra[zi],ra[Qi],ra[Wi],ra[Yi],function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=Ji(this,t,[e,ra[e]]),Object.setPrototypeOf(n,t.prototype),n.name="BrowserAuthError",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$i(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(re));function ia(e){return new oa(e)}function aa(e){return aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aa(e)}function ca(){var e=ha(),t=e.m(ca),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,ua(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ca=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new ya(e,t)},AsyncIterator:pa,async:function(e,t,n,o,a){return(r(t)?fa:la)(i(e),t,n,o,a)},keys:sa,values:ua}})()}function ua(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(aa(e)+" is not iterable")}function sa(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function la(e,t,n,r,o){var i=fa(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function fa(e,t,n,r,o){return new pa(ha().w(e,t,n,r),o||Promise)}function pa(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof ya?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(da(pa.prototype),da(pa.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),da(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function ha(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return da(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(da(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,da(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,da(f,"constructor",s),da(s,"constructor",u),u.displayName="GeneratorFunction",da(s,o,"GeneratorFunction"),da(f),da(f,o,"Generator"),da(f,r,(function(){return this})),da(f,"toString",(function(){return"[object Generator]"})),(ha=function(){return{w:i,m:p}})()}function da(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}da=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){da(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},da(e,t,n,r)}function ya(e,t){this.v=e,this.k=t}function va(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ma(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){va(i,r,o,a,c,"next",e)}function c(e){va(i,r,o,a,c,"throw",e)}a(void 0)}))}}function ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ba(r.key),r)}}function ba(e){var t=function(e){if("object"!=aa(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=aa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==aa(t)?t:t+""}var wa=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"sendGetRequestAsync",value:(r=ma(ca().mark((function e(t,n){var r;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"GET",headers:this.getFetchHeaders(n)});case 3:r=e.sent,e.next=13;break;case 6:if(e.prev=6,e.t0=e.catch(0),!window.navigator.onLine){e.next=12;break}throw ia(Ri);case 12:throw ia(ji);case 13:return e.prev=13,e.t1=this.getHeaderDict(r.headers),e.next=17,r.json();case 17:return e.t2=e.sent,e.t3=r.status,e.abrupt("return",{headers:e.t1,body:e.t2,status:e.t3});case 22:throw e.prev=22,e.t4=e.catch(13),ia(Ni);case 25:case"end":return e.stop()}}),e,this,[[0,6],[13,22]])}))),function(e,t){return r.apply(this,arguments)})},{key:"sendPostRequestAsync",value:(n=ma(ca().mark((function e(t,n){var r,o;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n&&n.body||i.EMPTY_STRING,e.prev=1,e.next=4,fetch(t,{method:"POST",headers:this.getFetchHeaders(n),body:r});case 4:o=e.sent,e.next=14;break;case 7:if(e.prev=7,e.t0=e.catch(1),!window.navigator.onLine){e.next=13;break}throw ia(_i);case 13:throw ia(ji);case 14:return e.prev=14,e.t1=this.getHeaderDict(o.headers),e.next=18,o.json();case 18:return e.t2=e.sent,e.t3=o.status,e.abrupt("return",{headers:e.t1,body:e.t2,status:e.t3});case 23:throw e.prev=23,e.t4=e.catch(14),ia(Ni);case 26:case"end":return e.stop()}}),e,this,[[1,7],[14,23]])}))),function(e,t){return n.apply(this,arguments)})},{key:"getFetchHeaders",value:function(e){var t=new Headers;if(!e||!e.headers)return t;var n=e.headers;return Object.keys(n).forEach((function(e){t.append(e,n[e])})),t}},{key:"getHeaderDict",value:function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}}],t&&ga(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function ka(e){return ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ka(e)}function Sa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sa(Object(n),!0).forEach((function(t){Ca(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ca(e,t,n){return(t=function(e){var t=function(e){if("object"!=ka(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ka(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ka(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ta=1e4,Aa="3.26.1";function Ia(e){return Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ia(e)}function Pa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xa(e,t,n){return(t=ja(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ja(r.key),r)}}function ja(e){var t=function(e){if("object"!=Ia(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ia(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ia(t)?t:t+""}var _a=function(){return e=function e(t){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.browserEnvironment="undefined"!=typeof window,this.config=function(e,t){var n=e.auth,r=e.cache,a=e.system,c=e.telemetry,u={clientId:i.EMPTY_STRING,authority:"".concat(i.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:i.EMPTY_STRING,authorityMetadata:i.EMPTY_STRING,redirectUri:i.EMPTY_STRING,postLogoutRedirectUri:i.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:L,OIDCOptions:{serverResponseType:C.FRAGMENT,defaultScopes:[i.OPENID_SCOPE,i.PROFILE_SCOPE,i.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:z,tenant:i.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:jo,temporaryCacheLocation:jo,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!r||r.cacheLocation!==Eo),claimsBasedCachingEnabled:!1},l={loggerCallback:function(){},logLevel:o.Info,piiLoggingEnabled:!1},f=Oa(Oa({},oo),{},{loggerOptions:l,networkClient:t?new wa:ho,navigationClient:new ni,loadFrameTimeout:0,windowHashTimeout:(null==a?void 0:a.loadFrameTimeout)||6e4,iframeHashTimeout:(null==a?void 0:a.loadFrameTimeout)||Ta,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==a?void 0:a.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:To.DEFAULT_POLL_INTERVAL_MS}),p=Oa(Oa(Oa({},f),a),{},{loggerOptions:(null==a?void 0:a.loggerOptions)||l}),h={application:{appName:i.EMPTY_STRING,appVersion:i.EMPTY_STRING},client:new Co};if((null==n?void 0:n.protocolMode)!==K&&null!=n&&n.OIDCOptions&&new U(p.loggerOptions).warning(JSON.stringify(Sn(ln))),null!=n&&n.protocolMode&&n.protocolMode!==L&&null!=p&&p.allowNativeBroker)throw Sn(fn);return{auth:Oa(Oa(Oa({},u),n),{},{OIDCOptions:Oa(Oa({},u.OIDCOptions),null==n?void 0:n.OIDCOptions)}),cache:Oa(Oa({},s),r),system:p,telemetry:Oa(Oa({},h),c)}}(t,this.browserEnvironment);try{a=window[jo]}catch(e){}var c=null===(n=a)||void 0===n?void 0:n.getItem("msal.browser.log.level"),u=null===(r=a)||void 0===r||null===(r=r.getItem("msal.browser.log.pii"))||void 0===r?void 0:r.toLowerCase(),s="true"===u||"false"!==u&&void 0,l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pa(Object(n),!0).forEach((function(t){xa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.config.system.loggerOptions),f=c&&Object.keys(o).includes(c)?o[c]:void 0;f&&(l.loggerCallback=e.loggerCallback,l.logLevel=f),void 0!==s&&(l.piiLoggingEnabled=s),this.logger=new U(l,"@azure/msal-browser",Aa),this.available=!1},n=[{key:"loggerCallback",value:function(e,t){switch(e){case o.Error:return void console.error(t);case o.Info:return void console.info(t);case o.Verbose:return void console.debug(t);case o.Warning:return void console.warn(t);default:return void console.log(t)}}}],(t=[{key:"getConfig",value:function(){return this.config}},{key:"getLogger",value:function(){return this.logger}},{key:"isAvailable",value:function(){return this.available}},{key:"isBrowserEnvironment",value:function(){return this.browserEnvironment}}])&&Ea(e.prototype,t),n&&Ea(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Ra(e){return Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ra(e)}function Na(){var e=Ha(),t=e.m(Na),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Ma(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Na=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Ua(e,t)},AsyncIterator:Ba,async:function(e,t,n,o,a){return(r(t)?Fa:Ga)(i(e),t,n,o,a)},keys:qa,values:Ma}})()}function Ma(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Ra(e)+" is not iterable")}function qa(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Ga(e,t,n,r,o){var i=Fa(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Fa(e,t,n,r,o){return new Ba(Ha().w(e,t,n,r),o||Promise)}function Ba(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Ua?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Da(Ba.prototype),Da(Ba.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Da(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Ha(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Da(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Da(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Da(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Da(f,"constructor",s),Da(s,"constructor",u),u.displayName="GeneratorFunction",Da(s,o,"GeneratorFunction"),Da(f),Da(f,o,"Generator"),Da(f,r,(function(){return this})),Da(f,"toString",(function(){return"[object Generator]"})),(Ha=function(){return{w:i,m:p}})()}function Da(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Da=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Da(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Da(e,t,n,r)}function Ua(e,t){this.v=e,this.k=t}function La(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,za(r.key),r)}}function za(e){var t=function(e){if("object"!=Ra(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ra(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ra(t)?t:t+""}function Qa(e,t,n){return t=Ya(t),function(e,t){if(t&&("object"==Ra(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Wa()?Reflect.construct(t,n||[],Ya(e).constructor):t.apply(e,n))}function Wa(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Wa=function(){return!!e})()}function Ya(e){return Ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ya(e)}function Va(e,t){return Va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Va(e,t)}var Ja=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qa(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Va(e,t)}(t,e),n=t,r=[{key:"getModuleName",value:function(){return t.MODULE_NAME}},{key:"getId",value:function(){return t.ID}},{key:"initialize",value:(o=Na().mark((function e(){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.available="undefined"!=typeof window,e.abrupt("return",this.available);case 2:case"end":return e.stop()}}),e,this)})),i=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=o.apply(e,t);function a(e){La(i,n,r,a,c,"next",e)}function c(e){La(i,n,r,a,c,"throw",e)}a(void 0)}))},function(){return i.apply(this,arguments)})}],r&&Ka(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i}(_a);Ja.MODULE_NAME="",Ja.ID="StandardOperatingContext";var Za="missing_kid_error",Xa="missing_alg_error";function $a(e){return $a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$a(e)}function ec(e,t,n){return t=nc(t),function(e,t){if(t&&("object"==$a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,tc()?Reflect.construct(t,n||[],nc(e).constructor):t.apply(e,n))}function tc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(tc=function(){return!!e})()}function nc(e){return nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nc(e)}function rc(e,t){return rc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rc(e,t)}function oc(e,t,n){return(t=ic(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ic(e){var t=function(e){if("object"!=$a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=$a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$a(t)?t:t+""}var ac=oc(oc({},Za,"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."),Xa,"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."),cc=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=ec(this,t,[e,n])).name="JoseHeaderError",Object.setPrototypeOf(r,t.prototype),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rc(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(re);function uc(e){return new cc(e,ac[e])}function sc(e){return sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sc(e)}function lc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fc(r.key),r)}}function fc(e){var t=function(e){if("object"!=sc(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=sc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==sc(t)?t:t+""}var pc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.typ=t.typ,this.alg=t.alg,this.kid=t.kid}return t=e,n=[{key:"getShrHeaderString",value:function(t){if(!t.kid)throw uc(Za);if(!t.alg)throw uc(Xa);var n=new e({typ:t.typ||"pop",kid:t.kid,alg:t.alg});return JSON.stringify(n)}}],null&&lc(t.prototype,null),n&&lc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function hc(e){return encodeURIComponent(yc(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function dc(e){return vc(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function yc(e){return vc((new TextEncoder).encode(e))}function vc(e){var t=Array.from(e,(function(e){return String.fromCodePoint(e)})).join("");return btoa(t)}function mc(e){return(new TextDecoder).decode(function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw ia(Wi)}var n=atob(t);return Uint8Array.from(n,(function(e){return e.codePointAt(0)||0}))}(e))}function gc(e){return gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gc(e)}function bc(){var e=Tc(),t=e.m(bc),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,wc(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(bc=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Ic(e,t)},AsyncIterator:Cc,async:function(e,t,n,o,a){return(r(t)?Oc:Sc)(i(e),t,n,o,a)},keys:kc,values:wc}})()}function wc(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(gc(e)+" is not iterable")}function kc(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Sc(e,t,n,r,o){var i=Oc(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Oc(e,t,n,r,o){return new Cc(Tc().w(e,t,n,r),o||Promise)}function Cc(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Ic?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Ac(Cc.prototype),Ac(Cc.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ac(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Tc(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Ac(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ac(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ac(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Ac(f,"constructor",s),Ac(s,"constructor",u),u.displayName="GeneratorFunction",Ac(s,o,"GeneratorFunction"),Ac(f),Ac(f,o,"Generator"),Ac(f,r,(function(){return this})),Ac(f,"toString",(function(){return"[object Generator]"})),(Tc=function(){return{w:i,m:p}})()}function Ac(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ac=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Ac(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Ac(e,t,n,r)}function Ic(e,t){this.v=e,this.k=t}function Pc(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function xc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Pc(i,r,o,a,c,"next",e)}function c(e){Pc(i,r,o,a,c,"throw",e)}a(void 0)}))}}var Ec="SHA-256",jc=new Uint8Array([1,0,1]),_c="0123456789abcdef",Rc=new Uint32Array(1),Nc={name:"RSASSA-PKCS1-v1_5",hash:Ec,modulusLength:2048,publicExponent:jc};function Mc(e,t,n){return qc.apply(this,arguments)}function qc(){return(qc=xc(bc().mark((function e(t,n,r){var o,i;return bc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==n||n.addQueueMeasurement(yo.Sha256Digest,r),o=new TextEncoder,i=o.encode(t),e.abrupt("return",window.crypto.subtle.digest(Ec,i));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gc(e){return window.crypto.getRandomValues(e)}function Fc(){return window.crypto.getRandomValues(Rc),Rc[0]}function Bc(){var e=Date.now(),t=1024*Fc()+(1023&Fc()),n=new Uint8Array(16),r=Math.trunc(t/Math.pow(2,30)),o=t&Math.pow(2,30)-1,i=Fc();n[0]=e/Math.pow(2,40),n[1]=e/Math.pow(2,32),n[2]=e/Math.pow(2,24),n[3]=e/Math.pow(2,16),n[4]=e/Math.pow(2,8),n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;for(var a="",c=0;c<n.length;c++)a+=_c.charAt(n[c]>>>4),a+=_c.charAt(15&n[c]),3!==c&&5!==c&&7!==c&&9!==c||(a+="-");return a}function Hc(e,t){return Dc.apply(this,arguments)}function Dc(){return(Dc=xc(bc().mark((function e(t,n){return bc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.generateKey(Nc,t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Uc(e){return Lc.apply(this,arguments)}function Lc(){return(Lc=xc(bc().mark((function e(t){return bc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.exportKey(Yo,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kc(e,t,n){return zc.apply(this,arguments)}function zc(){return(zc=xc(bc().mark((function e(t,n,r){return bc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.importKey(Yo,t,Nc,n,r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qc(e,t){return Wc.apply(this,arguments)}function Wc(){return(Wc=xc(bc().mark((function e(t,n){return bc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.sign(Nc,t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yc(e){return Vc.apply(this,arguments)}function Vc(){return(Vc=xc(bc().mark((function e(t){var n,r;return bc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mc(t);case 2:return n=e.sent,r=new Uint8Array(n),e.abrupt("return",dc(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jc(e){return Jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jc(e)}function Zc(){var e=ru(),t=e.m(Zc),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Xc(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Zc=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new iu(e,t)},AsyncIterator:nu,async:function(e,t,n,o,a){return(r(t)?tu:eu)(i(e),t,n,o,a)},keys:$c,values:Xc}})()}function Xc(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Jc(e)+" is not iterable")}function $c(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function eu(e,t,n,r,o){var i=tu(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function tu(e,t,n,r,o){return new nu(ru().w(e,t,n,r),o||Promise)}function nu(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof iu?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(ou(nu.prototype),ou(nu.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ou(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function ru(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ou(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ou(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ou(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ou(f,"constructor",s),ou(s,"constructor",u),u.displayName="GeneratorFunction",ou(s,o,"GeneratorFunction"),ou(f),ou(f,o,"Generator"),ou(f,r,(function(){return this})),ou(f,"toString",(function(){return"[object Generator]"})),(ru=function(){return{w:i,m:p}})()}function ou(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ou=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){ou(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},ou(e,t,n,r)}function iu(e,t){this.v=e,this.k=t}function au(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function cu(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){au(i,r,o,a,c,"next",e)}function c(e){au(i,r,o,a,c,"throw",e)}a(void 0)}))}}function uu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,su(r.key),r)}}function su(e){var t=function(e){if("object"!=Jc(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Jc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jc(t)?t:t+""}var lu=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dbName=Vo,this.version=1,this.tableName=Jo,this.dbOpen=!1},t=[{key:"open",value:(s=cu(Zc().mark((function e(){var t=this;return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=window.indexedDB.open(t.dbName,t.version);r.addEventListener("upgradeneeded",(function(e){e.target.result.createObjectStore(t.tableName)})),r.addEventListener("success",(function(n){var r=n;t.db=r.target.result,t.dbOpen=!0,e()})),r.addEventListener("error",(function(){return n(ia(Hi))}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"closeConnection",value:function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}},{key:"validateDbIsOpen",value:(u=cu(Zc().mark((function e(){return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.dbOpen){e.next=2;break}return e.abrupt("return",this.open());case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getItem",value:(c=cu(Zc().mark((function e(t){var n=this;return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validateDbIsOpen();case 2:return e.abrupt("return",new Promise((function(e,r){if(!n.db)return r(ia(Ei));var o=n.db.transaction([n.tableName],"readonly").objectStore(n.tableName).get(t);o.addEventListener("success",(function(t){var r=t;n.closeConnection(),e(r.target.result)})),o.addEventListener("error",(function(e){n.closeConnection(),r(e)}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setItem",value:(a=cu(Zc().mark((function e(t,n){var r=this;return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validateDbIsOpen();case 2:return e.abrupt("return",new Promise((function(e,o){if(!r.db)return o(ia(Ei));var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(n,t);i.addEventListener("success",(function(){r.closeConnection(),e()})),i.addEventListener("error",(function(e){r.closeConnection(),o(e)}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"removeItem",value:(i=cu(Zc().mark((function e(t){var n=this;return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validateDbIsOpen();case 2:return e.abrupt("return",new Promise((function(e,r){if(!n.db)return r(ia(Ei));var o=n.db.transaction([n.tableName],"readwrite").objectStore(n.tableName).delete(t);o.addEventListener("success",(function(){n.closeConnection(),e()})),o.addEventListener("error",(function(e){n.closeConnection(),r(e)}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getKeys",value:(o=cu(Zc().mark((function e(){var t=this;return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validateDbIsOpen();case 2:return e.abrupt("return",new Promise((function(e,n){if(!t.db)return n(ia(Ei));var r=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).getAllKeys();r.addEventListener("success",(function(n){var r=n;t.closeConnection(),e(r.target.result)})),r.addEventListener("error",(function(e){t.closeConnection(),n(e)}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"containsKey",value:(r=cu(Zc().mark((function e(t){var n=this;return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validateDbIsOpen();case 2:return e.abrupt("return",new Promise((function(e,r){if(!n.db)return r(ia(Ei));var o=n.db.transaction([n.tableName],"readonly").objectStore(n.tableName).count(t);o.addEventListener("success",(function(t){var r=t;n.closeConnection(),e(1===r.target.result)})),o.addEventListener("error",(function(e){n.closeConnection(),r(e)}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"deleteDatabase",value:(n=cu(Zc().mark((function e(){return Zc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.db&&this.dbOpen&&this.closeConnection(),e.abrupt("return",new Promise((function(e,t){var n=window.indexedDB.deleteDatabase(Vo),r=setTimeout((function(){return t(!1)}),200);n.addEventListener("success",(function(){return clearTimeout(r),e(!0)})),n.addEventListener("blocked",(function(){return clearTimeout(r),e(!0)})),n.addEventListener("error",(function(){return clearTimeout(r),t(!1)}))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],t&&uu(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a,c,u,s}();function fu(e){return fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fu(e)}function pu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hu(r.key),r)}}function hu(e){var t=function(e){if("object"!=fu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fu(t)?t:t+""}var du=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=new Map},(t=[{key:"getItem",value:function(e){return this.cache.get(e)||null}},{key:"setItem",value:function(e,t){this.cache.set(e,t)}},{key:"removeItem",value:function(e){this.cache.delete(e)}},{key:"getKeys",value:function(){var e=[];return this.cache.forEach((function(t,n){e.push(n)})),e}},{key:"containsKey",value:function(e){return this.cache.has(e)}},{key:"clear",value:function(){this.cache.clear()}}])&&pu(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function yu(e){return yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yu(e)}function vu(){var e=Su(),t=e.m(vu),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,mu(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(vu=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Cu(e,t)},AsyncIterator:ku,async:function(e,t,n,o,a){return(r(t)?wu:bu)(i(e),t,n,o,a)},keys:gu,values:mu}})()}function mu(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(yu(e)+" is not iterable")}function gu(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function bu(e,t,n,r,o){var i=wu(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function wu(e,t,n,r,o){return new ku(Su().w(e,t,n,r),o||Promise)}function ku(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Cu?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Ou(ku.prototype),Ou(ku.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ou(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Su(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Ou(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ou(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ou(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Ou(f,"constructor",s),Ou(s,"constructor",u),u.displayName="GeneratorFunction",Ou(s,o,"GeneratorFunction"),Ou(f),Ou(f,o,"Generator"),Ou(f,r,(function(){return this})),Ou(f,"toString",(function(){return"[object Generator]"})),(Su=function(){return{w:i,m:p}})()}function Ou(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ou=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Ou(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Ou(e,t,n,r)}function Cu(e,t){this.v=e,this.k=t}function Tu(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Au(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Tu(i,r,o,a,c,"next",e)}function c(e){Tu(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Iu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pu(r.key),r)}}function Pu(e){var t=function(e){if("object"!=yu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=yu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yu(t)?t:t+""}var xu=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inMemoryCache=new du,this.indexedDBCache=new lu,this.logger=t},t=[{key:"handleDatabaseAccessError",value:function(e){if(!(e instanceof oa&&e.errorCode===Hi))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}},{key:"getItem",value:(c=Au(vu().mark((function e(t){var n;return vu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inMemoryCache.getItem(t)){e.next=12;break}return e.prev=2,this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),e.next=6,this.indexedDBCache.getItem(t);case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(2),this.handleDatabaseAccessError(e.t0);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(e){return c.apply(this,arguments)})},{key:"setItem",value:(a=Au(vu().mark((function e(t,n){return vu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inMemoryCache.setItem(t,n),e.prev=1,e.next=4,this.indexedDBCache.setItem(t,n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),this.handleDatabaseAccessError(e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e,t){return a.apply(this,arguments)})},{key:"removeItem",value:(i=Au(vu().mark((function e(t){return vu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inMemoryCache.removeItem(t),e.prev=1,e.next=4,this.indexedDBCache.removeItem(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),this.handleDatabaseAccessError(e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e){return i.apply(this,arguments)})},{key:"getKeys",value:(o=Au(vu().mark((function e(){var t;return vu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=this.inMemoryCache.getKeys()).length){e.next=12;break}return e.prev=2,this.logger.verbose("In-memory cache is empty, now querying persistent storage."),e.next=6,this.indexedDBCache.getKeys();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(2),this.handleDatabaseAccessError(e.t0);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(){return o.apply(this,arguments)})},{key:"containsKey",value:(r=Au(vu().mark((function e(t){var n;return vu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inMemoryCache.containsKey(t)){e.next=12;break}return e.prev=2,this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),e.next=6,this.indexedDBCache.containsKey(t);case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(2),this.handleDatabaseAccessError(e.t0);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(e){return r.apply(this,arguments)})},{key:"clearInMemory",value:function(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}},{key:"clearPersistent",value:(n=Au(vu().mark((function e(){var t;return vu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.logger.verbose("Deleting persistent keystore"),e.next=4,this.indexedDBCache.deleteDatabase();case 4:return(t=e.sent)&&this.logger.verbose("Persistent keystore deleted"),e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(0),this.handleDatabaseAccessError(e.t0),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return n.apply(this,arguments)})}],t&&Iu(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a,c}();function Eu(e){return Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eu(e)}function ju(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ju(Object(n),!0).forEach((function(t){Ru(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ju(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ru(e,t,n){return(t=Qu(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nu(){var e=Hu(),t=e.m(Nu),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Mu(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Nu=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Uu(e,t)},AsyncIterator:Bu,async:function(e,t,n,o,a){return(r(t)?Fu:Gu)(i(e),t,n,o,a)},keys:qu,values:Mu}})()}function Mu(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Eu(e)+" is not iterable")}function qu(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Gu(e,t,n,r,o){var i=Fu(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Fu(e,t,n,r,o){return new Bu(Hu().w(e,t,n,r),o||Promise)}function Bu(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Uu?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Du(Bu.prototype),Du(Bu.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Du(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Hu(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Du(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Du(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Du(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Du(f,"constructor",s),Du(s,"constructor",u),u.displayName="GeneratorFunction",Du(s,o,"GeneratorFunction"),Du(f),Du(f,o,"Generator"),Du(f,r,(function(){return this})),Du(f,"toString",(function(){return"[object Generator]"})),(Hu=function(){return{w:i,m:p}})()}function Du(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Du=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Du(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Du(e,t,n,r)}function Uu(e,t){this.v=e,this.k=t}function Lu(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ku(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Lu(i,r,o,a,c,"next",e)}function c(e){Lu(i,r,o,a,c,"throw",e)}a(void 0)}))}}function zu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qu(r.key),r)}}function Qu(e){var t=function(e){if("object"!=Eu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Eu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Eu(t)?t:t+""}var Wu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=t,function(e){if(!("crypto"in window))throw e.error("BrowserCrypto: crypto interface is unavailable"),ia(oi);e.verbose("BrowserCrypto: modern crypto interface available")}(t),this.cache=new xu(this.logger),this.performanceClient=n}return t=e,n=[{key:"createNewGuid",value:function(){return Bc()}},{key:"base64Encode",value:function(e){return yc(e)}},{key:"base64Decode",value:function(e){return mc(e)}},{key:"base64UrlEncode",value:function(e){return hc(e)}},{key:"encodeKid",value:function(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}},{key:"getPublicKeyThumbprint",value:(c=Ku(Nu().mark((function t(n){var r,o,i,a,c,u,s,l,f;return Nu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(yo.CryptoOptsGetPublicKeyThumbprint,n.correlationId),t.next=3,Hc(e.EXTRACTABLE,e.POP_KEY_USAGES);case 3:return i=t.sent,t.next=6,Uc(i.publicKey);case 6:return a=t.sent,c={e:a.e,kty:a.kty,n:a.n},u=Yu(c),t.next=11,this.hashString(u);case 11:return s=t.sent,t.next=14,Uc(i.privateKey);case 14:return l=t.sent,t.next=17,Kc(l,!1,["sign"]);case 17:return f=t.sent,t.next=20,this.cache.setItem(s,{privateKey:f,publicKey:i.publicKey,requestMethod:n.resourceRequestMethod,requestUri:n.resourceRequestUri});case 20:return o&&o.end({success:!0}),t.abrupt("return",s);case 22:case"end":return t.stop()}}),t,this)}))),function(e){return c.apply(this,arguments)})},{key:"removeTokenBindingKey",value:(a=Ku(Nu().mark((function e(t){var n;return Nu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cache.removeItem(t);case 2:return e.next=4,this.cache.containsKey(t);case 4:return n=e.sent,e.abrupt("return",!n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"clearKeystore",value:(i=Ku(Nu().mark((function e(){return Nu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cache.clearInMemory(),e.prev=1,e.next=4,this.cache.clearPersistent();case 4:return e.abrupt("return",!0);case 7:return e.prev=7,e.t0=e.catch(1),e.t0 instanceof Error?this.logger.error("Clearing keystore failed with error: ".concat(e.t0.message)):this.logger.error("Clearing keystore failed with unknown error"),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(){return i.apply(this,arguments)})},{key:"signJwt",value:(o=Ku(Nu().mark((function e(t,n,r,o){var i,a,c,u,s,l,f,p,h,d,y,v,m,g,b;return Nu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(yo.CryptoOptsSignJwt,o),e.next=3,this.cache.getItem(n);case 3:if(c=e.sent){e.next=6;break}throw ia(qi);case 6:return e.next=8,Uc(c.publicKey);case 8:return u=e.sent,s=Yu(u),l=hc(JSON.stringify({kid:n})),f=pc.getShrHeaderString(_u(_u({},null==r?void 0:r.header),{},{alg:u.alg,kid:l})),p=hc(f),t.cnf={jwk:JSON.parse(s)},h=hc(JSON.stringify(t)),d="".concat(p,".").concat(h),y=new TextEncoder,v=y.encode(d),e.next=20,Qc(c.privateKey,v);case 20:return m=e.sent,g=dc(new Uint8Array(m)),b="".concat(d,".").concat(g),a&&a.end({success:!0}),e.abrupt("return",b);case 25:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return o.apply(this,arguments)})},{key:"hashString",value:(r=Ku(Nu().mark((function e(t){return Nu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yc(t));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}],n&&zu(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,i,a,c}();function Yu(e){return JSON.stringify(e,Object.keys(e).sort())}function Vu(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}function Ju(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}function Zu(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}function Xu(e){return Xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(e)}function $u(e,t,n){return(t=function(e){var t=function(e){if("object"!=Xu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Xu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xu(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Wu.POP_KEY_USAGES=["sign","verify"],Wu.EXTRACTABLE=!0;var es=function(e,t,n,r,o){return function(){n.trace("Executing function ".concat(t));var i=null==r?void 0:r.startMeasurement(t,o);if(o){var a=t+"CallCount";null==r||r.incrementFields($u({},a,1),o)}try{var c=e.apply(void 0,arguments);return null==i||i.end({success:!0}),n.trace("Returning result from ".concat(t)),c}catch(e){n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw null==i||i.end({success:!1},e),e}}},ts=function(e,t,n,r,o){return function(){n.trace("Executing function ".concat(t));var i=null==r?void 0:r.startMeasurement(t,o);if(o){var a=t+"CallCount";null==r||r.incrementFields($u({},a,1),o)}return null==r||r.setPreQueueTime(t,o),e.apply(void 0,arguments).then((function(e){return n.trace("Returning result from ".concat(t)),null==i||i.end({success:!0}),e})).catch((function(e){n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw null==i||i.end({success:!1},e),e}))}};function ns(e){return ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ns(e)}function rs(){var e=ss(),t=e.m(rs),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,os(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(rs=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new fs(e,t)},AsyncIterator:us,async:function(e,t,n,o,a){return(r(t)?cs:as)(i(e),t,n,o,a)},keys:is,values:os}})()}function os(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ns(e)+" is not iterable")}function is(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function as(e,t,n,r,o){var i=cs(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function cs(e,t,n,r,o){return new us(ss().w(e,t,n,r),o||Promise)}function us(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof fs?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(ls(us.prototype),ls(us.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ls(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function ss(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ls(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ls(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ls(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ls(f,"constructor",s),ls(s,"constructor",u),u.displayName="GeneratorFunction",ls(s,o,"GeneratorFunction"),ls(f),ls(f,o,"Generator"),ls(f,r,(function(){return this})),ls(f,"toString",(function(){return"[object Generator]"})),(ss=function(){return{w:i,m:p}})()}function ls(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ls=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){ls(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},ls(e,t,n,r)}function fs(e,t){this.v=e,this.k=t}function ps(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function hs(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ps(i,r,o,a,c,"next",e)}function c(e){ps(i,r,o,a,c,"throw",e)}a(void 0)}))}}function ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ys(r.key),r)}}function ys(e){var t=function(e){if("object"!=ns(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ns(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ns(t)?t:t+""}var vs=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.networkInterface=t,this.logger=n,this.performanceClient=r,this.correlationId=o}return t=e,n=[{key:"detectRegion",value:(a=hs(rs().mark((function t(n,r){var o,a,c,u,s,l;return rs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(yo.RegionDiscoveryDetectRegion,this.correlationId),a=n){t.next=28;break}return c=e.IMDS_OPTIONS,t.prev=4,t.next=7,ts(this.getRegionFromIMDS.bind(this),yo.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(i.IMDS_VERSION,c);case 7:if(200===(u=t.sent).status&&(a=u.body,r.region_source="4"),400!==u.status){t.next=20;break}return t.next=12,ts(this.getCurrentVersion.bind(this),yo.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(c);case 12:if(s=t.sent){t.next=16;break}return r.region_source="1",t.abrupt("return",null);case 16:return t.next=18,ts(this.getRegionFromIMDS.bind(this),yo.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(s,c);case 18:200===(l=t.sent).status&&(a=l.body,r.region_source="4");case 20:t.next=26;break;case 22:return t.prev=22,t.t0=t.catch(4),r.region_source="1",t.abrupt("return",null);case 26:t.next=29;break;case 28:r.region_source="3";case 29:return a||(r.region_source="1"),t.abrupt("return",a||null);case 31:case"end":return t.stop()}}),t,this,[[4,22]])}))),function(e,t){return a.apply(this,arguments)})},{key:"getRegionFromIMDS",value:(o=hs(rs().mark((function e(t,n){var r;return rs().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.RegionDiscoveryGetRegionFromIMDS,this.correlationId),e.abrupt("return",this.networkInterface.sendGetRequestAsync("".concat(i.IMDS_ENDPOINT,"?api-version=").concat(t,"&format=text"),n,i.IMDS_TIMEOUT));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"getCurrentVersion",value:(r=hs(rs().mark((function e(t){var n,r;return rs().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.RegionDiscoveryGetCurrentVersion,this.correlationId),e.prev=1,e.next=4,this.networkInterface.sendGetRequestAsync("".concat(i.IMDS_ENDPOINT,"?format=json"),t);case 4:if(!(400===(r=e.sent).status&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0)){e.next=7;break}return e.abrupt("return",r.body["newest-versions"][0]);case 7:return e.abrupt("return",null);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return r.apply(this,arguments)})}],n&&ds(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,a}();function ms(e){return ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ms(e)}function gs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gs(Object(n),!0).forEach((function(t){ws(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ws(e,t,n){return(t=Rs(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ks(){var e=Is(),t=e.m(ks),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Ss(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ks=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new xs(e,t)},AsyncIterator:As,async:function(e,t,n,o,a){return(r(t)?Ts:Cs)(i(e),t,n,o,a)},keys:Os,values:Ss}})()}function Ss(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ms(e)+" is not iterable")}function Os(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Cs(e,t,n,r,o){var i=Ts(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Ts(e,t,n,r,o){return new As(Is().w(e,t,n,r),o||Promise)}function As(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof xs?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Ps(As.prototype),Ps(As.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ps(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Is(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Ps(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ps(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ps(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Ps(f,"constructor",s),Ps(s,"constructor",u),u.displayName="GeneratorFunction",Ps(s,o,"GeneratorFunction"),Ps(f),Ps(f,o,"Generator"),Ps(f,r,(function(){return this})),Ps(f,"toString",(function(){return"[object Generator]"})),(Is=function(){return{w:i,m:p}})()}function Ps(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ps=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Ps(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Ps(e,t,n,r)}function xs(e,t){this.v=e,this.k=t}function Es(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function js(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Es(i,r,o,a,c,"next",e)}function c(e){Es(i,r,o,a,c,"throw",e)}a(void 0)}))}}function _s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Rs(r.key),r)}}function Rs(e){var t=function(e){if("object"!=ms(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ms(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ms(t)?t:t+""}vs.IMDS_OPTIONS={headers:{Metadata:"true"}};var Ns=function(){function e(t,n,r,o,i,a,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canonicalAuthority=t,this._canonicalAuthority.validateAsUri(),this.networkInterface=n,this.cacheManager=r,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=c,this.correlationId=a,this.managedIdentity=u||!1,this.regionDiscovery=new vs(n,this.logger,this.performanceClient,this.correlationId)}return t=e,n=[{key:"getAuthorityType",value:function(e){if(e.HostNameAndPort.endsWith(i.CIAM_AUTH_URL))return 3;var t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case i.ADFS:return 1;case i.DSTS:return 2}return 0}},{key:"authorityType",get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}},{key:"protocolMode",get:function(){return this.authorityOptions.protocolMode}},{key:"options",get:function(){return this.authorityOptions}},{key:"canonicalAuthority",get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new tr(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}},{key:"canonicalAuthorityUrlComponents",get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}},{key:"hostnameAndPort",get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}},{key:"tenant",get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}},{key:"authorizationEndpoint",get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw it(le)}},{key:"tokenEndpoint",get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw it(le)}},{key:"deviceCodeEndpoint",get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw it(le)}},{key:"endSessionEndpoint",get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw it(Le);return this.replacePath(this.metadata.end_session_endpoint)}throw it(le)}},{key:"selfSignedJwtAudience",get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw it(le)}},{key:"jwksUri",get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw it(le)}},{key:"canReplaceTenant",value:function(t){return 1===t.PathSegments.length&&!e.reservedTenantDomains.has(t.PathSegments[0])&&0===this.getAuthorityType(t)&&this.protocolMode===L}},{key:"replaceTenant",value:function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}},{key:"replacePath",value:function(e){var t=this,n=e,r=new tr(this.metadata.canonical_authority).getUrlComponents(),o=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,i){var a=o[i];if(0===i&&t.canReplaceTenant(r)){var c=new tr(t.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];a!==c&&(t.logger.verbose("Replacing tenant domain name ".concat(a," with id ").concat(c)),a=c)}e!==a&&(n=n.replace("/".concat(a,"/"),"/".concat(e,"/")))})),this.replaceTenant(n)}},{key:"defaultOpenIdConfigurationEndpoint",get:function(){var e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode!==L&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}},{key:"discoveryComplete",value:function(){return!!this.metadata}},{key:"resolveEndpointsAsync",value:(l=js(ks().mark((function e(){var t,n,r,o,i;return ks().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(yo.AuthorityResolveEndpointsAsync,this.correlationId),r=this.getCurrentMetadataEntity(),e.next=4,ts(this.updateCloudDiscoveryMetadata.bind(this),yo.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(r);case 4:return o=e.sent,this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,r.preferred_network),e.next=8,ts(this.updateEndpointMetadata.bind(this),yo.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(r);case 8:i=e.sent,this.updateCachedMetadata(r,o,{source:i}),null===(n=this.performanceClient)||void 0===n||n.addFields({cloudDiscoverySource:o,authorityEndpointSource:i},this.correlationId);case 11:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"getCurrentMetadataEntity",value:function(){var e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Bt(),jwks_uri:""}),e}},{key:"updateCachedMetadata",value:function(e,t,n){t!==R&&(null==n?void 0:n.source)!==R&&(e.expiresAt=Bt(),e.canonical_authority=this.canonicalAuthority);var r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}},{key:"updateEndpointMetadata",value:(s=js(ks().mark((function e(t){var n,r,o,i,a,c;return ks().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.AuthorityUpdateEndpointMetadata,this.correlationId),!(r=this.updateEndpointMetadataFromLocalSources(t))){e.next=12;break}if(r.source!==M){e.next=11;break}if(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o||!o.azureRegion){e.next=11;break}if(!r.metadata){e.next=11;break}return e.next=8,ts(this.updateMetadataWithRegionalInformation.bind(this),yo.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r.metadata);case 8:i=e.sent,Ht(t,i,!1),t.canonical_authority=this.canonicalAuthority;case 11:return e.abrupt("return",r.source);case 12:return e.next=14,ts(this.getEndpointMetadataFromNetwork.bind(this),yo.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();case 14:if(!(a=e.sent)){e.next=24;break}if(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c||!c.azureRegion){e.next=20;break}return e.next=19,ts(this.updateMetadataWithRegionalInformation.bind(this),yo.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(a);case 19:a=e.sent;case 20:return Ht(t,a,!0),e.abrupt("return",N);case 24:throw it(pe,this.defaultOpenIdConfigurationEndpoint);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"updateEndpointMetadataFromLocalSources",value:function(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");var t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Ht(e,t,!1),{source:_};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{var n=this.getEndpointMetadataFromHardcodedValues();if(n)return Ht(e,n,!1),{source:M,metadata:n};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}var r=Ut(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:R}):(r&&this.logger.verbose("The metadata entity is expired."),null)}},{key:"isAuthoritySameType",value:function(e){return new tr(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}},{key:"getEndpointMetadataFromConfig",value:function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Sn(rn)}return null}},{key:"getEndpointMetadataFromNetwork",value:(u=js(ks().mark((function e(){var t,n,r,o;return ks().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(yo.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),n={},r=this.defaultOpenIdConfigurationEndpoint,this.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(r)),e.prev=4,e.next=7,this.networkInterface.sendGetRequestAsync(r,n);case 7:if(!Vu((o=e.sent).body)){e.next=13;break}return e.abrupt("return",o.body);case 13:return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),e.abrupt("return",null);case 15:e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(4),this.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(e.t0)),e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,this,[[4,17]])}))),function(){return u.apply(this,arguments)})},{key:"getEndpointMetadataFromHardcodedValues",value:function(){return this.hostnameAndPort in nr?nr[this.hostnameAndPort]:null}},{key:"updateMetadataWithRegionalInformation",value:(c=js(ks().mark((function t(n){var r,o,a,c,u;return ks().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),!(a=null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.azureRegion)){t.next=15;break}if(a===i.AZURE_REGION_AUTO_DISCOVER_FLAG){t.next=7;break}return this.regionDiscoveryMetadata.region_outcome="2",this.regionDiscoveryMetadata.region_used=a,t.abrupt("return",e.replaceWithRegionalInformation(n,a));case 7:return t.next=9,ts(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),yo.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c?void 0:c.environmentRegion,this.regionDiscoveryMetadata);case 9:if(!(u=t.sent)){t.next=14;break}return this.regionDiscoveryMetadata.region_outcome="4",this.regionDiscoveryMetadata.region_used=u,t.abrupt("return",e.replaceWithRegionalInformation(n,u));case 14:this.regionDiscoveryMetadata.region_outcome="5";case 15:return t.abrupt("return",n);case 16:case"end":return t.stop()}}),t,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateCloudDiscoveryMetadata",value:(a=js(ks().mark((function e(t){var n,r,o;return ks().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),!(r=this.updateCloudDiscoveryMetadataFromLocalSources(t))){e.next=4;break}return e.abrupt("return",r);case 4:return e.next=6,ts(this.getCloudDiscoveryMetadataFromNetwork.bind(this),yo.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();case 6:if(!(o=e.sent)){e.next=10;break}return Dt(t,o,!0),e.abrupt("return",N);case 10:throw Sn(on);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"updateCloudDiscoveryMetadataFromLocalSources",value:function(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||i.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||i.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||i.NOT_APPLICABLE));var t,n=this.getCloudDiscoveryMetadataFromConfig();if(n)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Dt(e,n,!1),_;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{var r=(t=this.hostnameAndPort,ar(rr.metadata,t));if(r)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Dt(e,r,!1),M;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var o=Ut(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found cloud discovery metadata in the cache."),R):(o&&this.logger.verbose("The metadata entity is expired."),null)}},{key:"getCloudDiscoveryMetadataFromConfig",value:function(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=ar(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Sn(nn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}},{key:"getCloudDiscoveryMetadataFromNetwork",value:(o=js(ks().mark((function t(){var n,r,o,a,c,u,s,l;return ks().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r="".concat(i.AAD_INSTANCE_DISCOVERY_ENDPT).concat(this.canonicalAuthority,"oauth2/v2.0/authorize"),o={},a=null,t.prev=4,t.next=7,this.networkInterface.sendGetRequestAsync(r,o);case 7:if(!Ju((c=t.sent).body)){t.next=14;break}u=c.body,s=u.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: ".concat(u.tenant_discovery_endpoint)),t.next=28;break;case 14:if(!Zu(c.body)){t.next=26;break}if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(c.status)),(u=c.body).error!==i.INVALID_INSTANCE){t.next=20;break}return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),t.abrupt("return",null);case 20:this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(u.error)),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(u.error_description)),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[],t.next=28;break;case 26:return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),t.abrupt("return",null);case 28:this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),a=ar(s,this.hostnameAndPort),t.next=36;break;case 32:return t.prev=32,t.t0=t.catch(4),t.t0 instanceof re?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(t.t0.errorCode,"\nError Description: ").concat(t.t0.errorMessage)):(l=t.t0,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(l.name,"\nError Description: ").concat(l.message))),t.abrupt("return",null);case 36:return a||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),a=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),t.abrupt("return",a);case 38:case"end":return t.stop()}}),t,this,[[4,32]])}))),function(){return o.apply(this,arguments)})},{key:"isInKnownAuthorities",value:function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return t&&tr.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0}},{key:"getPreferredCache",value:function(){if(this.managedIdentity)return i.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw it(le)}},{key:"isAlias",value:function(e){return this.metadata.aliases.indexOf(e)>-1}},{key:"isAliasOfKnownMicrosoftAuthority",value:function(e){return or.has(e)}}],r=[{key:"generateAuthority",value:function(e,t){var n;if(t&&t.azureCloudInstance!==z){var r=t.tenant?t.tenant:i.DEFAULT_COMMON_TENANT;n="".concat(t.azureCloudInstance,"/").concat(r,"/")}return n||e}},{key:"createCloudDiscoveryMetadataFromHost",value:function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}},{key:"isPublicCloudAuthority",value:function(e){return i.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}},{key:"buildRegionalAuthorityString",value:function(e,t,n){var r=new tr(e);r.validateAsUri();var o=r.getUrlComponents(),a="".concat(t,".").concat(o.HostNameAndPort);this.isPublicCloudAuthority(o.HostNameAndPort)&&(a="".concat(t,".").concat(i.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));var c=tr.constructAuthorityUriFromObject(bs(bs({},r.getUrlComponents()),{},{HostNameAndPort:a})).urlString;return n?"".concat(c,"?").concat(n):c}},{key:"replaceWithRegionalInformation",value:function(t,n){var r=bs({},t);return r.authorization_endpoint=e.buildRegionalAuthorityString(r.authorization_endpoint,n),r.token_endpoint=e.buildRegionalAuthorityString(r.token_endpoint,n),r.end_session_endpoint&&(r.end_session_endpoint=e.buildRegionalAuthorityString(r.end_session_endpoint,n)),r}},{key:"transformCIAMAuthority",value:function(e){var t=e,n=new tr(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(i.CIAM_AUTH_URL)){var r=n.HostNameAndPort.split(".")[0];t="".concat(t).concat(r).concat(i.AAD_TENANT_DOMAIN_SUFFIX)}return t}}],n&&_s(t.prototype,n),r&&_s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,a,c,u,s,l}();function Ms(e){var t,n=null===(t=new tr(e).getUrlComponents().PathSegments.slice(-1)[0])||void 0===t?void 0:t.toLowerCase();switch(n){case g:case b:case w:return;default:return n}}function qs(e){return e.endsWith(i.FORWARD_SLASH)?e:"".concat(e).concat(i.FORWARD_SLASH)}function Gs(e){var t=e.cloudDiscoveryMetadata,n=void 0;if(t)try{n=JSON.parse(t)}catch(e){throw Sn(nn)}return{canonicalAuthority:e.authority?qs(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}Ns.reservedTenantDomains=new Set(["{tenant}","{tenantid}",g,w,b]);var Fs="no_tokens_found",Bs="native_account_unavailable",Hs="refresh_token_expired",Ds="bad_token";function Us(e){return Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Us(e)}function Ls(e,t,n){return t=zs(t),function(e,t){if(t&&("object"==Us(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ks()?Reflect.construct(t,n||[],zs(e).constructor):t.apply(e,n))}function Ks(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ks=function(){return!!e})()}function zs(e){return zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zs(e)}function Qs(e,t){return Qs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qs(e,t)}function Ws(e,t,n){return(t=Ys(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ys(e){var t=function(e){if("object"!=Us(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Us(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Us(t)?t:t+""}var Vs=["interaction_required","consent_required","login_required",Ds],Js=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Zs=Ws(Ws(Ws(Ws({},Fs,"No refresh token found in the cache. Please sign-in."),Bs,"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."),Hs,"Refresh token has expired."),Ds,"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."),Xs=(Zs[Fs],Zs[Bs],Zs[Ds],function(e){function t(e,n,r,o,a,c,u,s){var l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l=Ls(this,t,[e,n,r]),Object.setPrototypeOf(l,t.prototype),l.timestamp=o||i.EMPTY_STRING,l.traceId=a||i.EMPTY_STRING,l.correlationId=c||i.EMPTY_STRING,l.claims=u||i.EMPTY_STRING,l.name="InteractionRequiredAuthError",l.errorNo=s,l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qs(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(re));function $s(e,t,n){var r=!!e&&Vs.indexOf(e)>-1,o=!!n&&Js.indexOf(n)>-1,i=!!t&&Vs.some((function(e){return t.indexOf(e)>-1}));return r||i||o}function el(e){return new Xs(e,Zs[e])}function tl(e){return tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tl(e)}function nl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rl(r.key),r)}}function rl(e){var t=function(e){if("object"!=tl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=tl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==tl(t)?t:t+""}var ol=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,n=[{key:"setRequestState",value:function(t,n,r){var o=e.generateLibraryState(t,r);return n?"".concat(o).concat(i.RESOURCE_DELIM).concat(n):o}},{key:"generateLibraryState",value:function(e,t){if(!e)throw it(Ne);var n={id:e.createNewGuid()};t&&(n.meta=t);var r=JSON.stringify(n);return e.base64Encode(r)}},{key:"parseRequestState",value:function(e,t){if(!e)throw it(Ne);if(!t)throw it(de);try{var n=t.split(i.RESOURCE_DELIM),r=n[0],o=n.length>1?n.slice(1).join(i.RESOURCE_DELIM):i.EMPTY_STRING,a=e.base64Decode(r),c=JSON.parse(a);return{userRequestState:o||i.EMPTY_STRING,libraryState:c}}catch(e){throw it(de)}}}],null&&nl(t.prototype,null),n&&nl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}(),il="home_account_id",al="UPN",cl="storage_not_supported",ul="stubbed_public_client_application_called",sl="in_mem_redirect_unavailable";function ll(e){return ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ll(e)}function fl(e,t,n){return t=hl(t),function(e,t){if(t&&("object"==ll(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,pl()?Reflect.construct(t,n||[],hl(e).constructor):t.apply(e,n))}function pl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(pl=function(){return!!e})()}function hl(e){return hl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hl(e)}function dl(e,t){return dl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dl(e,t)}function yl(e,t,n){return(t=vl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vl(e){var t=function(e){if("object"!=ll(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ll(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ll(t)?t:t+""}var ml=yl(yl(yl({},cl,"Given storage configuration option was not supported."),ul,"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"),sl,"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."),gl=(ml[cl],ml[ul],ml[sl],function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=fl(this,t,[e,n])).name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,t.prototype),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dl(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(re));function bl(e){return new gl(e,ml[e])}function wl(e){return wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wl(e)}function kl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Sl(r.key),r)}}function Sl(e){var t=function(e){if("object"!=wl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=wl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wl(t)?t:t+""}var Ol=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.validateWindowStorage(t),this.windowStorage=window[t]},(t=[{key:"validateWindowStorage",value:function(e){if(e!==Eo&&e!==jo||!window[e])throw bl(cl)}},{key:"getItem",value:function(e){return this.windowStorage.getItem(e)}},{key:"setItem",value:function(e,t){this.windowStorage.setItem(e,t)}},{key:"removeItem",value:function(e){this.windowStorage.removeItem(e)}},{key:"getKeys",value:function(){return Object.keys(this.windowStorage)}},{key:"containsKey",value:function(e){return this.windowStorage.hasOwnProperty(e)}}])&&kl(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function Cl(e,t){if(!t)return null;try{return ol.parseRequestState(e,t).libraryState.meta}catch(e){throw it(de)}}function Tl(){var e=jl(),t=e.m(Tl),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Al(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Tl=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Rl(e,t)},AsyncIterator:El,async:function(e,t,n,o,a){return(r(t)?xl:Pl)(i(e),t,n,o,a)},keys:Il,values:Al}})()}function Al(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ql(e)+" is not iterable")}function Il(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Pl(e,t,n,r,o){var i=xl(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function xl(e,t,n,r,o){return new El(jl().w(e,t,n,r),o||Promise)}function El(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Rl?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(_l(El.prototype),_l(El.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),_l(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function jl(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return _l(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(_l(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_l(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,_l(f,"constructor",s),_l(s,"constructor",u),u.displayName="GeneratorFunction",_l(s,o,"GeneratorFunction"),_l(f),_l(f,o,"Generator"),_l(f,r,(function(){return this})),_l(f,"toString",(function(){return"[object Generator]"})),(jl=function(){return{w:i,m:p}})()}function _l(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_l=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){_l(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},_l(e,t,n,r)}function Rl(e,t){this.v=e,this.k=t}function Nl(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ml(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Nl(i,r,o,a,c,"next",e)}function c(e){Nl(i,r,o,a,c,"throw",e)}a(void 0)}))}}function ql(e){return ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ql(e)}function Gl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fl(r.key),r)}}function Fl(e){var t=function(e){if("object"!=ql(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ql(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ql(t)?t:t+""}function Bl(e,t,n){return t=Ll(t),function(e,t){if(t&&("object"==ql(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Hl()?Reflect.construct(t,n||[],Ll(e).constructor):t.apply(e,n))}function Hl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Hl=function(){return!!e})()}function Dl(e,t,n,r){var o=Ul(Ll(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof o?function(e){return o.apply(n,e)}:o}function Ul(){return Ul="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Ll(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ul.apply(null,arguments)}function Ll(e){return Ll=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ll(e)}function Kl(e,t){return Kl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Kl(e,t)}var zl=function(e){function t(e,n,r,o,i,a){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(c=Bl(this,t,[e,r,o,i])).COOKIE_LIFE_MULTIPLIER=864e5,c.cacheConfig=n,c.logger=o,c.internalStorage=new du,c.browserStorage=c.setupBrowserStorage(c.cacheConfig.cacheLocation),c.temporaryCacheStorage=c.setupTemporaryCacheStorage(c.cacheConfig.temporaryCacheLocation,c.cacheConfig.cacheLocation),n.cacheMigrationEnabled&&(c.migrateCacheEntries(),c.createKeyMaps()),c.performanceClient=a,c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kl(e,t)}(t,e),n=t,r=[{key:"setupBrowserStorage",value:function(e){switch(e){case Eo:case jo:try{return new Ol(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=_o,new du}},{key:"setupTemporaryCacheStorage",value:function(e,t){switch(t){case Eo:case jo:try{return new Ol(e||jo)}catch(e){return this.logger.verbose(e),this.internalStorage}default:return this.internalStorage}}},{key:"migrateCacheEntries",value:function(){var e=this,t="".concat(i.CACHE_PREFIX,".").concat(f),n="".concat(i.CACHE_PREFIX,".").concat(p),r="".concat(i.CACHE_PREFIX,".").concat(d),o="".concat(i.CACHE_PREFIX,".").concat(y),a=[this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(r),this.browserStorage.getItem(o)];[f,p,d,y].forEach((function(t,n){var r=a[n];r&&e.setTemporaryCache(t,r,!0)}))}},{key:"createKeyMaps",value:function(){var e=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var t=this.getItem(Do),n=this.getItem("".concat(Uo,".").concat(this.clientId));t&&n?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){if(e.isCredentialKey(t)){var n=e.getItem(t);if(n){var r=e.validateAndParseJson(n);if(r&&r.hasOwnProperty("credentialType"))switch(r.credentialType){case P.ID_TOKEN:if(_t(r)){e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: ".concat(t," found, saving key to token key map"));var o=r,i=e.updateCredentialCacheKey(t,o);return void e.addTokenKey(i,P.ID_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: ".concat(t));break;case P.ACCESS_TOKEN:case P.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(jt(r)){e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: ".concat(t," found, saving key to token key map"));var a=r,c=e.updateCredentialCacheKey(t,a);return void e.addTokenKey(c,P.ACCESS_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ".concat(t));break;case P.REFRESH_TOKEN:if(Rt(r)){e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: ".concat(t," found, saving key to token key map"));var u=r,s=e.updateCredentialCacheKey(t,u);return void e.addTokenKey(s,P.REFRESH_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ".concat(t))}}}if(e.isAccountKey(t)){var l=e.getItem(t);if(l){var f=e.validateAndParseJson(l);f&&Vn.isAccountEntity(f)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: ".concat(t," found, saving key to account key map")),e.addAccountKeyToMap(t))}}}))}},{key:"validateAndParseJson",value:function(e){try{var t=JSON.parse(e);return t&&"object"===ql(t)?t:null}catch(e){return null}}},{key:"getItem",value:function(e){return this.browserStorage.getItem(e)}},{key:"setItem",value:function(e,t){this.browserStorage.setItem(e,t)}},{key:"getAccount",value:function(e,t){this.logger.trace("BrowserCacheManager.getAccount called");var n=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,n,t)}},{key:"getCachedAccountEntity",value:function(e){var t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;var n=this.validateAndParseJson(t);return n&&Vn.isAccountEntity(n)?Dr.toObject(new Vn,n):(this.removeAccountKeyFromMap(e),null)}},{key:"setAccount",value:function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}},{key:"getAccountKeys",value:function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(Do);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}},{key:"addAccountKeyToMap",value:function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(Do,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}},{key:"removeAccountKeyFromMap",value:function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));var t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(Do,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}},{key:"removeAccount",value:(l=Ml(Tl().mark((function e(n){return Tl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Dl(t,"removeAccount",this,3)([n]),this.removeAccountKeyFromMap(n);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"removeOutdatedAccount",value:function(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}},{key:"removeIdToken",value:function(e){Dl(t,"removeIdToken",this,3)([e]),this.removeTokenKey(e,P.ID_TOKEN)}},{key:"removeAccessToken",value:(s=Ml(Tl().mark((function e(n){return Tl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Dl(t,"removeAccessToken",this,3)([n]),this.removeTokenKey(n,P.ACCESS_TOKEN);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"removeRefreshToken",value:function(e){Dl(t,"removeRefreshToken",this,3)([e]),this.removeTokenKey(e,P.REFRESH_TOKEN)}},{key:"getTokenKeys",value:function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem("".concat(Uo,".").concat(this.clientId));if(e){var t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}},{key:"addTokenKey",value:function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var n=this.getTokenKeys();switch(t){case P.ID_TOKEN:-1===n.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case P.ACCESS_TOKEN:-1===n.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case P.REFRESH_TOKEN:-1===n.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:throw this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),it(Me)}this.setItem("".concat(Uo,".").concat(this.clientId),JSON.stringify(n))}},{key:"removeTokenKey",value:function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var n=this.getTokenKeys();switch(t){case P.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ".concat(e," from map"));var r=n.idToken.indexOf(e);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case P.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ".concat(e," from map"));var o=n.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case P.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ".concat(e," from map"));var i=n.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),it(Me)}this.setItem("".concat(Uo,".").concat(this.clientId),JSON.stringify(n))}},{key:"getIdTokenCredential",value:function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,P.ID_TOKEN),null;var n=this.validateAndParseJson(t);return n&&_t(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,P.ID_TOKEN),null)}},{key:"setIdTokenCredential",value:function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=At(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,P.ID_TOKEN)}},{key:"getAccessTokenCredential",value:function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,P.ACCESS_TOKEN),null;var n=this.validateAndParseJson(t);return n&&jt(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,P.ACCESS_TOKEN),null)}},{key:"setAccessTokenCredential",value:function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=At(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,P.ACCESS_TOKEN)}},{key:"getRefreshTokenCredential",value:function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,P.REFRESH_TOKEN),null;var n=this.validateAndParseJson(t);return n&&Rt(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,P.REFRESH_TOKEN),null)}},{key:"setRefreshTokenCredential",value:function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=At(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,P.REFRESH_TOKEN)}},{key:"getAppMetadata",value:function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var n,r=this.validateAndParseJson(t);return r&&((n=r)&&0===e.indexOf(x)&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}},{key:"setAppMetadata",value:function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t,n,r,o=(n=(t=e).environment,r=t.clientId,[x,n,r].join(I.CACHE_KEY_SEPARATOR).toLowerCase());this.setItem(o,JSON.stringify(e))}},{key:"getServerTelemetry",value:function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var n,r,o,i=this.validateAndParseJson(t);return i&&(n=i,r=0===e.indexOf(q.CACHE_KEY),o=!0,n&&(o=n.hasOwnProperty("failedRequests")&&n.hasOwnProperty("errors")&&n.hasOwnProperty("cacheHits")),r&&o)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),i):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}},{key:"setServerTelemetry",value:function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}},{key:"getAuthorityMetadata",value:function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(j)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}},{key:"getAuthorityMetadataKeys",value:function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))}},{key:"setWrapperMetadata",value:function(e,t){this.internalStorage.setItem(Lo,e),this.internalStorage.setItem(Ko,t)}},{key:"getWrapperMetadata",value:function(){return[this.internalStorage.getItem(Lo)||i.EMPTY_STRING,this.internalStorage.getItem(Ko)||i.EMPTY_STRING]}},{key:"setAuthorityMetadata",value:function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}},{key:"getActiveAccount",value:function(){var e=this.generateCacheKey(m),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var n=this.generateCacheKey(v),r=this.getItem(n);if(!r)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var o=this.getAccountInfoFilteredBy({localAccountId:r});return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(o),o):null}var i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId,tenantId:i.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}},{key:"setActiveAccount",value:function(e){var t=this.generateCacheKey(m),n=this.generateCacheKey(v);if(e){this.logger.verbose("setActiveAccount: Active account set");var r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r)),this.browserStorage.setItem(n,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n)}},{key:"getThrottlingCache",value:function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&function(e,t){var n=!1;e&&(n=0===e.indexOf(F));var r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}},{key:"setThrottlingCache",value:function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}},{key:"getTemporaryCache",value:function(e,t){var n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var r=this.getItemCookie(n);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),r}var o=this.temporaryCacheStorage.getItem(n);if(!o){if(this.cacheConfig.cacheLocation===Eo){var i=this.browserStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}},{key:"setTemporaryCache",value:function(e,t,n){var r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(r,t))}},{key:"removeItem",value:function(e){this.browserStorage.removeItem(e)}},{key:"removeTemporaryItem",value:function(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}},{key:"getKeys",value:function(){return this.browserStorage.getKeys()}},{key:"clear",value:(u=Ml(Tl().mark((function e(){var t=this;return Tl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.removeAllAccounts();case 2:this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((function(e){-1===e.indexOf(i.CACHE_PREFIX)&&-1===e.indexOf(t.clientId)||t.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((function(e){-1===e.indexOf(i.CACHE_PREFIX)&&-1===e.indexOf(t.clientId)||t.browserStorage.removeItem(e)})),this.internalStorage.clear();case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"clearTokensAndKeysWithClaims",value:(c=Ml(Tl().mark((function e(t,n){var r,o,i=this;return Tl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addQueueMeasurement(yo.ClearTokensAndKeysWithClaims,n),r=this.getTokenKeys(),o=[],r.accessToken.forEach((function(e){var t=i.getAccessTokenCredential(e);null!=t&&t.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&o.push(i.removeAccessToken(e))})),e.next=6,Promise.all(o);case 6:o.length>0&&this.logger.warning("".concat(o.length," access tokens with claims in the cache keys have been removed from the cache."));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"setItemCookie",value:function(e,t,n){var r="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=Lax;");if(n){var o=this.getCookieExpirationTime(n);r+="expires=".concat(o,";")}this.cacheConfig.secureCookies&&(r+="Secure;"),document.cookie=r}},{key:"getItemCookie",value:function(e){for(var t="".concat(encodeURIComponent(e),"="),n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return i.EMPTY_STRING}},{key:"clearMsalCookies",value:function(){var e=this,t="".concat(i.CACHE_PREFIX,".").concat(this.clientId);document.cookie.split(";").forEach((function(n){for(;" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t)){var r=n.split("=")[0];e.clearItemCookie(r)}}))}},{key:"clearItemCookie",value:function(e){this.setItemCookie(e,i.EMPTY_STRING,-1)}},{key:"getCookieExpirationTime",value:function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}},{key:"generateCacheKey",value:function(e){return this.validateAndParseJson(e)?JSON.stringify(e):In.startsWith(e,i.CACHE_PREFIX)||In.startsWith(e,h)?e:"".concat(i.CACHE_PREFIX,".").concat(this.clientId,".").concat(e)}},{key:"generateAuthorityKey",value:function(e){var t=ol.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey("".concat("authority",".").concat(t))}},{key:"generateNonceKey",value:function(e){var t=ol.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey("".concat("nonce.id_token",".").concat(t))}},{key:"generateStateKey",value:function(e){var t=ol.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey("".concat(Ro,".").concat(t))}},{key:"getCachedAuthority",value:function(e){var t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;var r=this.generateAuthorityKey(n);return this.getTemporaryCache(r)}},{key:"updateCacheEntries",value:function(e,t,n,r,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,n,!1),o){var u={credential:o.homeAccountId,type:il};this.setTemporaryCache(Fo,JSON.stringify(u),!0)}else if(r){var s={credential:r,type:al};this.setTemporaryCache(Fo,JSON.stringify(s),!0)}}},{key:"resetRequestCache",value:function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach((function(n){-1!==n.indexOf(e)&&t.removeTemporaryItem(n)})),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(qo)),this.removeTemporaryItem(this.generateCacheKey(No)),this.removeTemporaryItem(this.generateCacheKey(Mo)),this.removeTemporaryItem(this.generateCacheKey(Bo)),this.removeTemporaryItem(this.generateCacheKey(Fo)),this.removeTemporaryItem(this.generateCacheKey(Ho)),this.setInteractionInProgress(!1)}},{key:"cleanRequestByState",value:function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ".concat(n)),this.resetRequestCache(n||i.EMPTY_STRING)}this.clearMsalCookies()}},{key:"cleanRequestByInteractionType",value:function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach((function(n){if(-1!==n.indexOf(Ro)){var r=t.temporaryCacheStorage.getItem(n);if(r){var o=Cl(t.cryptoImpl,r);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ".concat(r)),t.resetRequestCache(r))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)}},{key:"cacheCodeRequest",value:function(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var t=yc(JSON.stringify(e));this.setTemporaryCache(qo,t,!0)}},{key:"getCachedRequest",value:function(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");var t,n=this.getTemporaryCache(qo,!0);if(!n)throw ia(Ci);try{t=JSON.parse(mc(n))}catch(e){throw this.logger.errorPii("Attempted to parse: ".concat(n)),this.logger.error("Parsing cached token request threw with error: ".concat(e)),ia(Ti)}if(this.removeTemporaryItem(this.generateCacheKey(qo)),!t.authority){var r=this.generateAuthorityKey(e),o=this.getTemporaryCache(r);if(!o)throw ia(Ai);t.authority=o}return t}},{key:"getCachedNativeRequest",value:function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(Ho,!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}},{key:"isInteractionInProgress",value:function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t}},{key:"getInteractionInProgress",value:function(){var e="".concat(i.CACHE_PREFIX,".").concat(Go);return this.getTemporaryCache(e,!1)}},{key:"setInteractionInProgress",value:function(e){var t="".concat(i.CACHE_PREFIX,".").concat(Go);if(e){if(this.getInteractionInProgress())throw ia(fi);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}},{key:"getLegacyLoginHint",value:function(){var e=this.getTemporaryCache(h);e&&(this.browserStorage.removeItem(h),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(f,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(f)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var n=t||e;if(n){var r=kt(n,mc);if(r.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),r.preferred_username;if(r.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),r.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}},{key:"updateCredentialCacheKey",value:function(e,t){var n=At(t);if(e!==n){var r=this.getItem(e);if(r)return this.browserStorage.removeItem(e),this.setItem(n,r),this.logger.verbose("Updated an outdated ".concat(t.credentialType," cache key")),n;this.logger.error("Attempted to update an outdated ".concat(t.credentialType," cache key but no item matching the outdated key was found in storage"))}return e}},{key:"hydrateCache",value:(a=Ml(Tl().mark((function e(t,n){var r,o,i,a,c,u,s;return Tl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=It(null===(r=t.account)||void 0===r?void 0:r.homeAccountId,null===(o=t.account)||void 0===o?void 0:o.environment,t.idToken,this.clientId,t.tenantId),!n.claims){e.next=5;break}return e.next=4,this.cryptoImpl.hashString(n.claims);case 4:c=e.sent;case 5:return u=Pt(null===(i=t.account)||void 0===i?void 0:i.homeAccountId,t.account.environment,t.accessToken,this.clientId,t.tenantId,t.scopes.join(" "),t.expiresOn?t.expiresOn.getTime()/1e3:0,t.extExpiresOn?t.extExpiresOn.getTime()/1e3:0,mc,void 0,t.tokenType,void 0,n.sshKid,n.claims,c),s={idToken:a,accessToken:u},e.abrupt("return",this.saveCacheRecord(s));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"saveCacheRecord",value:(o=Ml(Tl().mark((function e(n,r,o){var i;return Tl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Dl(t,"saveCacheRecord",this,3)([n,r,o]);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),e.t0 instanceof mr&&this.performanceClient&&o)try{i=this.getTokenKeys(),this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},o)}catch(e){}throw e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,t,n){return o.apply(this,arguments)})}],r&&Gl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,a,c,u,s,l}(Dr),Ql=function(e,t){return new zl(e,{cacheLocation:_o,temporaryCacheLocation:_o,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},gt,t)};function Wl(e,t,n,r){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(r):[]}function Yl(e,t,n){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;var r=n.getAccountInfoFilteredBy(e);return r?(t.verbose("getAccount: Account matching provided filter found, returning"),r):(t.verbose("getAccount: No matching account found, returning null"),null)}function Vl(e,t,n){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;var r=n.getAccountInfoFilteredBy({username:e});return r?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),r):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}function Jl(e,t,n){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;var r=n.getAccountInfoFilteredBy({homeAccountId:e});return r?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),r):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function Zl(e,t,n){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;var r=n.getAccountInfoFilteredBy({localAccountId:e});return r?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),r):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function Xl(e,t){t.setActiveAccount(e)}function $l(e){return e.getActiveAccount()}function ef(){return window.parent!==window}function tf(){return window.location.href.split("?")[0].split("#")[0]}function nf(){if("undefined"==typeof window)throw ia(xi)}function rf(e){if(!e)throw ia(zi)}function of(e){nf(),function(){if(tr.hashContainsKnownProperties(window.location.hash)&&ef())throw ia(gi)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("".concat(To.POPUP_NAME_PREFIX,".")))throw ia(bi)}(),rf(e)}function af(e,t){if(of(e),function(e){if(ef()&&!e)throw ia(mi)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===_o&&!t.cache.storeAuthStateInCookie)throw bl(sl)}function cf(e){var t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((function(){try{document.head.removeChild(t)}catch(e){}}),1e4)}var uf="msal:initializeEnd",sf="msal:loginStart",lf="msal:loginSuccess",ff="msal:loginFailure",pf="msal:acquireTokenStart",hf="msal:acquireTokenSuccess",df="msal:acquireTokenFailure",yf="msal:acquireTokenByCodeFailure",vf="msal:handleRedirectEnd",mf="msal:popupOpened",gf="msal:logoutStart",bf="msal:logoutSuccess",wf="msal:logoutFailure",kf="msal:logoutEnd";function Sf(e){return Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sf(e)}function Of(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Cf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tf(r.key),r)}}function Tf(e){var t=function(e){if("object"!=Sf(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Sf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Sf(t)?t:t+""}var Af=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventCallbacks=new Map,this.logger=t||new U({})},(t=[{key:"addEventCallback",value:function(e,t,n){if("undefined"!=typeof window){var r=n||Bc();return this.eventCallbacks.has(r)?(this.logger.error("Event callback with id: ".concat(r," is already registered. Please provide a unique id or remove the existing callback and try again.")),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose("Event callback registered with id: ".concat(r)),r)}return null}},{key:"removeEventCallback",value:function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}},{key:"emitEvent",value:function(e,t,n,r){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};this.eventCallbacks.forEach((function(t,n){var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Of(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Of(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),a=r[0],c=r[1];(0===c.length||c.includes(e))&&(o.logger.verbose("Emitting event to callback ".concat(n,": ").concat(e)),a.apply(null,[i]))}))}}}])&&Cf(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function If(e){return If="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},If(e)}function Pf(e,t,n){return t=Ef(t),function(e,t){if(t&&("object"==If(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,xf()?Reflect.construct(t,n||[],Ef(e).constructor):t.apply(e,n))}function xf(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(xf=function(){return!!e})()}function Ef(e){return Ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ef(e)}function jf(e,t){return jf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jf(e,t)}var _f=function(e){function t(e,n,r,o,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Pf(this,t,[e,n,r])).name="ServerError",a.errorNo=o,a.status=i,Object.setPrototypeOf(a,t.prototype),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jf(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(re);function Rf(e){return Rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rf(e)}function Nf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Mf(r.key),r)}}function Mf(e){var t=function(e){if("object"!=Rf(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Rf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Rf(t)?t:t+""}var qf=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,n=[{key:"generateThrottlingStorageKey",value:function(e){return"".concat(F,".").concat(JSON.stringify(e))}},{key:"preProcess",value:function(t,n){var r=e.generateThrottlingStorageKey(n),o=t.getThrottlingCache(r);if(o){var a;if(o.throttleTime<Date.now())return void t.removeItem(r);throw new _f((null===(a=o.errorCodes)||void 0===a?void 0:a.join(" "))||i.EMPTY_STRING,o.errorMessage,o.subError)}}},{key:"postProcess",value:function(t,n,r){if(e.checkResponseStatus(r)||e.checkResponseForRetryAfter(r)){var o={throttleTime:e.calculateThrottleTime(parseInt(r.headers[u])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(n),o)}}},{key:"checkResponseStatus",value:function(e){return 429===e.status||e.status>=500&&e.status<600}},{key:"checkResponseForRetryAfter",value:function(e){return!!e.headers&&e.headers.hasOwnProperty(u)&&(e.status<200||e.status>=300)}},{key:"calculateThrottleTime",value:function(e){var t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||60),n+3600))}},{key:"removeThrottle",value:function(e,t,n,r){var o={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:r,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},i=this.generateThrottlingStorageKey(o);e.removeItem(i)}}],null&&Nf(t.prototype,null),n&&Nf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function Gf(e){return Gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gf(e)}function Ff(){var e=Kf(),t=e.m(Ff),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Bf(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ff=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Qf(e,t)},AsyncIterator:Lf,async:function(e,t,n,o,a){return(r(t)?Uf:Df)(i(e),t,n,o,a)},keys:Hf,values:Bf}})()}function Bf(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Gf(e)+" is not iterable")}function Hf(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Df(e,t,n,r,o){var i=Uf(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Uf(e,t,n,r,o){return new Lf(Kf().w(e,t,n,r),o||Promise)}function Lf(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Qf?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(zf(Lf.prototype),zf(Lf.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),zf(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Kf(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return zf(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(zf(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,zf(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,zf(f,"constructor",s),zf(s,"constructor",u),u.displayName="GeneratorFunction",zf(s,o,"GeneratorFunction"),zf(f),zf(f,o,"Generator"),zf(f,r,(function(){return this})),zf(f,"toString",(function(){return"[object Generator]"})),(Kf=function(){return{w:i,m:p}})()}function zf(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}zf=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){zf(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},zf(e,t,n,r)}function Qf(e,t){this.v=e,this.k=t}function Wf(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Yf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vf(r.key),r)}}function Vf(e){var t=function(e){if("object"!=Gf(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Gf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Gf(t)?t:t+""}var Jf=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.networkClient=t,this.cacheManager=n},t=[{key:"sendPostRequest",value:(n=Ff().mark((function e(t,n,r){var o;return Ff().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return qf.preProcess(this.cacheManager,t),e.prev=1,e.next=4,this.networkClient.sendPostRequestAsync(n,r);case 4:o=e.sent,e.next=14;break;case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof re)){e.next=13;break}throw e.t0;case 13:throw it(fe);case 14:return qf.postProcess(this.cacheManager,t,o),e.abrupt("return",o);case 16:case"end":return e.stop()}}),e,this,[[1,7]])})),r=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){Wf(i,r,o,a,c,"next",e)}function c(e){Wf(i,r,o,a,c,"throw",e)}a(void 0)}))},function(e,t,n){return r.apply(this,arguments)})}],t&&Yf(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}(),Zf="client_id",Xf="response_type",$f="token_type",ep="req_cnf",tp="return_spa_code";function np(e){return np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},np(e)}function rp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,op(r.key),r)}}function op(e){var t=function(e){if("object"!=np(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=np(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==np(t)?t:t+""}var ip=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"validateRedirectUri",value:function(e){if(!e)throw Sn(Kt)}},{key:"validatePrompt",value:function(e){var t=[];for(var n in S)t.push(S[n]);if(t.indexOf(e)<0)throw Sn(Jt)}},{key:"validateClaims",value:function(e){try{JSON.parse(e)}catch(e){throw Sn(Zt)}}},{key:"validateCodeChallengeParams",value:function(e,t){if(!e||!t)throw Sn(tn);this.validateCodeChallengeMethod(t)}},{key:"validateCodeChallengeMethod",value:function(e){if([O.PLAIN,O.S256].indexOf(e)<0)throw Sn(en)}}],null&&rp(e.prototype,null),t&&rp(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function ap(e){return ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ap(e)}function cp(e){return function(e){if(Array.isArray(e))return sp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||up(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function up(e,t){if(e){if("string"==typeof e)return sp(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sp(e,t):void 0}}function sp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function lp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fp(r.key),r)}}function fp(e){var t=function(e){if("object"!=ap(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ap(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ap(t)?t:t+""}var pp=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parameters=new Map},t=[{key:"addResponseTypeCode",value:function(){this.parameters.set(Xf,encodeURIComponent(i.CODE_RESPONSE_TYPE))}},{key:"addResponseTypeForTokenAndIdToken",value:function(){this.parameters.set(Xf,encodeURIComponent("".concat(i.TOKEN_RESPONSE_TYPE," ").concat(i.ID_TOKEN_RESPONSE_TYPE)))}},{key:"addResponseMode",value:function(e){this.parameters.set("response_mode",encodeURIComponent(e||T.QUERY))}},{key:"addNativeBroker",value:function(){this.parameters.set("nativebroker",encodeURIComponent("1"))}},{key:"addScopes",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a;!t||n.includes("openid")||e.includes("openid")||n.push("openid");var r=t?[].concat(cp(e||[]),cp(n)):e||[],o=new _n(r);this.parameters.set("scope",encodeURIComponent(o.printScopes()))}},{key:"addClientId",value:function(e){this.parameters.set(Zf,encodeURIComponent(e))}},{key:"addRedirectUri",value:function(e){ip.validateRedirectUri(e),this.parameters.set("redirect_uri",encodeURIComponent(e))}},{key:"addPostLogoutRedirectUri",value:function(e){ip.validateRedirectUri(e),this.parameters.set("post_logout_redirect_uri",encodeURIComponent(e))}},{key:"addIdTokenHint",value:function(e){this.parameters.set("id_token_hint",encodeURIComponent(e))}},{key:"addDomainHint",value:function(e){this.parameters.set("domain_hint",encodeURIComponent(e))}},{key:"addLoginHint",value:function(e){this.parameters.set("login_hint",encodeURIComponent(e))}},{key:"addCcsUpn",value:function(e){this.parameters.set(s,encodeURIComponent("UPN:".concat(e)))}},{key:"addCcsOid",value:function(e){this.parameters.set(s,encodeURIComponent("Oid:".concat(e.uid,"@").concat(e.utid)))}},{key:"addSid",value:function(e){this.parameters.set("sid",encodeURIComponent(e))}},{key:"addClaims",value:function(e,t){var n=this.addClientCapabilitiesToClaims(e,t);ip.validateClaims(n),this.parameters.set("claims",encodeURIComponent(n))}},{key:"addCorrelationId",value:function(e){this.parameters.set("client-request-id",encodeURIComponent(e))}},{key:"addLibraryInfo",value:function(e){this.parameters.set("x-client-SKU",e.sku),this.parameters.set("x-client-VER",e.version),e.os&&this.parameters.set("x-client-OS",e.os),e.cpu&&this.parameters.set("x-client-CPU",e.cpu)}},{key:"addApplicationTelemetry",value:function(e){null!=e&&e.appName&&this.parameters.set("x-app-name",e.appName),null!=e&&e.appVersion&&this.parameters.set("x-app-ver",e.appVersion)}},{key:"addPrompt",value:function(e){ip.validatePrompt(e),this.parameters.set("".concat("prompt"),encodeURIComponent(e))}},{key:"addState",value:function(e){e&&this.parameters.set("state",encodeURIComponent(e))}},{key:"addNonce",value:function(e){this.parameters.set("nonce",encodeURIComponent(e))}},{key:"addCodeChallengeParams",value:function(e,t){if(ip.validateCodeChallengeParams(e,t),!e||!t)throw Sn(tn);this.parameters.set("code_challenge",encodeURIComponent(e)),this.parameters.set("code_challenge_method",encodeURIComponent(t))}},{key:"addAuthorizationCode",value:function(e){this.parameters.set("code",encodeURIComponent(e))}},{key:"addDeviceCode",value:function(e){this.parameters.set("device_code",encodeURIComponent(e))}},{key:"addRefreshToken",value:function(e){this.parameters.set("refresh_token",encodeURIComponent(e))}},{key:"addCodeVerifier",value:function(e){this.parameters.set("code_verifier",encodeURIComponent(e))}},{key:"addClientSecret",value:function(e){this.parameters.set("client_secret",encodeURIComponent(e))}},{key:"addClientAssertion",value:function(e){e&&this.parameters.set("client_assertion",encodeURIComponent(e))}},{key:"addClientAssertionType",value:function(e){e&&this.parameters.set("client_assertion_type",encodeURIComponent(e))}},{key:"addOboAssertion",value:function(e){this.parameters.set("assertion",encodeURIComponent(e))}},{key:"addRequestTokenUse",value:function(e){this.parameters.set("requested_token_use",encodeURIComponent(e))}},{key:"addGrantType",value:function(e){this.parameters.set("grant_type",encodeURIComponent(e))}},{key:"addClientInfo",value:function(){this.parameters.set("client_info","1")}},{key:"addExtraQueryParameters",value:function(e){var t=this;Object.entries(e).forEach((function(e){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||up(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),r=n[0],o=n[1];!t.parameters.has(r)&&o&&t.parameters.set(r,o)}))}},{key:"addClientCapabilitiesToClaims",value:function(e,t){var n;if(e)try{n=JSON.parse(e)}catch(e){throw Sn(Zt)}else n={};return t&&t.length>0&&(n.hasOwnProperty(k)||(n[k]={}),n[k].xms_cc={values:t}),JSON.stringify(n)}},{key:"addUsername",value:function(e){this.parameters.set("username",encodeURIComponent(e))}},{key:"addPassword",value:function(e){this.parameters.set("password",encodeURIComponent(e))}},{key:"addPopToken",value:function(e){e&&(this.parameters.set($f,G.POP),this.parameters.set(ep,encodeURIComponent(e)))}},{key:"addSshJwk",value:function(e){e&&(this.parameters.set($f,G.SSH),this.parameters.set(ep,encodeURIComponent(e)))}},{key:"addServerTelemetry",value:function(e){this.parameters.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),this.parameters.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}},{key:"addThrottling",value:function(){this.parameters.set("x-ms-lib-capability","retry-after, h429")}},{key:"addLogoutHint",value:function(e){this.parameters.set("logout_hint",encodeURIComponent(e))}},{key:"createQueryString",value:function(){var e=new Array;return this.parameters.forEach((function(t,n){e.push("".concat(n,"=").concat(t))})),e.join("&")}}],t&&lp(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function hp(e){return hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hp(e)}function dp(){var e=wp(),t=e.m(dp),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,yp(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(dp=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Sp(e,t)},AsyncIterator:bp,async:function(e,t,n,o,a){return(r(t)?gp:mp)(i(e),t,n,o,a)},keys:vp,values:yp}})()}function yp(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(hp(e)+" is not iterable")}function vp(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function mp(e,t,n,r,o){var i=gp(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function gp(e,t,n,r,o){return new bp(wp().w(e,t,n,r),o||Promise)}function bp(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Sp?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(kp(bp.prototype),kp(bp.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),kp(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function wp(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return kp(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(kp(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,kp(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,kp(f,"constructor",s),kp(s,"constructor",u),u.displayName="GeneratorFunction",kp(s,o,"GeneratorFunction"),kp(f),kp(f,o,"Generator"),kp(f,r,(function(){return this})),kp(f,"toString",(function(){return"[object Generator]"})),(wp=function(){return{w:i,m:p}})()}function kp(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}kp=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){kp(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},kp(e,t,n,r)}function Sp(e,t){this.v=e,this.k=t}function Op(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Cp(e,t,n,r,o,i,a){return Tp.apply(this,arguments)}function Tp(){var e;return e=dp().mark((function e(t,n,r,o,i,a,c){var u,s;return dp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==c||c.addQueueMeasurement(yo.AuthorityFactoryCreateDiscoveredInstance,a),u=Ns.transformCIAMAuthority(qs(t)),s=new Ns(u,n,r,o,i,a,c),e.prev=3,e.next=6,ts(s.resolveEndpointsAsync.bind(s),yo.AuthorityResolveEndpointsAsync,i,c,a)();case 6:return e.abrupt("return",s);case 9:throw e.prev=9,e.t0=e.catch(3),it(le);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})),Tp=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Op(i,r,o,a,c,"next",e)}function c(e){Op(i,r,o,a,c,"throw",e)}a(void 0)}))},Tp.apply(this,arguments)}function Ap(e){return Ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ap(e)}function Ip(){var e=Rp(),t=e.m(Ip),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Pp(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ip=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Mp(e,t)},AsyncIterator:_p,async:function(e,t,n,o,a){return(r(t)?jp:Ep)(i(e),t,n,o,a)},keys:xp,values:Pp}})()}function Pp(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Ap(e)+" is not iterable")}function xp(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Ep(e,t,n,r,o){var i=jp(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function jp(e,t,n,r,o){return new _p(Rp().w(e,t,n,r),o||Promise)}function _p(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Mp?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Np(_p.prototype),Np(_p.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Np(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Rp(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Np(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Np(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Np(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Np(f,"constructor",s),Np(s,"constructor",u),u.displayName="GeneratorFunction",Np(s,o,"GeneratorFunction"),Np(f),Np(f,o,"Generator"),Np(f,r,(function(){return this})),Np(f,"toString",(function(){return"[object Generator]"})),(Rp=function(){return{w:i,m:p}})()}function Np(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Np=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Np(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Np(e,t,n,r)}function Mp(e,t){this.v=e,this.k=t}function qp(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Gp(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){qp(i,r,o,a,c,"next",e)}function c(e){qp(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Fp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bp(r.key),r)}}function Bp(e){var t=function(e){if("object"!=Ap(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ap(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ap(t)?t:t+""}var Hp=function(){return e=function e(t,n){var r,o,i,a,c,u,s,l,f,p,h,d,y,v,m,g;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=(i=(r=t).authOptions,a=r.systemOptions,c=r.loggerOptions,u=r.cacheOptions,s=r.storageInterface,l=r.networkInterface,f=r.cryptoInterface,p=r.clientCredentials,h=r.libraryInfo,d=r.telemetry,y=r.serverTelemetryManager,v=r.persistencePlugin,m=r.serializableCache,g=zr(zr({},io),c),{authOptions:(o=i,zr({clientCapabilities:[],azureCloudOptions:lo,skipAuthorityMetadataCache:!1,instanceAware:!1},o)),systemOptions:zr(zr({},oo),a),loggerOptions:g,cacheOptions:zr(zr({},ao),u),storageInterface:s||new Ur(i.clientId,gt,new U(g)),networkInterface:l||co,cryptoInterface:f||gt,clientCredentials:p||so,libraryInfo:zr(zr({},uo),h),telemetry:zr(zr({},fo),d),serverTelemetryManager:y||null,persistencePlugin:v||null,serializableCache:m||null}),this.logger=new U(this.config.loggerOptions,bt,wt),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Jf(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=n},t=[{key:"createTokenRequestHeaders",value:function(e){var t={};if(t["Content-Type"]=i.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case il:try{var n=Nn(e.credential);t[s]="Oid:".concat(n.uid,"@").concat(n.utid)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case al:t[s]="UPN: ".concat(e.credential)}return t}},{key:"executePostToTokenEndpoint",value:(r=Gp(Ip().mark((function e(t,n,r,o,i,a){var c,u,s,l,f;return Ip().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a&&(null===(l=this.performanceClient)||void 0===l||l.addQueueMeasurement(a,i)),e.next=3,this.networkManager.sendPostRequest(o,t,{body:n,headers:r});case 3:return f=e.sent,null===(c=this.performanceClient)||void 0===c||c.addFields({refreshTokenSize:(null===(u=f.body.refresh_token)||void 0===u?void 0:u.length)||0,httpVerToken:(null===(s=f.headers)||void 0===s?void 0:s["x-ms-httpver"])||""},i),this.config.serverTelemetryManager&&f.status<500&&429!==f.status&&this.config.serverTelemetryManager.clearTelemetryCache(),e.abrupt("return",f);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,o,i,a){return r.apply(this,arguments)})},{key:"updateAuthority",value:(n=Gp(Ip().mark((function e(t,n){var r,o,i;return Ip().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.UpdateTokenEndpointAuthority,n),o="https://".concat(t,"/").concat(this.authority.tenant,"/"),e.next=4,Cp(o,this.networkClient,this.cacheManager,this.authority.options,this.logger,n,this.performanceClient);case 4:i=e.sent,this.authority=i;case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"createTokenQueryParameters",value:function(e){var t=new pp;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}}],t&&Fp(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function Dp(e){return Dp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dp(e)}function Up(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Up(Object(n),!0).forEach((function(t){Kp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Up(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kp(e,t,n){return(t=rh(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zp(){var e=Zp(),t=e.m(zp),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Qp(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(zp=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new $p(e,t)},AsyncIterator:Jp,async:function(e,t,n,o,a){return(r(t)?Vp:Yp)(i(e),t,n,o,a)},keys:Wp,values:Qp}})()}function Qp(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Dp(e)+" is not iterable")}function Wp(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Yp(e,t,n,r,o){var i=Vp(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Vp(e,t,n,r,o){return new Jp(Zp().w(e,t,n,r),o||Promise)}function Jp(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof $p?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Xp(Jp.prototype),Xp(Jp.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Xp(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Zp(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Xp(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Xp(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Xp(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Xp(f,"constructor",s),Xp(s,"constructor",u),u.displayName="GeneratorFunction",Xp(s,o,"GeneratorFunction"),Xp(f),Xp(f,o,"Generator"),Xp(f,r,(function(){return this})),Xp(f,"toString",(function(){return"[object Generator]"})),(Zp=function(){return{w:i,m:p}})()}function Xp(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Xp=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Xp(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Xp(e,t,n,r)}function $p(e,t){this.v=e,this.k=t}function eh(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function th(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){eh(i,r,o,a,c,"next",e)}function c(e){eh(i,r,o,a,c,"throw",e)}a(void 0)}))}}function nh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rh(r.key),r)}}function rh(e){var t=function(e){if("object"!=Dp(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Dp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Dp(t)?t:t+""}var oh=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cryptoUtils=t,this.performanceClient=n},t=[{key:"generateCnf",value:(i=th(zp().mark((function e(t,n){var r,o,i;return zp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.PopTokenGenerateCnf,t.correlationId),e.next=3,ts(this.generateKid.bind(this),yo.PopTokenGenerateCnf,n,this.performanceClient,t.correlationId)(t);case 3:return o=e.sent,i=this.cryptoUtils.base64UrlEncode(JSON.stringify(o)),e.abrupt("return",{kid:o.kid,reqCnfString:i});case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"generateKid",value:(o=th(zp().mark((function e(t){var n,r;return zp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.PopTokenGenerateKid,t.correlationId),e.next=3,this.cryptoUtils.getPublicKeyThumbprint(t);case 3:return r=e.sent,e.abrupt("return",{kid:r,xms_ksl:"sw"});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"signPopToken",value:(r=th(zp().mark((function e(t,n,r){return zp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.signPayload(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"signPayload",value:(n=th(zp().mark((function e(t,n,r,o){var i,a,c,u,s,l,f;return zp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.resourceRequestMethod,a=r.resourceRequestUri,c=r.shrClaims,u=r.shrNonce,s=r.shrOptions,l=a?new tr(a):void 0,f=null==l?void 0:l.getUrlComponents(),e.abrupt("return",this.cryptoUtils.signJwt(Lp({at:t,ts:Ot(),m:null==i?void 0:i.toUpperCase(),u:null==f?void 0:f.HostNameAndPort,nonce:u||this.cryptoUtils.createNewGuid(),p:null==f?void 0:f.AbsolutePath,q:null!=f&&f.QueryString?[[],f.QueryString]:void 0,client_claims:c||void 0},o),n,s,r.correlationId));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r,o){return n.apply(this,arguments)})}],t&&nh(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i}();function ih(e){return ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ih(e)}function ah(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ch(r.key),r)}}function ch(e){var t=function(e){if("object"!=ih(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ih(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ih(t)?t:t+""}var uh=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=t,this.hasChanged=n},(t=[{key:"cacheHasChanged",get:function(){return this.hasChanged}},{key:"tokenCache",get:function(){return this.cache}}])&&ah(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function sh(e){return sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sh(e)}function lh(){var e=vh(),t=e.m(lh),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,fh(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(lh=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new gh(e,t)},AsyncIterator:yh,async:function(e,t,n,o,a){return(r(t)?dh:hh)(i(e),t,n,o,a)},keys:ph,values:fh}})()}function fh(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(sh(e)+" is not iterable")}function ph(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function hh(e,t,n,r,o){var i=dh(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function dh(e,t,n,r,o){return new yh(vh().w(e,t,n,r),o||Promise)}function yh(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof gh?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(mh(yh.prototype),mh(yh.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),mh(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function vh(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return mh(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(mh(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,mh(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,mh(f,"constructor",s),mh(s,"constructor",u),u.displayName="GeneratorFunction",mh(s,o,"GeneratorFunction"),mh(f),mh(f,o,"Generator"),mh(f,r,(function(){return this})),mh(f,"toString",(function(){return"[object Generator]"})),(vh=function(){return{w:i,m:p}})()}function mh(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}mh=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){mh(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},mh(e,t,n,r)}function gh(e,t){this.v=e,this.k=t}function bh(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function wh(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){bh(i,r,o,a,c,"next",e)}function c(e){bh(i,r,o,a,c,"throw",e)}a(void 0)}))}}function kh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Sh(r.key),r)}}function Sh(e){var t=function(e){if("object"!=sh(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=sh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==sh(t)?t:t+""}var Oh=function(){function e(t,n,r,o,i,a,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientId=t,this.cacheStorage=n,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=a,this.performanceClient=c}return t=e,n=[{key:"validateServerAuthorizationCodeResponse",value:function(e,t){if(!e.state||!t)throw e.state?it(ve,"Cached State"):it(ve,"Server State");var n,r;try{n=decodeURIComponent(e.state)}catch(t){throw it(de,e.state)}try{r=decodeURIComponent(t)}catch(t){throw it(de,e.state)}if(n!==r)throw it(ye);if(e.error||e.error_description||e.suberror){var o=function(e){var t,n,r=null===(t=e.error_uri)||void 0===t?void 0:t.lastIndexOf("code=");return r&&r>=0?null===(n=e.error_uri)||void 0===n?void 0:n.substring(r+5):void 0}(e);if($s(e.error,e.error_description,e.suberror))throw new Xs(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",o);throw new _f(e.error||"",e.error_description,e.suberror,o)}}},{key:"validateTokenResponse",value:function(e,t){if(e.error||e.error_description||e.suberror){var n,r="Error(s): ".concat(e.error_codes||i.NOT_AVAILABLE," - Timestamp: ").concat(e.timestamp||i.NOT_AVAILABLE," - Description: ").concat(e.error_description||i.NOT_AVAILABLE," - Correlation ID: ").concat(e.correlation_id||i.NOT_AVAILABLE," - Trace ID: ").concat(e.trace_id||i.NOT_AVAILABLE),o=null!==(n=e.error_codes)&&void 0!==n&&n.length?e.error_codes[0]:void 0,a=new _f(e.error,r,e.suberror,o,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(a));if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(a));if($s(e.error,e.error_description,e.suberror))throw new Xs(e.error,e.error_description,e.suberror,e.timestamp||i.EMPTY_STRING,e.trace_id||i.EMPTY_STRING,e.correlation_id||i.EMPTY_STRING,e.claims||i.EMPTY_STRING,o);throw a}}},{key:"handleServerTokenResponse",value:(a=wh(lh().mark((function t(n,r,o,a,c,u,s,l,f){var p,h,d,y,v,m,g;return lh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(p=this.performanceClient)||void 0===p||p.addQueueMeasurement(yo.HandleServerTokenResponse,n.correlation_id),!n.id_token){t.next=11;break}if(h=kt(n.id_token||i.EMPTY_STRING,this.cryptoObj.base64Decode),!c||!c.nonce){t.next=6;break}if(h.nonce===c.nonce){t.next=6;break}throw it(me);case 6:if(!a.maxAge&&0!==a.maxAge){t.next=11;break}if(d=h.auth_time){t.next=10;break}throw it(ge);case 10:St(d,a.maxAge);case 11:if(this.homeAccountIdentifier=Vn.generateHomeAccountId(n.client_info||i.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,h),c&&c.state&&(y=ol.parseRequestState(this.cryptoObj,c.state)),n.key_id=n.key_id||a.sshKid||void 0,v=this.generateCacheRecord(n,r,o,a,h,u,c),t.prev=15,!this.persistencePlugin||!this.serializableCache){t.next=21;break}return this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new uh(this.serializableCache,!0),t.next=21,this.persistencePlugin.beforeCacheAccess(m);case 21:if(!s||l||!v.account){t.next=29;break}if(g=v.account.generateAccountKey(),this.cacheStorage.getAccount(g,this.logger)){t.next=29;break}return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),t.next=28,e.generateAuthenticationResult(this.cryptoObj,r,v,!1,a,h,y,void 0,f);case 28:return t.abrupt("return",t.sent);case 29:return t.next=31,this.cacheStorage.saveCacheRecord(v,a.storeInCache,a.correlationId);case 31:if(t.prev=31,!(this.persistencePlugin&&this.serializableCache&&m)){t.next=36;break}return this.logger.verbose("Persistence enabled, calling afterCacheAccess"),t.next=36,this.persistencePlugin.afterCacheAccess(m);case 36:return t.finish(31);case 37:return t.abrupt("return",e.generateAuthenticationResult(this.cryptoObj,r,v,!1,a,h,y,n,f));case 38:case"end":return t.stop()}}),t,this,[[15,,31,37]])}))),function(e,t,n,r,o,i,c,u,s){return a.apply(this,arguments)})},{key:"generateCacheRecord",value:function(e,t,n,r,o,i,a){var c=t.getPreferredCache();if(!c)throw it(_e);var u,s,l=zn(o);e.id_token&&o&&(u=It(this.homeAccountIdentifier,c,e.id_token,this.clientId,l||""),s=Ch(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,c,l,a,void 0,this.logger));var f=null;if(e.access_token){var p=e.scope?_n.fromString(e.scope):new _n(r.scopes||[]),h=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,d=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,v=n+h,m=v+d,g=y&&y>0?n+y:void 0;f=Pt(this.homeAccountIdentifier,c,e.access_token,this.clientId,l||t.tenant||"",p.printScopes(),v,m,this.cryptoObj.base64Decode,g,e.token_type,i,e.key_id,r.claims,r.requestedClaimsHash)}var b,w=null;e.refresh_token&&(e.refresh_token_expires_in&&(b=n+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),w=xt(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,i,b));var k=null;return e.foci&&(k={clientId:this.clientId,environment:c,familyId:e.foci}),{account:s,idToken:u,accessToken:f,refreshToken:w,appMetadata:k}}}],r=[{key:"generateAuthenticationResult",value:(o=wh(lh().mark((function e(t,n,r,o,a,c,u,s,l){var f,p,h,d,y,v,m,g,b,w,k,S,O,C,T,A,I,P;return lh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=i.EMPTY_STRING,m=[],g=null,k=i.EMPTY_STRING,!r.accessToken){e.next=20;break}if(r.accessToken.tokenType!==G.POP||a.popKid){e.next=15;break}if(S=new oh(t),O=r.accessToken,C=O.secret,T=O.keyId){e.next=10;break}throw it(Ke);case 10:return e.next=12,S.signPopToken(C,T,a);case 12:v=e.sent,e.next=16;break;case 15:v=r.accessToken.secret;case 16:m=_n.fromString(r.accessToken.target).asArray(),g=new Date(1e3*Number(r.accessToken.expiresOn)),b=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),r.accessToken.refreshOn&&(w=new Date(1e3*Number(r.accessToken.refreshOn)));case 20:return r.appMetadata&&(k=r.appMetadata.familyId===E?E:""),A=(null==c?void 0:c.oid)||(null==c?void 0:c.sub)||"",I=(null==c?void 0:c.tid)||"",null!=s&&s.spa_accountid&&r.account&&(r.account.nativeAccountId=null==s?void 0:s.spa_accountid),P=r.account?Kn(r.account.getAccountInfo(),void 0,c,null===(f=r.idToken)||void 0===f?void 0:f.secret):null,e.abrupt("return",{authority:n.canonicalAuthority,uniqueId:A,tenantId:I,scopes:m,account:P,idToken:(null==r||null===(p=r.idToken)||void 0===p?void 0:p.secret)||"",idTokenClaims:c||{},accessToken:v,fromCache:o,expiresOn:g,extExpiresOn:b,refreshOn:w,correlationId:a.correlationId,requestId:l||i.EMPTY_STRING,familyId:k,tokenType:(null===(h=r.accessToken)||void 0===h?void 0:h.tokenType)||i.EMPTY_STRING,state:u?u.userRequestState:i.EMPTY_STRING,cloudGraphHostName:(null===(d=r.account)||void 0===d?void 0:d.cloudGraphHostName)||i.EMPTY_STRING,msGraphHost:(null===(y=r.account)||void 0===y?void 0:y.msGraphHost)||i.EMPTY_STRING,code:null==s?void 0:s.spa_code,fromNativeBroker:!1});case 26:case"end":return e.stop()}}),e)}))),function(e,t,n,r,i,a,c,u,s){return o.apply(this,arguments)})}],n&&kh(t.prototype,n),r&&kh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,a}();function Ch(e,t,n,r,o,i,a,c,u,s,l){null==l||l.verbose("setCachedAccount called");var f=e.getAccountKeys().find((function(e){return e.startsWith(n)})),p=null;f&&(p=e.getAccount(f,l));var h=p||Vn.createAccount({homeAccountId:n,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:null==u?void 0:u.cloud_graph_host_name,msGraphHost:null==u?void 0:u.msgraph_host,nativeAccountId:s},t,r),d=h.tenantProfiles||[],y=c||h.realm;if(y&&!d.find((function(e){return e.tenantId===y}))){var v=Ln(n,h.localAccountId,y,o);d.push(v)}return h.tenantProfiles=d,h}function Th(e){return Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Th(e)}function Ah(){var e=_h(),t=e.m(Ah),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Ih(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ah=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Nh(e,t)},AsyncIterator:jh,async:function(e,t,n,o,a){return(r(t)?Eh:xh)(i(e),t,n,o,a)},keys:Ph,values:Ih}})()}function Ih(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Th(e)+" is not iterable")}function Ph(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function xh(e,t,n,r,o){var i=Eh(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Eh(e,t,n,r,o){return new jh(_h().w(e,t,n,r),o||Promise)}function jh(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Nh?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Rh(jh.prototype),Rh(jh.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Rh(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function _h(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Rh(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Rh(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Rh(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Rh(f,"constructor",s),Rh(s,"constructor",u),u.displayName="GeneratorFunction",Rh(s,o,"GeneratorFunction"),Rh(f),Rh(f,o,"Generator"),Rh(f,r,(function(){return this})),Rh(f,"toString",(function(){return"[object Generator]"})),(_h=function(){return{w:i,m:p}})()}function Rh(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Rh=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Rh(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Rh(e,t,n,r)}function Nh(e,t){this.v=e,this.k=t}function Mh(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function qh(e,t,n){return Gh.apply(this,arguments)}function Gh(){var e;return e=Ah().mark((function e(t,n,r){var o;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=4;break}return e.abrupt("return",t);case 4:return o={clientId:n,tokenEndpoint:r},e.abrupt("return",t(o));case 6:case"end":return e.stop()}}),e)})),Gh=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Mh(i,r,o,a,c,"next",e)}function c(e){Mh(i,r,o,a,c,"throw",e)}a(void 0)}))},Gh.apply(this,arguments)}function Fh(e){return Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(e)}function Bh(e){return function(e){if(Array.isArray(e))return Hh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Hh(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hh(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Dh(){var e=Wh(),t=e.m(Dh),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Uh(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Dh=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Vh(e,t)},AsyncIterator:Qh,async:function(e,t,n,o,a){return(r(t)?zh:Kh)(i(e),t,n,o,a)},keys:Lh,values:Uh}})()}function Uh(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Fh(e)+" is not iterable")}function Lh(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Kh(e,t,n,r,o){var i=zh(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function zh(e,t,n,r,o){return new Qh(Wh().w(e,t,n,r),o||Promise)}function Qh(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Vh?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Yh(Qh.prototype),Yh(Qh.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Yh(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Wh(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Yh(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Yh(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Yh(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Yh(f,"constructor",s),Yh(s,"constructor",u),u.displayName="GeneratorFunction",Yh(s,o,"GeneratorFunction"),Yh(f),Yh(f,o,"Generator"),Yh(f,r,(function(){return this})),Yh(f,"toString",(function(){return"[object Generator]"})),(Wh=function(){return{w:i,m:p}})()}function Yh(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Yh=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Yh(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Yh(e,t,n,r)}function Vh(e,t){this.v=e,this.k=t}function Jh(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Zh(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Jh(i,r,o,a,c,"next",e)}function c(e){Jh(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Xh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$h(r.key),r)}}function $h(e){var t=function(e){if("object"!=Fh(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Fh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fh(t)?t:t+""}function ed(e,t,n){return t=nd(t),function(e,t){if(t&&("object"==Fh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,td()?Reflect.construct(t,n||[],nd(e).constructor):t.apply(e,n))}function td(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(td=function(){return!!e})()}function nd(e){return nd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nd(e)}function rd(e,t){return rd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rd(e,t)}var od=function(e){function t(e,n){var r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=ed(this,t,[e,n])).includeRedirectUri=!0,o.oidcDefaultScopes=null===(r=o.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rd(e,t)}(t,e),n=t,r=[{key:"getAuthCodeUrl",value:(u=Zh(Dh().mark((function e(t){var n,r;return Dh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.GetAuthCodeUrl,t.correlationId),e.next=3,ts(this.createAuthCodeUrlQueryString.bind(this),yo.AuthClientCreateQueryString,this.logger,this.performanceClient,t.correlationId)(t);case 3:return r=e.sent,e.abrupt("return",tr.appendQueryString(this.authority.authorizationEndpoint,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"acquireToken",value:(c=Zh(Dh().mark((function e(t,n){var r,o,i,a,c,u;return Dh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.AuthClientAcquireToken,t.correlationId),t.code){e.next=3;break}throw it(Oe);case 3:return i=Ot(),e.next=6,ts(this.executeTokenRequest.bind(this),yo.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,t.correlationId)(this.authority,t);case 6:return a=e.sent,c=null===(o=a.headers)||void 0===o?void 0:o[l],(u=new Oh(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(a.body),e.abrupt("return",ts(u.handleServerTokenResponse.bind(u),yo.HandleServerTokenResponse,this.logger,this.performanceClient,t.correlationId)(a.body,this.authority,i,t,n,void 0,void 0,void 0,c));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"handleFragmentResponse",value:function(e,t){if(new Oh(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw it(De);return e}},{key:"getLogoutUri",value:function(e){if(!e)throw Sn($t);var t=this.createLogoutUrlQueryString(e);return tr.appendQueryString(this.authority.endSessionEndpoint,t)}},{key:"executeTokenRequest",value:(a=Zh(Dh().mark((function e(t,n){var r,o,i,a,c,u,s,l,f;return Dh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.AuthClientExecuteTokenRequest,n.correlationId),i=this.createTokenQueryParameters(n),a=tr.appendQueryString(t.tokenEndpoint,i),e.next=5,ts(this.createTokenRequestBody.bind(this),yo.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,n.correlationId)(n);case 5:if(c=e.sent,u=void 0,n.clientInfo)try{s=Rn(n.clientInfo,this.cryptoUtils.base64Decode),u={credential:"".concat(s.uid).concat(I.CLIENT_INFO_SEPARATOR).concat(s.utid),type:il}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return l=this.createTokenRequestHeaders(u||n.ccsCredential),f={clientId:(null===(o=n.tokenBodyParameters)||void 0===o?void 0:o.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:n.scopes,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},e.abrupt("return",ts(this.executePostToTokenEndpoint.bind(this),yo.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,n.correlationId)(a,c,l,f,n.correlationId,yo.AuthorizationCodeClientExecutePostToTokenEndpoint));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"createTokenRequestBody",value:(i=Zh(Dh().mark((function e(t){var n,r,o,i,a,c,u,s,l,f,p;return Dh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.AuthClientCreateTokenRequestBody,t.correlationId),(o=new pp).addClientId((null===(r=t.tokenBodyParameters)||void 0===r?void 0:r[Zf])||this.config.authOptions.clientId),this.includeRedirectUri?o.addRedirectUri(t.redirectUri):ip.validateRedirectUri(t.redirectUri),o.addScopes(t.scopes,!0,this.oidcDefaultScopes),o.addAuthorizationCode(t.code),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&!po(this.config)&&o.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&o.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),!this.config.clientCredentials.clientAssertion){e.next=20;break}return i=this.config.clientCredentials.clientAssertion,e.t0=o,e.next=17,qh(i.assertion,this.config.authOptions.clientId,t.resourceRequestUri);case 17:e.t1=e.sent,e.t0.addClientAssertion.call(e.t0,e.t1),o.addClientAssertionType(i.assertionType);case 20:if(o.addGrantType("authorization_code"),o.addClientInfo(),t.authenticationScheme!==G.POP){e.next=35;break}if(a=new oh(this.cryptoUtils,this.performanceClient),t.popKid){e.next=31;break}return e.next=27,ts(a.generateCnf.bind(a),yo.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger);case 27:u=e.sent,c=u.reqCnfString,e.next=32;break;case 31:c=this.cryptoUtils.encodeKid(t.popKid);case 32:o.addPopToken(c),e.next=41;break;case 35:if(t.authenticationScheme!==G.SSH){e.next=41;break}if(!t.sshJwk){e.next=40;break}o.addSshJwk(t.sshJwk),e.next=41;break;case 40:throw Sn(an);case 41:if(s=t.correlationId||this.config.cryptoInterface.createNewGuid(),o.addCorrelationId(s),(!In.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),l=void 0,t.clientInfo)try{f=Rn(t.clientInfo,this.cryptoUtils.base64Decode),l={credential:"".concat(f.uid).concat(I.CLIENT_INFO_SEPARATOR).concat(f.utid),type:il}}catch(h){this.logger.verbose("Could not parse client info for CCS Header: "+h)}else l=t.ccsCredential;if(!this.config.systemOptions.preventCorsPreflight||!l){e.next=54;break}e.t2=l.type,e.next=e.t2===il?50:e.t2===al?52:54;break;case 50:try{p=Nn(l.credential),o.addCcsOid(p)}catch(h){this.logger.verbose("Could not parse home account ID for CCS Header: "+h)}return e.abrupt("break",54);case 52:return o.addCcsUpn(l.credential),e.abrupt("break",54);case 54:return t.tokenBodyParameters&&o.addExtraQueryParameters(t.tokenBodyParameters),!t.enableSpaAuthorizationCode||t.tokenBodyParameters&&t.tokenBodyParameters[tp]||o.addExtraQueryParameters((h={},(d=$h(d=tp))in h?Object.defineProperty(h,d,{value:"1",enumerable:!0,configurable:!0,writable:!0}):h[d]="1",h)),e.abrupt("return",o.createQueryString());case 57:case"end":return e.stop()}var h,d}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createAuthCodeUrlQueryString",value:(o=Zh(Dh().mark((function e(t){var n,r,o,i,a,c,u,s,l,f,p,h,d;return Dh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.AuthClientCreateQueryString,t.correlationId),(o=new pp).addClientId((null===(r=t.extraQueryParameters)||void 0===r?void 0:r[Zf])||this.config.authOptions.clientId),i=[].concat(Bh(t.scopes||[]),Bh(t.extraScopesToConsent||[])),o.addScopes(i,!0,this.oidcDefaultScopes),o.addRedirectUri(t.redirectUri),a=t.correlationId||this.config.cryptoInterface.createNewGuid(),o.addCorrelationId(a),o.addResponseMode(t.responseMode),o.addResponseTypeCode(),o.addLibraryInfo(this.config.libraryInfo),po(this.config)||o.addApplicationTelemetry(this.config.telemetry.application),o.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&o.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&o.addPrompt(t.prompt),t.domainHint&&o.addDomainHint(t.domainHint),t.prompt!==S.SELECT_ACCOUNT)if(t.sid&&t.prompt===S.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),o.addSid(t.sid);else if(t.account){if(c=this.extractAccountSid(t.account),(u=this.extractLoginHint(t.account))&&t.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),u=null),u){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),o.addLoginHint(u);try{s=Nn(t.account.homeAccountId),o.addCcsOid(s)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(c&&t.prompt===S.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),o.addSid(c);try{l=Nn(t.account.homeAccountId),o.addCcsOid(l)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),o.addLoginHint(t.loginHint),o.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),o.addLoginHint(t.account.username);try{f=Nn(t.account.homeAccountId),o.addCcsOid(f)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),o.addLoginHint(t.loginHint),o.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(t.nonce&&o.addNonce(t.nonce),t.state&&o.addState(t.state),(t.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.addExtraQueryParams(t,o),!t.nativeBroker){e.next=34;break}if(o.addNativeBroker(),t.authenticationScheme!==G.POP){e.next=34;break}if(p=new oh(this.cryptoUtils),t.popKid){e.next=32;break}return e.next=28,ts(p.generateCnf.bind(p),yo.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger);case 28:d=e.sent,h=d.reqCnfString,e.next=33;break;case 32:h=this.cryptoUtils.encodeKid(t.popKid);case 33:o.addPopToken(h);case 34:return e.abrupt("return",o.createQueryString());case 35:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"createLogoutUrlQueryString",value:function(e){var t=new pp;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}},{key:"addExtraQueryParams",value:function(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}},{key:"extractAccountSid",value:function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null}},{key:"extractLoginHint",value:function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null}}],r&&Xh(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a,c,u}(Hp);function id(e){return id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(e)}function ad(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cd(r.key),r)}}function cd(e){var t=function(e){if("object"!=id(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=id(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==id(t)?t:t+""}var ud=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cacheOutcome="0",this.cacheManager=n,this.apiId=t.apiId,this.correlationId=t.correlationId,this.wrapperSKU=t.wrapperSKU||i.EMPTY_STRING,this.wrapperVer=t.wrapperVer||i.EMPTY_STRING,this.telemetryCacheKey=q.CACHE_KEY+I.CACHE_KEY_SEPARATOR+t.clientId}return t=e,r=[{key:"maxErrorsToSend",value:function(e){var t,n=0,r=0,o=e.errors.length;for(t=0;t<o;t++){var a=e.failedRequests[2*t]||i.EMPTY_STRING,c=e.failedRequests[2*t+1]||i.EMPTY_STRING,u=e.errors[t]||i.EMPTY_STRING;if(!((r+=a.toString().length+c.toString().length+u.length+3)<q.MAX_LAST_HEADER_BYTES))break;n+=1}return n}},{key:"makeExtraSkuString",value:function(e){return function(e){var t=e.skus,n=e.libraryName,r=e.libraryVersion,o=e.extensionName,i=e.extensionVersion,a=new Map([[0,[n,r]],[2,[o,i]]]),c=[];if(null!=t&&t.length){if((c=t.split(",")).length<4)return t}else c=Array.from({length:4},(function(){return"|"}));return a.forEach((function(e,t){var n,r;2===e.length&&null!==(n=e[0])&&void 0!==n&&n.length&&null!==(r=e[1])&&void 0!==r&&r.length&&function(e){var t=e.skuArr,n=e.index,r=e.skuName,o=e.skuVersion;n>=t.length||(t[n]=[r,o].join("|"))}({skuArr:c,index:t,skuName:e[0],skuVersion:e[1]})})),c.join(",")}(e)}}],(n=[{key:"generateCurrentRequestHeaderValue",value:function(){var e="".concat(this.apiId).concat(q.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();null!=n&&n.length&&t.push("broker_error=".concat(n));var r=t.join(q.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,o,r].join(q.CATEGORY_SEPARATOR)}},{key:"generateLastRequestHeaderValue",value:function(){var t=this.getLastRequests(),n=e.maxErrorsToSend(t),r=t.failedRequests.slice(0,2*n).join(q.VALUE_SEPARATOR),o=t.errors.slice(0,n).join(q.VALUE_SEPARATOR),i=t.errors.length,a=[i,n<i?q.OVERFLOW_TRUE:q.OVERFLOW_FALSE].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,t.cacheHits,r,o,a].join(q.CATEGORY_SEPARATOR)}},{key:"cacheFailedRequest",value:function(e){var t=this.getLastRequests();t.errors.length>=q.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof re?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(q.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}},{key:"incrementCacheHits",value:function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}},{key:"getLastRequests",value:function(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}},{key:"clearTelemetryCache",value:function(){var t=this.getLastRequests(),n=e.maxErrorsToSend(t);if(n===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r={failedRequests:t.failedRequests.slice(2*n),errors:t.errors.slice(n),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}},{key:"getRegionDiscoveryFields",value:function(){var e=[];return e.push(this.regionUsed||i.EMPTY_STRING),e.push(this.regionSource||i.EMPTY_STRING),e.push(this.regionOutcome||i.EMPTY_STRING),e.join(",")}},{key:"updateRegionDiscoveryMetadata",value:function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}},{key:"setCacheOutcome",value:function(e){this.cacheOutcome=e}},{key:"setNativeBrokerErrorCode",value:function(e){var t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}},{key:"getNativeBrokerErrorCode",value:function(){return this.getLastRequests().nativeBrokerErrorCode}},{key:"clearNativeBrokerErrorCode",value:function(){var e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}}])&&ad(t.prototype,n),r&&ad(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function sd(e){return sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sd(e)}function ld(){var e=vd(),t=e.m(ld),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,fd(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ld=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new gd(e,t)},AsyncIterator:yd,async:function(e,t,n,o,a){return(r(t)?dd:hd)(i(e),t,n,o,a)},keys:pd,values:fd}})()}function fd(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(sd(e)+" is not iterable")}function pd(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function hd(e,t,n,r,o){var i=dd(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function dd(e,t,n,r,o){return new yd(vd().w(e,t,n,r),o||Promise)}function yd(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof gd?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(md(yd.prototype),md(yd.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),md(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function vd(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return md(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(md(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,md(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,md(f,"constructor",s),md(s,"constructor",u),u.displayName="GeneratorFunction",md(s,o,"GeneratorFunction"),md(f),md(f,o,"Generator"),md(f,r,(function(){return this})),md(f,"toString",(function(){return"[object Generator]"})),(vd=function(){return{w:i,m:p}})()}function md(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}md=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){md(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},md(e,t,n,r)}function gd(e,t){this.v=e,this.k=t}function bd(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function wd(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){bd(i,r,o,a,c,"next",e)}function c(e){bd(i,r,o,a,c,"throw",e)}a(void 0)}))}}function kd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Sd(r.key),r)}}function Sd(e){var t=function(e){if("object"!=sd(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=sd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==sd(t)?t:t+""}var Od=function(){return e=function e(t,n,r,o,i,a,c,u,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.browserStorage=n,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=a,this.nativeMessageHandler=u,this.correlationId=s||Bc(),this.logger=o.clone(To.MSAL_SKU,Aa,this.correlationId),this.performanceClient=c},t=[{key:"clearCacheOnLogout",value:(r=wd(ld().mark((function e(t){return ld().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=13;break}return Vn.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),e.prev=2,e.next=5,this.browserStorage.removeAccount(Vn.generateAccountCacheKey(t));case 5:this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),this.logger.error("Account provided in logout request was not found. Local cache unchanged.");case 11:e.next=24;break;case 13:return e.prev=13,this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),e.next=17,this.browserStorage.clear();case 17:return e.next=19,this.browserCrypto.clearKeystore();case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(13),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.");case 24:case"end":return e.stop()}}),e,this,[[2,8],[13,21]])}))),function(e){return r.apply(this,arguments)})},{key:"getRedirectUri",value:function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||tf();return tr.getAbsoluteUrl(t,tf())}},{key:"initializeServerTelemetryManager",value:function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new ud(n,this.browserStorage)}},{key:"getDiscoveredAuthority",value:(n=wd(ld().mark((function e(t){var n,r,o,i,a,c,u,s;return ld().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.account,r=t.requestExtraQueryParameters&&t.requestExtraQueryParameters.hasOwnProperty("instance_aware")?t.requestExtraQueryParameters.instance_aware:void 0,this.performanceClient.addQueueMeasurement(yo.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),o={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=t.requestAuthority||this.config.auth.authority,a=null!=r&&r.length?"true"===r:this.config.auth.instanceAware,c=n&&a?this.config.auth.authority.replace(tr.getDomainFromUrl(i),n.environment):i,u=Ns.generateAuthority(c,t.requestAzureCloudOptions||this.config.auth.azureCloudOptions),e.next=10,ts(Cp,yo.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(u,this.config.system.networkClient,this.browserStorage,o,this.logger,this.correlationId,this.performanceClient);case 10:if(s=e.sent,!n||s.isAlias(n.environment)){e.next=13;break}throw Sn(pn);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}],t&&kd(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function Cd(e){return Cd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cd(e)}function Td(){var e=jd(),t=e.m(Td),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Ad(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Td=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Rd(e,t)},AsyncIterator:Ed,async:function(e,t,n,o,a){return(r(t)?xd:Pd)(i(e),t,n,o,a)},keys:Id,values:Ad}})()}function Ad(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Cd(e)+" is not iterable")}function Id(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Pd(e,t,n,r,o){var i=xd(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function xd(e,t,n,r,o){return new Ed(jd().w(e,t,n,r),o||Promise)}function Ed(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Rd?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(_d(Ed.prototype),_d(Ed.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),_d(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function jd(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return _d(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(_d(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_d(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,_d(f,"constructor",s),_d(s,"constructor",u),u.displayName="GeneratorFunction",_d(s,o,"GeneratorFunction"),_d(f),_d(f,o,"Generator"),_d(f,r,(function(){return this})),_d(f,"toString",(function(){return"[object Generator]"})),(jd=function(){return{w:i,m:p}})()}function _d(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_d=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){_d(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},_d(e,t,n,r)}function Rd(e,t){this.v=e,this.k=t}function Nd(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Md(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Nd(i,r,o,a,c,"next",e)}function c(e){Nd(i,r,o,a,c,"throw",e)}a(void 0)}))}}var qd=32;function Gd(e,t,n){return Fd.apply(this,arguments)}function Fd(){return(Fd=Md(Td().mark((function e(t,n,r){var o,i;return Td().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addQueueMeasurement(yo.GeneratePkceCodes,r),o=es(Bd,yo.GenerateCodeVerifier,n,t,r)(t,n,r),e.next=4,ts(Hd,yo.GenerateCodeChallengeFromVerifier,n,t,r)(o,t,n,r);case 4:return i=e.sent,e.abrupt("return",{verifier:o,challenge:i});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bd(e,t,n){try{var r=new Uint8Array(qd);return es(Gc,yo.GetRandomValues,t,e,n)(r),dc(r)}catch(e){throw ia(ri)}}function Hd(e,t,n,r){return Dd.apply(this,arguments)}function Dd(){return(Dd=Md(Td().mark((function e(t,n,r,o){var i;return Td().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.addQueueMeasurement(yo.GenerateCodeChallengeFromVerifier,o),e.prev=1,e.next=4,ts(Mc,yo.Sha256Digest,r,n,o)(t,n,o);case 4:return i=e.sent,e.abrupt("return",dc(new Uint8Array(i)));case 8:throw e.prev=8,e.t0=e.catch(1),ia(ri);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function Ud(e){return Ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ud(e)}function Ld(){var e=Vd(),t=e.m(Ld),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Kd(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ld=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Zd(e,t)},AsyncIterator:Yd,async:function(e,t,n,o,a){return(r(t)?Wd:Qd)(i(e),t,n,o,a)},keys:zd,values:Kd}})()}function Kd(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Ud(e)+" is not iterable")}function zd(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Qd(e,t,n,r,o){var i=Wd(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Wd(e,t,n,r,o){return new Yd(Vd().w(e,t,n,r),o||Promise)}function Yd(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Zd?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Jd(Yd.prototype),Jd(Yd.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Jd(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Vd(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Jd(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Jd(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Jd(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Jd(f,"constructor",s),Jd(s,"constructor",u),u.displayName="GeneratorFunction",Jd(s,o,"GeneratorFunction"),Jd(f),Jd(f,o,"Generator"),Jd(f,r,(function(){return this})),Jd(f,"toString",(function(){return"[object Generator]"})),(Vd=function(){return{w:i,m:p}})()}function Jd(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Jd=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Jd(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Jd(e,t,n,r)}function Zd(e,t){this.v=e,this.k=t}function Xd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xd(Object(n),!0).forEach((function(t){ey(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ey(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ud(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ud(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ud(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ty(e){return function(e){if(Array.isArray(e))return ny(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ny(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ny(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ny(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ry(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function oy(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ry(i,r,o,a,c,"next",e)}function c(e){ry(i,r,o,a,c,"throw",e)}a(void 0)}))}}function iy(e,t,n,r){return ay.apply(this,arguments)}function ay(){return(ay=oy(Ld().mark((function e(t,n,r,o){var i,a,c;return Ld().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.addQueueMeasurement(yo.InitializeBaseRequest,t.correlationId),i=t.authority||n.auth.authority,a=ty(t&&t.scopes||[]),(c=$d($d({},t),{},{correlationId:t.correlationId,authority:i,scopes:a})).authenticationScheme){e.next=9;break}c.authenticationScheme=G.BEARER,o.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request'),e.next=15;break;case 9:if(c.authenticationScheme!==G.SSH){e.next=14;break}if(t.sshJwk){e.next=12;break}throw Sn(an);case 12:if(t.sshKid){e.next=14;break}throw Sn(cn);case 14:o.verbose('Authentication Scheme set to "'.concat(c.authenticationScheme,'" as configured in Auth request'));case 15:if(!n.cache.claimsBasedCachingEnabled||!t.claims||In.isEmptyObj(t.claims)){e.next=19;break}return e.next=18,Yc(t.claims);case 18:c.requestedClaimsHash=e.sent;case 19:return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cy(e,t,n,r,o){return uy.apply(this,arguments)}function uy(){return(uy=oy(Ld().mark((function e(t,n,r,o,i){var a;return Ld().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.addQueueMeasurement(yo.InitializeSilentRequest,t.correlationId),e.next=3,ts(iy,yo.InitializeBaseRequest,i,o,t.correlationId)(t,r,o,i);case 3:return a=e.sent,e.abrupt("return",$d($d($d({},t),a),{},{account:n,forceRefresh:t.forceRefresh||!1}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function sy(e){return sy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sy(e)}function ly(){var e=vy(),t=e.m(ly),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,fy(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ly=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new gy(e,t)},AsyncIterator:yy,async:function(e,t,n,o,a){return(r(t)?dy:hy)(i(e),t,n,o,a)},keys:py,values:fy}})()}function fy(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(sy(e)+" is not iterable")}function py(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function hy(e,t,n,r,o){var i=dy(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function dy(e,t,n,r,o){return new yy(vy().w(e,t,n,r),o||Promise)}function yy(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof gy?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(my(yy.prototype),my(yy.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),my(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function vy(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return my(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(my(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,my(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,my(f,"constructor",s),my(s,"constructor",u),u.displayName="GeneratorFunction",my(s,o,"GeneratorFunction"),my(f),my(f,o,"Generator"),my(f,r,(function(){return this})),my(f,"toString",(function(){return"[object Generator]"})),(vy=function(){return{w:i,m:p}})()}function my(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}my=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){my(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},my(e,t,n,r)}function gy(e,t){this.v=e,this.k=t}function by(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?by(Object(n),!0).forEach((function(t){ky(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):by(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ky(e,t,n){return(t=Ty(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sy(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Oy(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Sy(i,r,o,a,c,"next",e)}function c(e){Sy(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Cy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ty(r.key),r)}}function Ty(e){var t=function(e){if("object"!=sy(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=sy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==sy(t)?t:t+""}function Ay(e,t,n){return t=Py(t),function(e,t){if(t&&("object"==sy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Iy()?Reflect.construct(t,n||[],Py(e).constructor):t.apply(e,n))}function Iy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Iy=function(){return!!e})()}function Py(e){return Py=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Py(e)}function xy(e,t){return xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xy(e,t)}var Ey=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ay(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xy(e,t)}(t,e),n=t,r=[{key:"initializeAuthorizationCodeRequest",value:(u=Oy(ly().mark((function e(t){var n,r;return ly().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId),e.next=3,ts(Gd,yo.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId);case 3:return n=e.sent,r=wy(wy({},t),{},{redirectUri:t.redirectUri,code:i.EMPTY_STRING,codeVerifier:n.verifier}),t.codeChallenge=n.challenge,t.codeChallengeMethod=i.S256_CODE_CHALLENGE_METHOD,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"initializeLogoutRequest",value:function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=wy({correlationId:this.correlationId||Bc()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=tr.getAbsoluteUrl(e.postLogoutRedirectUri,tf())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=tr.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,tf())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=tr.getAbsoluteUrl(tf(),tf())),t}},{key:"getLogoutHintFromIdTokenClaims",value:function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}},{key:"createAuthCodeClient",value:(c=Oy(ly().mark((function e(t){var n;return ly().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.StandardInteractionClientCreateAuthCodeClient,this.correlationId),e.next=3,ts(this.getClientConfiguration.bind(this),yo.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(t);case 3:return n=e.sent,e.abrupt("return",new od(n,this.performanceClient));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getClientConfiguration",value:(a=Oy(ly().mark((function e(t){var n,r,o,a,c,u,s;return ly().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.serverTelemetryManager,r=t.requestAuthority,o=t.requestAzureCloudOptions,a=t.requestExtraQueryParameters,c=t.account,this.performanceClient.addQueueMeasurement(yo.StandardInteractionClientGetClientConfiguration,this.correlationId),e.next=4,ts(this.getDiscoveredAuthority.bind(this),yo.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:a,account:c});case 4:return u=e.sent,s=this.config.system.loggerOptions,e.abrupt("return",{authOptions:{clientId:this.config.auth.clientId,authority:u,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:To.MSAL_SKU,version:Aa,cpu:i.EMPTY_STRING,os:i.EMPTY_STRING},telemetry:this.config.telemetry});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"initializeAuthorizationRequest",value:(o=Oy(ly().mark((function e(t,n){var r,o,a,c,u,s,l;return ly().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),r=this.getRedirectUri(t.redirectUri),o={interactionType:n},a=ol.setRequestState(this.browserCrypto,t&&t.state||i.EMPTY_STRING,o),e.next=6,ts(iy,yo.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(wy(wy({},t),{},{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger);case 6:return c=e.sent,u=wy(wy({},c),{},{redirectUri:r,state:a,nonce:t.nonce||Bc(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),(s=t.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: ".concat(s.homeAccountId),this.correlationId),u.account=s),u.loginHint||s||(l=this.browserStorage.getLegacyLoginHint())&&(u.loginHint=l),e.abrupt("return",u);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})}],r&&Cy(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,a,c,u}(Od),jy="user_switch";function _y(e){return _y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_y(e)}function Ry(e,t,n){return t=My(t),function(e,t){if(t&&("object"==_y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ny()?Reflect.construct(t,n||[],My(e).constructor):t.apply(e,n))}function Ny(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ny=function(){return!!e})()}function My(e){return My=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},My(e)}function qy(e,t){return qy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qy(e,t)}function Gy(e){var t=function(e){if("object"!=_y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_y(t)?t:t+""}var Fy,By,Hy,Dy=(Fy={},Hy="User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again.",(By=Gy(By=jy))in Fy?Object.defineProperty(Fy,By,{value:Hy,enumerable:!0,configurable:!0,writable:!0}):Fy[By]=Hy,Fy),Uy=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=Ry(this,t,[e,n]),Object.setPrototypeOf(o,t.prototype),o.name="NativeAuthError",o.ext=r,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qy(e,t)}(t,e),function(e){return Object.defineProperty(e,"prototype",{writable:!1}),e}(t)}(re);function Ly(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode}function Ky(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return el(Bs);case"USER_INTERACTION_REQUIRED":return new Xs(e,t);case"USER_CANCEL":return ia(di);case"NO_NETWORK":return ia(ji)}return new Uy(e,Dy[e]||t,n)}function zy(e){return zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zy(e)}function Qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qy(Object(n),!0).forEach((function(t){Yy(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yy(e,t,n){return(t=cv(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vy(){var e=tv(),t=e.m(Vy),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Jy(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Vy=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new rv(e,t)},AsyncIterator:ev,async:function(e,t,n,o,a){return(r(t)?$y:Xy)(i(e),t,n,o,a)},keys:Zy,values:Jy}})()}function Jy(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(zy(e)+" is not iterable")}function Zy(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Xy(e,t,n,r,o){var i=$y(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function $y(e,t,n,r,o){return new ev(tv().w(e,t,n,r),o||Promise)}function ev(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof rv?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(nv(ev.prototype),nv(ev.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),nv(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function tv(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return nv(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(nv(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,nv(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,nv(f,"constructor",s),nv(s,"constructor",u),u.displayName="GeneratorFunction",nv(s,o,"GeneratorFunction"),nv(f),nv(f,o,"Generator"),nv(f,r,(function(){return this})),nv(f,"toString",(function(){return"[object Generator]"})),(tv=function(){return{w:i,m:p}})()}function nv(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}nv=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){nv(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},nv(e,t,n,r)}function rv(e,t){this.v=e,this.k=t}function ov(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function iv(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ov(i,r,o,a,c,"next",e)}function c(e){ov(i,r,o,a,c,"throw",e)}a(void 0)}))}}function av(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cv(r.key),r)}}function cv(e){var t=function(e){if("object"!=zy(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=zy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==zy(t)?t:t+""}function uv(e,t,n){return t=lv(t),function(e,t){if(t&&("object"==zy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,sv()?Reflect.construct(t,n||[],lv(e).constructor):t.apply(e,n))}function sv(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(sv=function(){return!!e})()}function lv(e){return lv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lv(e)}function fv(e,t){return fv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fv(e,t)}var pv=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uv(this,t,[e,n])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fv(e,t)}(t,e),function(e,t){return t&&av(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:(a=iv(Vy().mark((function e(t){var n,r,o,i,a,c;return Vy().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.RefreshTokenClientAcquireToken,t.correlationId),o=Ot(),e.next=4,ts(this.executeTokenRequest.bind(this),yo.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,t.correlationId)(t,this.authority);case 4:return i=e.sent,a=null===(r=i.headers)||void 0===r?void 0:r[l],(c=new Oh(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(i.body),e.abrupt("return",ts(c.handleServerTokenResponse.bind(c),yo.HandleServerTokenResponse,this.logger,this.performanceClient,t.correlationId)(i.body,this.authority,o,t,void 0,void 0,!0,t.forceCache,a));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"acquireTokenByRefreshToken",value:(i=iv(Vy().mark((function e(t){var n,r,o;return Vy().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw Sn(Xt);case 2:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),t.account){e.next=5;break}throw it(Ee);case 5:if(!this.cacheManager.isAppMetadataFOCI(t.account.environment)){e.next=22;break}return e.prev=7,e.next=10,ts(this.acquireTokenWithCachedRefreshToken.bind(this),yo.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!0);case 10:return e.abrupt("return",e.sent);case 13:if(e.prev=13,e.t0=e.catch(7),r=e.t0 instanceof Xs&&e.t0.errorCode===Fs,o=e.t0 instanceof _f&&"invalid_grant"===e.t0.errorCode&&"client_mismatch"===e.t0.subError,!r&&!o){e.next=21;break}return e.abrupt("return",ts(this.acquireTokenWithCachedRefreshToken.bind(this),yo.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!1));case 21:throw e.t0;case 22:return e.abrupt("return",ts(this.acquireTokenWithCachedRefreshToken.bind(this),yo.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!1));case 23:case"end":return e.stop()}}),e,this,[[7,13]])}))),function(e){return i.apply(this,arguments)})},{key:"acquireTokenWithCachedRefreshToken",value:(o=iv(Vy().mark((function e(t,n){var r,o,i,a;return Vy().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),o=es(this.cacheManager.getRefreshToken.bind(this.cacheManager),yo.CacheManagerGetRefreshToken,this.logger,this.performanceClient,t.correlationId)(t.account,n,void 0,this.performanceClient,t.correlationId)){e.next=4;break}throw el(Fs);case 4:if(!o.expiresOn||!Ct(o.expiresOn,t.refreshTokenExpirationOffsetSeconds||300)){e.next=6;break}throw el(Hs);case 6:return i=Wy(Wy({},t),{},{refreshToken:o.secret,authenticationScheme:t.authenticationScheme||G.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:il}}),e.prev=7,e.next=10,ts(this.acquireToken.bind(this),yo.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(i);case 10:return e.abrupt("return",e.sent);case 13:throw e.prev=13,e.t0=e.catch(7),e.t0 instanceof Xs&&e.t0.subError===Ds&&(this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache"),a=At(o),this.cacheManager.removeRefreshToken(a)),e.t0;case 17:case"end":return e.stop()}}),e,this,[[7,13]])}))),function(e,t){return o.apply(this,arguments)})},{key:"executeTokenRequest",value:(r=iv(Vy().mark((function e(t,n){var r,o,i,a,c,u,s;return Vy().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.RefreshTokenClientExecuteTokenRequest,t.correlationId),i=this.createTokenQueryParameters(t),a=tr.appendQueryString(n.tokenEndpoint,i),e.next=5,ts(this.createTokenRequestBody.bind(this),yo.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);case 5:return c=e.sent,u=this.createTokenRequestHeaders(t.ccsCredential),s={clientId:(null===(o=t.tokenBodyParameters)||void 0===o?void 0:o.clientId)||this.config.authOptions.clientId,authority:n.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},e.abrupt("return",ts(this.executePostToTokenEndpoint.bind(this),yo.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(a,c,u,s,t.correlationId,yo.RefreshTokenClientExecutePostToTokenEndpoint));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"createTokenRequestBody",value:(n=iv(Vy().mark((function e(t){var n,r,o,i,a,c,u,s,l,f;return Vy().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.RefreshTokenClientCreateTokenRequestBody,t.correlationId),i=t.correlationId,(a=new pp).addClientId((null===(r=t.tokenBodyParameters)||void 0===r?void 0:r[Zf])||this.config.authOptions.clientId),t.redirectUri&&a.addRedirectUri(t.redirectUri),a.addScopes(t.scopes,!0,null===(o=this.config.authOptions.authority.options.OIDCOptions)||void 0===o?void 0:o.defaultScopes),a.addGrantType("refresh_token"),a.addClientInfo(),a.addLibraryInfo(this.config.libraryInfo),a.addApplicationTelemetry(this.config.telemetry.application),a.addThrottling(),this.serverTelemetryManager&&!po(this.config)&&a.addServerTelemetry(this.serverTelemetryManager),a.addCorrelationId(i),a.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&a.addClientSecret(this.config.clientCredentials.clientSecret),!this.config.clientCredentials.clientAssertion){e.next=23;break}return c=this.config.clientCredentials.clientAssertion,e.t0=a,e.next=20,qh(c.assertion,this.config.authOptions.clientId,t.resourceRequestUri);case 20:e.t1=e.sent,e.t0.addClientAssertion.call(e.t0,e.t1),a.addClientAssertionType(c.assertionType);case 23:if(t.authenticationScheme!==G.POP){e.next=36;break}if(u=new oh(this.cryptoUtils,this.performanceClient),t.popKid){e.next=32;break}return e.next=28,ts(u.generateCnf.bind(u),yo.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger);case 28:l=e.sent,s=l.reqCnfString,e.next=33;break;case 32:s=this.cryptoUtils.encodeKid(t.popKid);case 33:a.addPopToken(s),e.next=42;break;case 36:if(t.authenticationScheme!==G.SSH){e.next=42;break}if(!t.sshJwk){e.next=41;break}a.addSshJwk(t.sshJwk),e.next=42;break;case 41:throw Sn(an);case 42:if((!In.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&a.addClaims(t.claims,this.config.authOptions.clientCapabilities),!this.config.systemOptions.preventCorsPreflight||!t.ccsCredential){e.next=51;break}e.t2=t.ccsCredential.type,e.next=e.t2===il?47:e.t2===al?49:51;break;case 47:try{f=Nn(t.ccsCredential.credential),a.addCcsOid(f)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}return e.abrupt("break",51);case 49:return a.addCcsUpn(t.ccsCredential.credential),e.abrupt("break",51);case 51:return t.tokenBodyParameters&&a.addExtraQueryParameters(t.tokenBodyParameters),e.abrupt("return",a.createQueryString());case 53:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]);var n,r,o,i,a}(Hp);function hv(e){return hv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hv(e)}function dv(){var e=wv(),t=e.m(dv),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,yv(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(dv=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Sv(e,t)},AsyncIterator:bv,async:function(e,t,n,o,a){return(r(t)?gv:mv)(i(e),t,n,o,a)},keys:vv,values:yv}})()}function yv(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(hv(e)+" is not iterable")}function vv(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function mv(e,t,n,r,o){var i=gv(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function gv(e,t,n,r,o){return new bv(wv().w(e,t,n,r),o||Promise)}function bv(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Sv?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(kv(bv.prototype),kv(bv.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),kv(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function wv(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return kv(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(kv(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,kv(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,kv(f,"constructor",s),kv(s,"constructor",u),u.displayName="GeneratorFunction",kv(s,o,"GeneratorFunction"),kv(f),kv(f,o,"Generator"),kv(f,r,(function(){return this})),kv(f,"toString",(function(){return"[object Generator]"})),(wv=function(){return{w:i,m:p}})()}function kv(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}kv=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){kv(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},kv(e,t,n,r)}function Sv(e,t){this.v=e,this.k=t}function Ov(e){return function(e){if(Array.isArray(e))return xv(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Pv(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cv(Object(n),!0).forEach((function(t){Av(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Av(e,t,n){return(t=Rv(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Iv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||Pv(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pv(e,t){if(e){if("string"==typeof e)return xv(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xv(e,t):void 0}}function xv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Ev(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function jv(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ev(i,r,o,a,c,"next",e)}function c(e){Ev(i,r,o,a,c,"throw",e)}a(void 0)}))}}function _v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Rv(r.key),r)}}function Rv(e){var t=function(e){if("object"!=hv(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=hv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==hv(t)?t:t+""}function Nv(e,t,n){return t=qv(t),function(e,t){if(t&&("object"==hv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Mv()?Reflect.construct(t,n||[],qv(e).constructor):t.apply(e,n))}function Mv(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mv=function(){return!!e})()}function qv(e){return qv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qv(e)}function Gv(e,t){return Gv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gv(e,t)}var Fv=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Nv(this,t,[e,n])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gv(e,t)}(t,e),function(e,t){return t&&_v(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:(o=jv(dv().mark((function e(t){var n,r,o,i,c;return dv().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.acquireCachedToken(Tv(Tv({},t),{},{scopes:null!==(n=t.scopes)&&void 0!==n&&n.length?t.scopes:Ov(a)}));case 3:return r=e.sent,o=Iv(r,2),i=o[0],"4"===o[1]&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new pv(this.config,this.performanceClient).acquireTokenByRefreshToken(t).catch((function(){}))),e.abrupt("return",i);case 11:if(e.prev=11,e.t0=e.catch(0),!(e.t0 instanceof ot&&e.t0.errorCode===Fe)){e.next=18;break}return c=new pv(this.config,this.performanceClient),e.abrupt("return",c.acquireTokenByRefreshToken(t));case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e){return o.apply(this,arguments)})},{key:"acquireCachedToken",value:(r=jv(dv().mark((function e(t){var n,r,o,i,a,c,u;return dv().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(yo.SilentFlowClientAcquireCachedToken,t.correlationId),r="0",!t.forceRefresh&&(this.config.cacheOptions.claimsBasedCachingEnabled||In.isEmptyObj(t.claims))){e.next=5;break}throw this.setCacheOutcome("1",t.correlationId),it(Fe);case 5:if(t.account){e.next=7;break}throw it(Ee);case 7:if(o=t.account.tenantId||Ms(t.authority),i=this.cacheManager.getTokenKeys(),a=this.cacheManager.getAccessToken(t.account,t,i,o,this.performanceClient,t.correlationId)){e.next=15;break}throw this.setCacheOutcome("2",t.correlationId),it(Fe);case 15:if(!Tt(a.cachedAt)&&!Ct(a.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)){e.next=20;break}throw this.setCacheOutcome("3",t.correlationId),it(Fe);case 20:a.refreshOn&&Ct(a.refreshOn,0)&&(r="4");case 21:return c=t.authority||this.authority.getPreferredCache(),u={account:this.cacheManager.readAccountFromCache(t.account),accessToken:a,idToken:this.cacheManager.getIdToken(t.account,i,o,this.performanceClient,t.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(c)},this.setCacheOutcome(r,t.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),e.next=27,ts(this.generateResultFromCacheRecord.bind(this),yo.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,t.correlationId)(u,t);case 27:return e.t0=e.sent,e.t1=r,e.abrupt("return",[e.t0,e.t1]);case 30:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setCacheOutcome",value:function(e,t){var n,r;null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(e),null===(r=this.performanceClient)||void 0===r||r.addFields({cacheOutcome:e},t),"0"!==e&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}},{key:"generateResultFromCacheRecord",value:(n=jv(dv().mark((function e(t,n){var r,o,i,a;return dv().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(yo.SilentFlowClientGenerateResultFromCacheRecord,n.correlationId),t.idToken&&(o=kt(t.idToken.secret,this.config.cryptoInterface.base64Decode)),!n.maxAge&&0!==n.maxAge){e.next=7;break}if(a=null===(i=o)||void 0===i?void 0:i.auth_time){e.next=6;break}throw it(ge);case 6:St(a,n.maxAge);case 7:return e.abrupt("return",Oh.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,n,o));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]);var n,r,o}(Hp);function Bv(e){return Bv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bv(e)}function Hv(){var e=Qv(),t=e.m(Hv),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Dv(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Hv=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Yv(e,t)},AsyncIterator:zv,async:function(e,t,n,o,a){return(r(t)?Kv:Lv)(i(e),t,n,o,a)},keys:Uv,values:Dv}})()}function Dv(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Bv(e)+" is not iterable")}function Uv(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Lv(e,t,n,r,o){var i=Kv(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Kv(e,t,n,r,o){return new zv(Qv().w(e,t,n,r),o||Promise)}function zv(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Yv?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Wv(zv.prototype),Wv(zv.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Wv(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Qv(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Wv(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Wv(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Wv(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Wv(f,"constructor",s),Wv(s,"constructor",u),u.displayName="GeneratorFunction",Wv(s,o,"GeneratorFunction"),Wv(f),Wv(f,o,"Generator"),Wv(f,r,(function(){return this})),Wv(f,"toString",(function(){return"[object Generator]"})),(Qv=function(){return{w:i,m:p}})()}function Wv(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Wv=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Wv(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Wv(e,t,n,r)}function Yv(e,t){this.v=e,this.k=t}function Vv(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Jv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Zv(r.key),r)}}function Zv(e){var t=function(e){if("object"!=Bv(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Bv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Bv(t)?t:t+""}function Xv(e,t,n){return t=em(t),function(e,t){if(t&&("object"==Bv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$v()?Reflect.construct(t,n||[],em(e).constructor):t.apply(e,n))}function $v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($v=function(){return!!e})()}function em(e){return em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},em(e)}function tm(e,t){return tm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tm(e,t)}var nm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xv(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tm(e,t)}(t,e),function(e,t){return t&&Jv(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:(n=Hv().mark((function e(t){var n,r,o,i,a;return Hv().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.SilentCacheClientAcquireToken,t.correlationId),n=this.initializeServerTelemetryManager(61),e.next=4,ts(this.getClientConfiguration.bind(this),yo.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,account:t.account});case 4:return r=e.sent,o=new Fv(r,this.performanceClient),this.logger.verbose("Silent auth client created"),e.prev=7,e.next=10,ts(o.acquireCachedToken.bind(o),yo.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,t.correlationId)(t);case 10:return i=e.sent,a=i[0],this.performanceClient.addFields({fromCache:!0},t.correlationId),e.abrupt("return",a);case 16:throw e.prev=16,e.t0=e.catch(7),e.t0 instanceof oa&&e.t0.errorCode===qi&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e.t0;case 20:case"end":return e.stop()}}),e,this,[[7,16]])})),r=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){Vv(i,r,o,a,c,"next",e)}function c(e){Vv(i,r,o,a,c,"throw",e)}a(void 0)}))},function(e){return r.apply(this,arguments)})},{key:"logout",value:function(e){this.logger.verbose("logoutRedirect called");var t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(null==t?void 0:t.account)}}]);var n,r}(Ey);function rm(e){return rm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rm(e)}var om=["prompt"],im=["scopes"];function am(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function cm(){var e=hm(),t=e.m(cm),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,um(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(cm=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new ym(e,t)},AsyncIterator:pm,async:function(e,t,n,o,a){return(r(t)?fm:lm)(i(e),t,n,o,a)},keys:sm,values:um}})()}function um(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(rm(e)+" is not iterable")}function sm(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function lm(e,t,n,r,o){var i=fm(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function fm(e,t,n,r,o){return new pm(hm().w(e,t,n,r),o||Promise)}function pm(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof ym?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(dm(pm.prototype),dm(pm.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),dm(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function hm(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return dm(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(dm(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,dm(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,dm(f,"constructor",s),dm(s,"constructor",u),u.displayName="GeneratorFunction",dm(s,o,"GeneratorFunction"),dm(f),dm(f,o,"Generator"),dm(f,r,(function(){return this})),dm(f,"toString",(function(){return"[object Generator]"})),(hm=function(){return{w:i,m:p}})()}function dm(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}dm=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){dm(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},dm(e,t,n,r)}function ym(e,t){this.v=e,this.k=t}function vm(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function mm(){return mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mm.apply(null,arguments)}function gm(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function bm(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){gm(i,r,o,a,c,"next",e)}function c(e){gm(i,r,o,a,c,"throw",e)}a(void 0)}))}}function wm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function km(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wm(Object(n),!0).forEach((function(t){Sm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sm(e,t,n){return(t=Cm(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Om(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Cm(r.key),r)}}function Cm(e){var t=function(e){if("object"!=rm(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=rm(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rm(t)?t:t+""}function Tm(e,t,n){return t=Im(t),function(e,t){if(t&&("object"==rm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Am()?Reflect.construct(t,n||[],Im(e).constructor):t.apply(e,n))}function Am(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Am=function(){return!!e})()}function Im(e){return Im=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Im(e)}function Pm(e,t){return Pm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pm(e,t)}var xm="brk_redirect_uri",Em=function(e){function t(e,n,r,o,i,a,c,u,s,l,f,p){var h,d;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(d=Tm(this,t,[e,n,r,o,i,a,u,s,p])).apiId=c,d.accountId=l,d.nativeMessageHandler=s,d.nativeStorageManager=f,d.silentCacheClient=new nm(e,d.nativeStorageManager,r,o,i,a,u,s,p),d.serverTelemetryManager=d.initializeServerTelemetryManager(d.apiId);var y=d.nativeMessageHandler.getExtensionId()===Io?"chrome":null!==(h=d.nativeMessageHandler.getExtensionId())&&void 0!==h&&h.length?"unknown":void 0;return d.skus=ud.makeExtraSkuString({libraryName:To.MSAL_SKU,libraryVersion:Aa,extensionName:y,extensionVersion:d.nativeMessageHandler.getExtensionVersion()}),d}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pm(e,t)}(t,e),function(e,t){return t&&Om(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"addRequestSKUs",value:function(e){e.extraParameters=km(km({},e.extraParameters),{},Sm({},"x-client-xtra-sku",this.skus))}},{key:"acquireToken",value:(f=bm(cm().mark((function e(t){var n,r,o,i,a,c,u,s,l=this;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.NativeInteractionClientAcquireToken,t.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called."),n=this.performanceClient.startMeasurement(yo.NativeInteractionClientAcquireToken,t.correlationId),r=Ot(),e.prev=4,e.next=7,this.initializeNativeRequest(t);case 7:return o=e.sent,e.prev=8,e.next=11,this.acquireTokensFromCache(this.accountId,o);case 11:return i=e.sent,n.end({success:!0,isNativeBroker:!1,fromCache:!0}),e.abrupt("return",i);case 16:e.prev=16,e.t0=e.catch(8),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call");case 19:return a=mm({},(vm(o),o)),c={method:xo,request:a},e.next=23,this.nativeMessageHandler.sendMessage(c);case 23:return u=e.sent,s=this.validateNativeResponse(u),e.next=27,this.handleNativeResponse(s,o,r).then((function(e){return n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),l.serverTelemetryManager.clearNativeBrokerErrorCode(),e})).catch((function(e){throw n.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}));case 27:return e.abrupt("return",e.sent);case 30:throw e.prev=30,e.t1=e.catch(4),e.t1 instanceof Uy&&this.serverTelemetryManager.setNativeBrokerErrorCode(e.t1.errorCode),e.t1;case 34:case"end":return e.stop()}}),e,this,[[4,30],[8,16]])}))),function(e){return f.apply(this,arguments)})},{key:"createSilentCacheRequest",value:function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:_n.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}},{key:"acquireTokensFromCache",value:(l=bm(cm().mark((function e(t,n){var r,o,i,a;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),it(Re);case 3:if(r=this.browserStorage.getBaseAccountInfo({nativeAccountId:t})){e.next=6;break}throw it(Re);case 6:return e.prev=6,o=this.createSilentCacheRequest(n,r),e.next=10,this.silentCacheClient.acquireToken(o);case 10:return i=e.sent,a=km(km({},r),{},{idTokenClaims:null==i?void 0:i.idTokenClaims,idToken:null==i?void 0:i.idToken}),e.abrupt("return",km(km({},i),{},{account:a}));case 15:throw e.prev=15,e.t0=e.catch(6),e.t0;case 18:case"end":return e.stop()}}),e,this,[[6,15]])}))),function(e,t){return l.apply(this,arguments)})},{key:"acquireTokenRedirect",value:(s=bm(cm().mark((function e(t,n){var r,o,i,a,c,u;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),delete(r=mm({},(vm(t),t))).onRedirectNavigate,e.next=5,this.initializeNativeRequest(r);case 5:return o=e.sent,i={method:xo,request:o},e.prev=7,e.next=10,this.nativeMessageHandler.sendMessage(i);case 10:a=e.sent,this.validateNativeResponse(a),e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(7),!(e.t0 instanceof Uy)){e.next=20;break}if(this.serverTelemetryManager.setNativeBrokerErrorCode(e.t0.errorCode),!Ly(e.t0)){e.next=20;break}throw e.t0;case 20:return this.browserStorage.setTemporaryCache(Ho,JSON.stringify(o),!0),c={apiId:zo,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),n.end({success:!0}),e.next=26,this.navigationClient.navigateExternal(u,c);case 26:case"end":return e.stop()}}),e,this,[[7,14]])}))),function(e,t){return s.apply(this,arguments)})},{key:"handleRedirectPromise",value:(u=bm(cm().mark((function e(t,n){var r,o,i,a,c,u,s,l;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),this.browserStorage.isInteractionInProgress(!0)){e.next=4;break}return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),e.abrupt("return",null);case 4:if(r=this.browserStorage.getCachedNativeRequest()){e.next=9;break}return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),t&&n&&(null==t||t.addFields({errorCode:"no_cached_request"},n)),e.abrupt("return",null);case 9:return o=r.prompt,i=am(r,om),o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ho)),a={method:xo,request:i},c=Ot(),e.prev=14,this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),e.next=18,this.nativeMessageHandler.sendMessage(a);case 18:return u=e.sent,this.validateNativeResponse(u),s=this.handleNativeResponse(u,i,c),this.browserStorage.setInteractionInProgress(!1),e.next=24,s;case 24:return l=e.sent,this.serverTelemetryManager.clearNativeBrokerErrorCode(),e.abrupt("return",l);case 29:throw e.prev=29,e.t0=e.catch(14),this.browserStorage.setInteractionInProgress(!1),e.t0;case 33:case"end":return e.stop()}}),e,this,[[14,29]])}))),function(e,t){return u.apply(this,arguments)})},{key:"logout",value:function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}},{key:"handleNativeResponse",value:(c=bm(cm().mark((function e(t,n,r){var o,i,a,c,u,s,l;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),i=kt(t.id_token,mc),a=this.createHomeAccountIdentifier(t,i),c=null===(o=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:n.accountId}))||void 0===o?void 0:o.homeAccountId,a===c||t.account.id===n.accountId){e.next=6;break}throw Ky(jy);case 6:return e.next=8,this.getDiscoveredAuthority({requestAuthority:n.authority});case 8:return u=e.sent,s=Ch(this.browserStorage,u,a,mc,i,t.client_info,void 0,i.tid,void 0,t.account.id,this.logger),e.next=12,this.generateAuthenticationResult(t,n,i,s,u.canonicalAuthority,r);case 12:return l=e.sent,this.cacheAccount(s),this.cacheNativeTokens(t,n,a,i,t.access_token,l.tenantId,r),e.abrupt("return",l);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"createHomeAccountIdentifier",value:function(e,t){return Vn.generateHomeAccountId(e.client_info||i.EMPTY_STRING,0,this.logger,this.browserCrypto,t)}},{key:"generateScopes",value:function(e,t){return e.scope?_n.fromString(e.scope):_n.fromString(t.scope)}},{key:"generatePopAccessToken",value:(o=bm(cm().mark((function e(t,n){var r,o;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.tokenType!==G.POP||!n.signPopToken){e.next=11;break}if(!t.shr){e.next=4;break}return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.abrupt("return",t.shr);case 4:if(r=new oh(this.browserCrypto),o={resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,shrNonce:n.shrNonce},n.keyId){e.next=8;break}throw it(Ke);case 8:return e.abrupt("return",r.signPopToken(t.access_token,n.keyId,o));case 11:return e.abrupt("return",t.access_token);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"generateAuthenticationResult",value:(r=bm(cm().mark((function e(t,n,r,o,a,c){var u,s,l,f,p,h,d,y,v;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this.addTelemetryFromNativeResponse(t),s=t.scope?_n.fromString(t.scope):_n.fromString(n.scope),l=t.account.properties||{},f=l.UID||r.oid||r.sub||i.EMPTY_STRING,p=l.TenantId||r.tid||i.EMPTY_STRING,(h=Kn(o.getAccountInfo(),void 0,r,t.id_token)).nativeAccountId!==t.account.id&&(h.nativeAccountId=t.account.id),e.next=9,this.generatePopAccessToken(t,n);case 9:return d=e.sent,y=n.tokenType===G.POP?G.POP:G.BEARER,v={authority:a,uniqueId:f,tenantId:p,scopes:s.asArray(),account:h,idToken:t.id_token,idTokenClaims:r,accessToken:d,fromCache:!!u&&this.isResponseFromCache(u),expiresOn:new Date(1e3*Number(c+t.expires_in)),tokenType:y,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0},e.abrupt("return",v);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n,o,i,a){return r.apply(this,arguments)})},{key:"cacheAccount",value:function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. ".concat(e))}))}},{key:"cacheNativeTokens",value:function(e,t,n,r,o,a,c){var u=It(n,t.authority,e.id_token||"",t.clientId,r.tid||""),s=c+(t.tokenType===G.POP?i.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),f={idToken:u,accessToken:Pt(n,t.authority,o,t.clientId,r.tid||a,l.printScopes(),s,0,mc,void 0,t.tokenType,void 0,t.keyId)};this.nativeStorageManager.saveCacheRecord(f,t.storeInCache)}},{key:"addTelemetryFromNativeResponse",value:function(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}},{key:"validateNativeResponse",value:function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw oe(Q,"Response missing expected properties.")}},{key:"getMATSFromResponse",value:function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}},{key:"isResponseFromCache",value:function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}},{key:"initializeNativeRequest",value:(n=bm(cm().mark((function e(t){var n,r,o,i,c,u,s,l,f,p,h,d=this;return cm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),n=t.authority||this.config.auth.authority,!t.account){e.next=5;break}return e.next=5,this.getDiscoveredAuthority({requestAuthority:n,requestAzureCloudOptions:t.azureCloudOptions,account:t.account});case 5:if((r=new tr(n)).validateAsUri(),o=t.scopes,i=am(t,im),(c=new _n(o||[])).appendScopes(a),u=function(){switch(d.apiId){case 863:case 61:return d.logger.trace("initializeNativeRequest: silent request sets prompt to none"),S.NONE}if(t.prompt)switch(t.prompt){case S.NONE:case S.CONSENT:case S.LOGIN:return d.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw d.logger.trace("initializeNativeRequest: prompt = ".concat(t.prompt," is not compatible with native flow")),ia(Qi)}else d.logger.trace("initializeNativeRequest: prompt was not provided")},!(s=km(km({},i),{},{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:c.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:u(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:km(km({},t.extraQueryParameters),t.tokenQueryParameters),extendedExpiryToken:!1,keyId:t.popKid})).signPopToken||!t.popKid){e.next=14;break}throw ia(Yi);case 14:if(this.handleExtraBrokerParams(s),s.extraParameters=s.extraParameters||{},s.extraParameters.telemetry="MATS",t.authenticationScheme!==G.POP){e.next=32;break}if(l={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},f=new oh(this.browserCrypto),s.keyId){e.next=29;break}return e.next=23,ts(f.generateCnf.bind(f),yo.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(l,this.logger);case 23:h=e.sent,p=h.reqCnfString,s.keyId=h.kid,s.signPopToken=!0,e.next=31;break;case 29:p=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:s.keyId})),s.signPopToken=!1;case 31:s.reqCnf=p;case 32:return this.addRequestSKUs(s),e.abrupt("return",s);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"handleExtraBrokerParams",value:function(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty("brk_client_id")&&e.extraParameters.hasOwnProperty(xm)&&e.extraParameters.hasOwnProperty(Zf)){var t=e.extraParameters[Zf],n=e.redirectUri,r=e.extraParameters[xm];e.extraParameters={child_client_id:t,child_redirect_uri:n},e.redirectUri=r}}}]);var n,r,o,c,u,s,l,f}(Od);function jm(e){return jm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jm(e)}function _m(){var e=Fm(),t=e.m(_m),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Rm(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(_m=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Hm(e,t)},AsyncIterator:Gm,async:function(e,t,n,o,a){return(r(t)?qm:Mm)(i(e),t,n,o,a)},keys:Nm,values:Rm}})()}function Rm(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(jm(e)+" is not iterable")}function Nm(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Mm(e,t,n,r,o){var i=qm(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function qm(e,t,n,r,o){return new Gm(Fm().w(e,t,n,r),o||Promise)}function Gm(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Hm?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Bm(Gm.prototype),Bm(Gm.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Bm(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Fm(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Bm(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Bm(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Bm(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Bm(f,"constructor",s),Bm(s,"constructor",u),u.displayName="GeneratorFunction",Bm(s,o,"GeneratorFunction"),Bm(f),Bm(f,o,"Generator"),Bm(f,r,(function(){return this})),Bm(f,"toString",(function(){return"[object Generator]"})),(Fm=function(){return{w:i,m:p}})()}function Bm(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Bm=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Bm(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Bm(e,t,n,r)}function Hm(e,t){this.v=e,this.k=t}function Dm(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Um(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Dm(i,r,o,a,c,"next",e)}function c(e){Dm(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Lm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Km(r.key),r)}}function Km(e){var t=function(e){if("object"!=jm(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=jm(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==jm(t)?t:t+""}var zm=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=t,this.handshakeTimeoutMs=n,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(yo.NativeMessageHandlerHandshake)}return function(e,t,n){return t&&Lm(e.prototype,t),n&&Lm(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(e,[{key:"sendMessage",value:(r=Um(_m().mark((function e(t){var n,r=this;return _m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.trace("NativeMessageHandler - sendMessage called."),n={channel:Ao,extensionId:this.extensionId,responseId:Bc(),body:t},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: ".concat(JSON.stringify(n))),this.messageChannel.port1.postMessage(n),e.abrupt("return",new Promise((function(e,t){r.resolvers.set(n.responseId,{resolve:e,reject:t})})));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"sendHandshakeRequest",value:(n=Um(_m().mark((function e(){var t,n=this;return _m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),t={channel:Ao,extensionId:this.extensionId,responseId:Bc(),body:{method:Po}},this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){n.onChannelMessage(e)},window.postMessage(t,window.origin,[this.messageChannel.port2]),e.abrupt("return",new Promise((function(e,r){n.handshakeResolvers.set(t.responseId,{resolve:e,reject:r}),n.timeoutId=window.setTimeout((function(){window.removeEventListener("message",n.windowListener,!1),n.messageChannel.port1.close(),n.messageChannel.port2.close(),n.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(ia(Ui)),n.handshakeResolvers.delete(t.responseId)}),n.handshakeTimeoutMs)})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onWindowMessage",value:function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===Ao&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Po){var n=this.handshakeResolvers.get(t.responseId);if(!n)return void this.logger.trace("NativeMessageHandler.onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),n.reject(ia(Li))}}}},{key:"onChannelMessage",value:function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{var o=t.body.method;if("Response"===o){if(!n)return;var i=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: ".concat(JSON.stringify(i))),"Success"!==i.status)n.reject(Ky(i.code,i.description,i.ext));else{if(!i.result)throw oe(Q,"Event does not contain result.");i.result.code&&i.result.description?n.reject(Ky(i.result.code,i.result.description,i.result.ext)):n.resolve(i.result)}this.resolvers.delete(t.responseId)}else if("HandshakeResponse"===o){if(!r)return void this.logger.trace("NativeMessageHandler.onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(t)),this.logger.errorPii("Unable to parse ".concat(e)),n?n.reject(t):r&&r.reject(t)}}},{key:"getExtensionId",value:function(){return this.extensionId}},{key:"getExtensionVersion",value:function(){return this.extensionVersion}}],[{key:"createProvider",value:(t=Um(_m().mark((function t(n,r,o){var i,a;return _m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.trace("NativeMessageHandler - createProvider called."),t.prev=1,i=new e(n,r,o,Io),t.next=5,i.sendHandshakeRequest();case 5:return t.abrupt("return",i);case 8:return t.prev=8,t.t0=t.catch(1),a=new e(n,r,o),t.next=13,a.sendHandshakeRequest();case 13:return t.abrupt("return",a);case 14:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(e,n,r){return t.apply(this,arguments)})},{key:"isNativeAvailable",value:function(e,t,n,r){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(r)switch(r){case G.BEARER:case G.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}]);var t,n,r}();function Qm(e){return Qm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qm(e)}function Wm(){var e=$m(),t=e.m(Wm),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Ym(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Wm=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new tg(e,t)},AsyncIterator:Xm,async:function(e,t,n,o,a){return(r(t)?Zm:Jm)(i(e),t,n,o,a)},keys:Vm,values:Ym}})()}function Ym(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Qm(e)+" is not iterable")}function Vm(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Jm(e,t,n,r,o){var i=Zm(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Zm(e,t,n,r,o){return new Xm($m().w(e,t,n,r),o||Promise)}function Xm(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof tg?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(eg(Xm.prototype),eg(Xm.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),eg(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function $m(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return eg(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(eg(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,eg(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,eg(f,"constructor",s),eg(s,"constructor",u),u.displayName="GeneratorFunction",eg(s,o,"GeneratorFunction"),eg(f),eg(f,o,"Generator"),eg(f,r,(function(){return this})),eg(f,"toString",(function(){return"[object Generator]"})),($m=function(){return{w:i,m:p}})()}function eg(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}eg=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){eg(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},eg(e,t,n,r)}function tg(e,t){this.v=e,this.k=t}function ng(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function rg(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ng(i,r,o,a,c,"next",e)}function c(e){ng(i,r,o,a,c,"throw",e)}a(void 0)}))}}function og(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ig(r.key),r)}}function ig(e){var t=function(e){if("object"!=Qm(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Qm(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Qm(t)?t:t+""}var ag=function(){return function(e,t){return t&&og(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.authModule=t,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}),[{key:"handleCodeResponse",value:(t=rg(Wm().mark((function e(t,n){var r;return Wm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.performanceClient.addQueueMeasurement(yo.HandleCodeResponse,n.correlationId),e.prev=1,r=this.authModule.handleFragmentResponse(t,n.state),e.next=12;break;case 5:if(e.prev=5,e.t0=e.catch(1),!(e.t0 instanceof _f&&e.t0.subError===di)){e.next=11;break}throw ia(di);case 11:throw e.t0;case 12:return e.abrupt("return",ts(this.handleCodeResponseFromServer.bind(this),yo.HandleCodeResponseFromServer,this.logger,this.performanceClient,n.correlationId)(r,n));case 13:case"end":return e.stop()}}),e,this,[[1,5]])}))),function(e,n){return t.apply(this,arguments)})},{key:"handleCodeResponseFromServer",value:(e=rg(Wm().mark((function e(t,n){var r,o,i,a=arguments;return Wm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(a.length>2&&void 0!==a[2])||a[2],this.performanceClient.addQueueMeasurement(yo.HandleCodeResponseFromServer,n.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=t.code,!t.cloud_instance_host_name){e.next=7;break}return e.next=7,ts(this.authModule.updateAuthority.bind(this.authModule),yo.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,n.correlationId)(t.cloud_instance_host_name,n.correlationId);case 7:return r&&(t.nonce=n.nonce||void 0),t.state=n.state,t.client_info?this.authCodeRequest.clientInfo=t.client_info:(o=this.createCcsCredentials(n))&&(this.authCodeRequest.ccsCredential=o),e.next=12,ts(this.authModule.acquireToken.bind(this.authModule),yo.AuthClientAcquireToken,this.logger,this.performanceClient,n.correlationId)(this.authCodeRequest,t);case 12:return i=e.sent,e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"createCcsCredentials",value:function(e){return e.account?{credential:e.account.homeAccountId,type:il}:e.loginHint?{credential:e.loginHint,type:al}:null}}]);var e,t}();function cg(e,t,n){var r=Zn(e);if(!r)throw Jn(e)?(n.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),n.errorPii("The ".concat(t," detected is: ").concat(e)),ia(ui)):(n.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),ia(ai));return r}function ug(e){return ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ug(e)}function sg(){var e=yg(),t=e.m(sg),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,lg(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(sg=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new mg(e,t)},AsyncIterator:dg,async:function(e,t,n,o,a){return(r(t)?hg:pg)(i(e),t,n,o,a)},keys:fg,values:lg}})()}function lg(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ug(e)+" is not iterable")}function fg(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function pg(e,t,n,r,o){var i=hg(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function hg(e,t,n,r,o){return new dg(yg().w(e,t,n,r),o||Promise)}function dg(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof mg?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(vg(dg.prototype),vg(dg.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),vg(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function yg(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return vg(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(vg(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,vg(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,vg(f,"constructor",s),vg(s,"constructor",u),u.displayName="GeneratorFunction",vg(s,o,"GeneratorFunction"),vg(f),vg(f,o,"Generator"),vg(f,r,(function(){return this})),vg(f,"toString",(function(){return"[object Generator]"})),(yg=function(){return{w:i,m:p}})()}function vg(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}vg=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){vg(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},vg(e,t,n,r)}function mg(e,t){this.v=e,this.k=t}function gg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gg(Object(n),!0).forEach((function(t){wg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wg(e,t,n){return(t=Cg(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kg(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Sg(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){kg(i,r,o,a,c,"next",e)}function c(e){kg(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Og(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Cg(r.key),r)}}function Cg(e){var t=function(e){if("object"!=ug(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ug(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ug(t)?t:t+""}function Tg(e,t,n){return t=Ig(t),function(e,t){if(t&&("object"==ug(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ag()?Reflect.construct(t,n||[],Ig(e).constructor):t.apply(e,n))}function Ag(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ag=function(){return!!e})()}function Ig(e){return Ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ig(e)}function Pg(e,t){return Pg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pg(e,t)}var xg=function(e){function t(e,n,r,o,i,a,c,u,s,l){var f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(f=Tg(this,t,[e,n,r,o,i,a,c,s,l])).unloadWindow=f.unloadWindow.bind(f),f.nativeStorage=u,f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pg(e,t)}(t,e),function(e,t){return t&&Og(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:function(e){try{var t,n={popupName:this.generatePopupName(e.scopes||a,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:null!==(t=e.popupWindowParent)&&void 0!==t?t:window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(e,n))}catch(e){return Promise.reject(e)}}},{key:"logout",value:function(e){try{var t;this.logger.verbose("logoutPopup called");var n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(null==e?void 0:e.popupWindowAttributes)||{},popupWindowParent:null!==(t=null==e?void 0:e.popupWindowParent)&&void 0!==t?t:window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,o,i))}catch(e){return Promise.reject(e)}}},{key:"acquireTokenPopupAsync",value:(r=Sg(sg().mark((function e(t,n){var r,o,i,a,c,u,s,l,f,p,h,d,y,v,m,g;return sg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),r=this.initializeServerTelemetryManager(Qo),e.next=4,ts(this.initializeAuthorizationRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,So.Popup);case 4:return cf((o=e.sent).authority),e.prev=6,e.next=9,ts(this.initializeAuthorizationCodeRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(o);case 9:return i=e.sent,e.next=12,ts(this.createAuthCodeClient.bind(this),yo.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account});case 12:return a=e.sent,(c=zm.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme))&&(u=this.performanceClient.startMeasurement(yo.FetchAccountIdWithNativeBroker,t.correlationId)),e.next=17,a.getAuthCodeUrl(bg(bg({},o),{},{nativeBroker:c}));case 17:return s=e.sent,l=new ag(a,this.browserStorage,i,this.logger,this.performanceClient),f=this.initiateAuthRequest(s,n),this.eventHandler.emitEvent(mf,So.Popup,{popupWindow:f},null),e.next=23,this.monitorPopupForHash(f,n.popupWindowParent);case 23:if(p=e.sent,h=es(cg,yo.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(p,this.config.auth.OIDCOptions.serverResponseType,this.logger),qf.removeThrottle(this.browserStorage,this.config.auth.clientId,i),!h.accountId){e.next=36;break}if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.end({success:!0,isNativeBroker:!0}),this.nativeMessageHandler){e.next=31;break}throw ia(Ki);case 31:return d=new Em(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qo,this.performanceClient,this.nativeMessageHandler,h.accountId,this.nativeStorage,o.correlationId),y=ol.parseRequestState(this.browserCrypto,o.state),v=y.userRequestState,e.next=35,d.acquireToken(bg(bg({},o),{},{state:v,prompt:void 0}));case 35:return e.abrupt("return",e.sent);case 36:return e.next=38,l.handleCodeResponse(h,o);case 38:return m=e.sent,e.abrupt("return",m);case 42:throw e.prev=42,e.t0=e.catch(6),null===(g=n.popup)||void 0===g||g.close(),e.t0 instanceof re&&(e.t0.setCorrelationId(this.correlationId),r.cacheFailedRequest(e.t0)),e.t0;case 47:case"end":return e.stop()}}),e,this,[[6,42]])}))),function(e,t){return r.apply(this,arguments)})},{key:"logoutPopupAsync",value:(n=Sg(sg().mark((function e(t,n,r,o){var i,a,c,u,s,l,f,p,h,d,y,v;return sg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(gf,So.Popup,t),i=this.initializeServerTelemetryManager(962),e.prev=3,e.next=6,this.clearCacheOnLogout(t.account);case 6:return e.next=8,ts(this.createAuthCodeClient.bind(this),yo.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:r,account:t.account||void 0});case 8:a=e.sent,e.prev=9,a.authority.endSessionEndpoint,e.next=25;break;case 13:if(e.prev=13,e.t0=e.catch(9),null===(c=t.account)||void 0===c||!c.homeAccountId||!t.postLogoutRedirectUri||a.authority.protocolMode!==K){e.next=25;break}if(this.browserStorage.removeAccount(null===(u=t.account)||void 0===u?void 0:u.homeAccountId),this.eventHandler.emitEvent(bf,So.Popup,t),!o){e.next=23;break}return l={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},f=tr.getAbsoluteUrl(o,tf()),e.next=23,this.navigationClient.navigateInternal(f,l);case 23:return null===(s=n.popup)||void 0===s||s.close(),e.abrupt("return");case 25:return p=a.getLogoutUri(t),this.eventHandler.emitEvent(bf,So.Popup,t),h=this.openPopup(p,n),this.eventHandler.emitEvent(mf,So.Popup,{popupWindow:h},null),e.next=31,this.monitorPopupForHash(h,n.popupWindowParent).catch((function(){}));case 31:if(!o){e.next=40;break}return d={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},y=tr.getAbsoluteUrl(o,tf()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: ".concat(y)),e.next=38,this.navigationClient.navigateInternal(y,d);case 38:e.next=41;break;case 40:this.logger.verbose("No main window navigation requested");case 41:e.next=51;break;case 43:throw e.prev=43,e.t1=e.catch(3),null===(v=n.popup)||void 0===v||v.close(),e.t1 instanceof re&&(e.t1.setCorrelationId(this.correlationId),i.cacheFailedRequest(e.t1)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(wf,So.Popup,null,e.t1),this.eventHandler.emitEvent(kf,So.Popup),e.t1;case 51:this.eventHandler.emitEvent(kf,So.Popup);case 52:case"end":return e.stop()}}),e,this,[[3,43],[9,13]])}))),function(e,t,r,o){return n.apply(this,arguments)})},{key:"initiateAuthRequest",value:function(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),ia(ii)}},{key:"monitorPopupForHash",value:function(e,t){var n=this;return new Promise((function(t,r){n.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var o=setInterval((function(){if(e.closed)return n.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(o),void r(ia(di));var i="";try{i=e.location.href}catch(e){}if(i&&"about:blank"!==i){clearInterval(o);var a="",c=n.config.auth.OIDCOptions.serverResponseType;e&&(a=c===C.QUERY?e.location.search:e.location.hash),n.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(a)}}),n.config.system.pollIntervalMilliseconds)})).finally((function(){n.cleanPopup(e,t)}))}},{key:"openPopup",value:function(e,t){try{var n;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),n.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),n=this.openSizedPopup(e,t)),!n)throw ia(hi);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),ia(pi)}}},{key:"openSizedPopup",value:function(e,t){var n,r,o,i,a=t.popupName,c=t.popupWindowAttributes,u=t.popupWindowParent,s=u.screenLeft?u.screenLeft:u.screenX,l=u.screenTop?u.screenTop:u.screenY,f=u.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,p=u.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=null===(n=c.popupSize)||void 0===n?void 0:n.width,d=null===(r=c.popupSize)||void 0===r?void 0:r.height,y=null===(o=c.popupPosition)||void 0===o?void 0:o.top,v=null===(i=c.popupPosition)||void 0===i?void 0:i.left;return(!h||h<0||h>f)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),h=To.POPUP_WIDTH),(!d||d<0||d>p)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),d=To.POPUP_HEIGHT),(!y||y<0||y>p)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),y=Math.max(0,p/2-To.POPUP_HEIGHT/2+l)),(!v||v<0||v>f)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),v=Math.max(0,f/2-To.POPUP_WIDTH/2+s)),u.open(e,a,"width=".concat(h,", height=").concat(d,", top=").concat(y,", left=").concat(v,", scrollbars=yes"))}},{key:"unloadWindow",value:function(e){this.browserStorage.cleanRequestByInteractionType(So.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}},{key:"cleanPopup",value:function(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}},{key:"generatePopupName",value:function(e,t){return"".concat(To.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}},{key:"generateLogoutPopupName",value:function(e){var t=e.account&&e.account.homeAccountId;return"".concat(To.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}]);var n,r}(Ey);function Eg(e){return Eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eg(e)}function jg(){var e=Gg(),t=e.m(jg),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,_g(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(jg=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Bg(e,t)},AsyncIterator:qg,async:function(e,t,n,o,a){return(r(t)?Mg:Ng)(i(e),t,n,o,a)},keys:Rg,values:_g}})()}function _g(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Eg(e)+" is not iterable")}function Rg(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Ng(e,t,n,r,o){var i=Mg(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Mg(e,t,n,r,o){return new qg(Gg().w(e,t,n,r),o||Promise)}function qg(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Bg?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Fg(qg.prototype),Fg(qg.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Fg(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Gg(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Fg(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Fg(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Fg(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Fg(f,"constructor",s),Fg(s,"constructor",u),u.displayName="GeneratorFunction",Fg(s,o,"GeneratorFunction"),Fg(f),Fg(f,o,"Generator"),Fg(f,r,(function(){return this})),Fg(f,"toString",(function(){return"[object Generator]"})),(Gg=function(){return{w:i,m:p}})()}function Fg(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Fg=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Fg(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Fg(e,t,n,r)}function Bg(e,t){this.v=e,this.k=t}function Hg(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Dg(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Hg(i,r,o,a,c,"next",e)}function c(e){Hg(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Ug(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Lg(r.key),r)}}function Lg(e){var t=function(e){if("object"!=Eg(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Eg(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Eg(t)?t:t+""}var Kg=function(){return function(e,t){return t&&Ug(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.authModule=t,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}),[{key:"initiateAuthRequest",value:function(){var e=Dg(jg().mark((function e(t,n){var r;return jg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),!t){e.next=27;break}if(n.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(No,n.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Bo,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(t)),r={apiId:zo,timeout:n.redirectTimeout,noHistory:!1},"function"!=typeof n.onRedirectNavigate){e.next=21;break}if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===n.onRedirectNavigate(t)){e.next=17;break}return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),e.next=14,n.navigationClient.navigateExternal(t,r);case 14:case 24:return e.abrupt("return");case 17:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),e.abrupt("return");case 19:e.next=25;break;case 21:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),e.next=24,n.navigationClient.navigateExternal(t,r);case 25:e.next=29;break;case 27:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),ia(ii);case 29:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleCodeResponse",value:(e=Dg(jg().mark((function e(t,n){var r,o,i,a,c,u,s;return jg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1),r=this.browserStorage.generateStateKey(n),o=this.browserStorage.getTemporaryCache(r)){e.next=6;break}throw it(ve,"Cached State");case 6:e.prev=6,i=this.authModule.handleFragmentResponse(t,o),e.next=17;break;case 10:if(e.prev=10,e.t0=e.catch(6),!(e.t0 instanceof _f&&e.t0.subError===di)){e.next=16;break}throw ia(di);case 16:throw e.t0;case 17:if(a=this.browserStorage.generateNonceKey(o),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=i.code,!i.cloud_instance_host_name){e.next=23;break}return e.next=23,ts(this.authModule.updateAuthority.bind(this.authModule),yo.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId);case 23:return i.nonce=c||void 0,i.state=o,i.client_info?this.authCodeRequest.clientInfo=i.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),e.next=28,this.authModule.acquireToken(this.authCodeRequest,i);case 28:return s=e.sent,this.browserStorage.cleanRequestByState(n),e.abrupt("return",s);case 31:case"end":return e.stop()}}),e,this,[[6,10]])}))),function(t,n){return e.apply(this,arguments)})},{key:"checkCcsCredentials",value:function(){var e=this.browserStorage.getTemporaryCache(Fo,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: ".concat(e))}return null}}]);var e}();function zg(e){return zg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zg(e)}function Qg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wg(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wg(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Yg(){var e=eb(),t=e.m(Yg),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Vg(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Yg=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new nb(e,t)},AsyncIterator:$g,async:function(e,t,n,o,a){return(r(t)?Xg:Zg)(i(e),t,n,o,a)},keys:Jg,values:Vg}})()}function Vg(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(zg(e)+" is not iterable")}function Jg(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Zg(e,t,n,r,o){var i=Xg(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Xg(e,t,n,r,o){return new $g(eb().w(e,t,n,r),o||Promise)}function $g(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof nb?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(tb($g.prototype),tb($g.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),tb(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function eb(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return tb(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(tb(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,tb(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,tb(f,"constructor",s),tb(s,"constructor",u),u.displayName="GeneratorFunction",tb(s,o,"GeneratorFunction"),tb(f),tb(f,o,"Generator"),tb(f,r,(function(){return this})),tb(f,"toString",(function(){return"[object Generator]"})),(eb=function(){return{w:i,m:p}})()}function tb(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}tb=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){tb(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},tb(e,t,n,r)}function nb(e,t){this.v=e,this.k=t}function rb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ob(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rb(Object(n),!0).forEach((function(t){ib(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ib(e,t,n){return(t=sb(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ab(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function cb(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ab(i,r,o,a,c,"next",e)}function c(e){ab(i,r,o,a,c,"throw",e)}a(void 0)}))}}function ub(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,sb(r.key),r)}}function sb(e){var t=function(e){if("object"!=zg(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=zg(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==zg(t)?t:t+""}function lb(e,t,n){return t=pb(t),function(e,t){if(t&&("object"==zg(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fb()?Reflect.construct(t,n||[],pb(e).constructor):t.apply(e,n))}function fb(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fb=function(){return!!e})()}function pb(e){return pb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pb(e)}function hb(e,t){return hb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hb(e,t)}function db(){if("undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.getEntriesByType){var e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return null==t?void 0:t.type}}var yb=function(e){function t(e,n,r,o,i,a,c,u,s,l){var f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(f=lb(this,t,[e,n,r,o,i,a,c,s,l])).nativeStorage=u,f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hb(e,t)}(t,e),function(e,t){return t&&ub(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:(a=cb(Yg().mark((function e(t){var n,r,o,i,a,c,u,s,l=this;return Yg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ts(this.initializeAuthorizationRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,So.Redirect);case 2:return n=e.sent,this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null),r=this.initializeServerTelemetryManager(zo),o=function(e){e.persisted&&(l.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),l.browserStorage.cleanRequestByState(n.state),l.eventHandler.emitEvent("msal:restoreFromBFCache",So.Redirect))},e.prev=6,e.next=9,ts(this.initializeAuthorizationCodeRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(n);case 9:return i=e.sent,e.next=12,ts(this.createAuthCodeClient.bind(this),yo.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account});case 12:return a=e.sent,c=new Kg(a,this.browserStorage,i,this.logger,this.performanceClient),e.next=16,a.getAuthCodeUrl(ob(ob({},n),{},{nativeBroker:zm.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}));case 16:return u=e.sent,s=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: ".concat(s)),window.addEventListener("pageshow",o),e.next=22,c.initiateAuthRequest(u,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:s,onRedirectNavigate:t.onRedirectNavigate||this.config.auth.onRedirectNavigate});case 22:return e.abrupt("return",e.sent);case 25:throw e.prev=25,e.t0=e.catch(6),e.t0 instanceof re&&(e.t0.setCorrelationId(this.correlationId),r.cacheFailedRequest(e.t0)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(n.state),e.t0;case 31:case"end":return e.stop()}}),e,this,[[6,25]])}))),function(e){return a.apply(this,arguments)})},{key:"handleRedirectPromise",value:(o=cb(Yg().mark((function e(){var t,n,r,o,a,c,u,s,l,f,p,h,d,y,v=arguments;return Yg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=v.length>0&&void 0!==v[0]?v[0]:"",n=v.length>1?v[1]:void 0,r=this.initializeServerTelemetryManager(865),e.prev=3,this.browserStorage.isInteractionInProgress(!0)){e.next=7;break}return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),e.abrupt("return",null);case 7:if(o=this.getRedirectResponse(t||""),a=Qg(o,2),c=a[0],u=a[1],c){e.next=13;break}return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(So.Redirect),"back_forward"!==db()?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),e.abrupt("return",null);case 13:if(s=this.browserStorage.getTemporaryCache(No,!0)||i.EMPTY_STRING,l=tr.removeHashFromUrl(s),f=tr.removeHashFromUrl(window.location.href),l!==f||!this.config.auth.navigateToLoginRequestUrl){e.next=25;break}return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&(g=void 0,(g=s.split("#")).shift(),window.location.hash=g.length>0?g.join("#"):""),e.next=21,this.handleResponse(c,r);case 21:return p=e.sent,e.abrupt("return",p);case 25:if(this.config.auth.navigateToLoginRequestUrl){e.next=32;break}return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),e.next=29,this.handleResponse(c,r);case 29:return e.abrupt("return",e.sent);case 32:if(ef()&&!this.config.system.allowRedirectInIframe){e.next=53;break}if(this.browserStorage.setTemporaryCache(Mo,u,!0),h={apiId:865,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},d=!0,s&&"null"!==s){e.next=45;break}return void 0,m=new tr(window.location.href).getUrlComponents(),y="".concat(m.Protocol,"//").concat(m.HostNameAndPort,"/"),this.browserStorage.setTemporaryCache(No,y,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),e.next=42,this.navigationClient.navigateInternal(y,h);case 42:d=e.sent,e.next=49;break;case 45:return this.logger.verbose("Navigating to loginRequestUrl: ".concat(s)),e.next=48,this.navigationClient.navigateInternal(s,h);case 48:d=e.sent;case 49:if(d){e.next=53;break}return e.next=52,this.handleResponse(c,r);case 52:return e.abrupt("return",e.sent);case 53:return e.abrupt("return",null);case 56:throw e.prev=56,e.t0=e.catch(3),e.t0 instanceof re&&(e.t0.setCorrelationId(this.correlationId),r.cacheFailedRequest(e.t0)),this.browserStorage.cleanRequestByInteractionType(So.Redirect),e.t0;case 61:case"end":return e.stop()}var m,g}),e,this,[[3,56]])}))),function(){return o.apply(this,arguments)})},{key:"getRedirectResponse",value:function(e){this.logger.verbose("getRedirectResponseHash called");var t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===C.QUERY?window.location.search:window.location.hash);var n,r=Zn(t);if(r){try{!function(e,t,n){if(!e.state)throw ia(ci);var r=Cl(t,e.state);if(!r)throw ia(si);if(r.interactionType!==n)throw ia(li)}(r,this.browserCrypto,So.Redirect)}catch(e){return e instanceof re&&this.logger.error("Interaction type validation failed due to ".concat(e.errorCode,": ").concat(e.errorMessage)),[null,""]}return(n=window).location.hash="","function"==typeof n.history.replaceState&&n.history.replaceState(null,"","".concat(n.location.origin).concat(n.location.pathname).concat(n.location.search)),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}var o=this.browserStorage.getTemporaryCache(Mo,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Mo)),o&&(r=Zn(o))?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}},{key:"handleResponse",value:(r=cb(Yg().mark((function e(t,n){var r,o,i,a,c,u,s,l,f=this;return Yg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state){e.next=3;break}throw ia(ci);case 3:if(o=this.browserStorage.getCachedRequest(r),this.logger.verbose("handleResponse called, retrieved cached request"),!t.accountId){e.next=12;break}if(this.logger.verbose("Account id found in hash, calling WAM for token"),this.nativeMessageHandler){e.next=9;break}throw ia(Ki);case 9:return i=new Em(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qo,this.performanceClient,this.nativeMessageHandler,t.accountId,this.nativeStorage,o.correlationId),a=ol.parseRequestState(this.browserCrypto,r),c=a.userRequestState,e.abrupt("return",i.acquireToken(ob(ob({},o),{},{state:c,prompt:void 0})).finally((function(){f.browserStorage.cleanRequestByState(r)})));case 12:if(u=this.browserStorage.getCachedAuthority(r)){e.next=15;break}throw ia(Ai);case 15:return e.next=17,ts(this.createAuthCodeClient.bind(this),yo.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:u});case 17:return s=e.sent,qf.removeThrottle(this.browserStorage,this.config.auth.clientId,o),l=new Kg(s,this.browserStorage,o,this.logger,this.performanceClient),e.abrupt("return",l.handleCodeResponse(t,r));case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"logout",value:(n=cb(Yg().mark((function e(t){var n,r,o,i,a,c,u;return Yg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.verbose("logoutRedirect called"),n=this.initializeLogoutRequest(t),r=this.initializeServerTelemetryManager(961),e.prev=3,this.eventHandler.emitEvent(gf,So.Redirect,t),e.next=7,this.clearCacheOnLogout(n.account);case 7:return o={apiId:961,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},e.next=10,ts(this.createAuthCodeClient.bind(this),yo.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t&&t.authority,requestExtraQueryParameters:null==t?void 0:t.extraQueryParameters,account:t&&t.account||void 0});case 10:if((i=e.sent).authority.protocolMode!==K){e.next=22;break}e.prev=12,i.authority.endSessionEndpoint,e.next=22;break;case 16:if(e.prev=16,e.t0=e.catch(12),null===(a=n.account)||void 0===a||!a.homeAccountId){e.next=22;break}return this.browserStorage.removeAccount(null===(c=n.account)||void 0===c?void 0:c.homeAccountId),this.eventHandler.emitEvent(bf,So.Redirect,n),e.abrupt("return");case 22:if(u=i.getLogoutUri(n),this.eventHandler.emitEvent(bf,So.Redirect,n),!t||"function"!=typeof t.onRedirectNavigate){e.next=38;break}if(!1===t.onRedirectNavigate(u)){e.next=34;break}return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),e.next=31,this.navigationClient.navigateExternal(u,o);case 31:return e.abrupt("return");case 34:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");case 36:e.next=42;break;case 38:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),e.next=41,this.navigationClient.navigateExternal(u,o);case 41:return e.abrupt("return");case 42:e.next=50;break;case 44:throw e.prev=44,e.t1=e.catch(3),e.t1 instanceof re&&(e.t1.setCorrelationId(this.correlationId),r.cacheFailedRequest(e.t1)),this.eventHandler.emitEvent(wf,So.Redirect,null,e.t1),this.eventHandler.emitEvent(kf,So.Redirect),e.t1;case 50:this.eventHandler.emitEvent(kf,So.Redirect);case 51:case"end":return e.stop()}}),e,this,[[3,44],[12,16]])}))),function(e){return n.apply(this,arguments)})},{key:"getRedirectStartPage",value:function(e){var t=e||window.location.href;return tr.getAbsoluteUrl(t,tf())}}]);var n,r,o,a}(Ey);function vb(e){return vb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vb(e)}function mb(){var e=Ob(),t=e.m(mb),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,gb(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(mb=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Tb(e,t)},AsyncIterator:Sb,async:function(e,t,n,o,a){return(r(t)?kb:wb)(i(e),t,n,o,a)},keys:bb,values:gb}})()}function gb(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(vb(e)+" is not iterable")}function bb(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function wb(e,t,n,r,o){var i=kb(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function kb(e,t,n,r,o){return new Sb(Ob().w(e,t,n,r),o||Promise)}function Sb(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Tb?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Cb(Sb.prototype),Cb(Sb.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Cb(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Ob(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Cb(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Cb(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Cb(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Cb(f,"constructor",s),Cb(s,"constructor",u),u.displayName="GeneratorFunction",Cb(s,o,"GeneratorFunction"),Cb(f),Cb(f,o,"Generator"),Cb(f,r,(function(){return this})),Cb(f,"toString",(function(){return"[object Generator]"})),(Ob=function(){return{w:i,m:p}})()}function Cb(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Cb=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Cb(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Cb(e,t,n,r)}function Tb(e,t){this.v=e,this.k=t}function Ab(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ib(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ab(i,r,o,a,c,"next",e)}function c(e){Ab(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Pb(e,t,n,r,o){return xb.apply(this,arguments)}function xb(){return(xb=Ib(mb().mark((function e(t,n,r,o,i){return mb().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.addQueueMeasurement(yo.SilentHandlerInitiateAuthRequest,o),t){e.next=4;break}throw r.info("Navigate url is empty"),ia(ii);case 4:if(!i){e.next=6;break}return e.abrupt("return",ts(_b,yo.SilentHandlerLoadFrame,r,n,o)(t,i,n,o));case 6:return e.abrupt("return",es(Rb,yo.SilentHandlerLoadFrameSync,r,n,o)(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Eb(e,t,n,r,o,i,a){return jb.apply(this,arguments)}function jb(){return(jb=Ib(mb().mark((function e(t,n,r,o,i,a,c){return mb().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.addQueueMeasurement(yo.SilentHandlerMonitorIframeForHash,a),e.abrupt("return",new Promise((function(e,o){n<Ta&&i.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(n,"ms) than the default (").concat(Ta,"ms). This may result in timeouts."));var a=window.setTimeout((function(){window.clearInterval(u),o(ia(vi))}),n),u=window.setInterval((function(){var n="",r=t.contentWindow;try{n=r?r.location.href:""}catch(e){}if(n&&"about:blank"!==n){var o="";r&&(o=c===C.QUERY?r.location.search:r.location.hash),window.clearTimeout(a),window.clearInterval(u),e(o)}}),r)})).finally((function(){es(Mb,yo.RemoveHiddenIframe,i,o,a)(t)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _b(e,t,n,r){return n.addQueueMeasurement(yo.SilentHandlerLoadFrame,r),new Promise((function(n,r){var o=Nb();window.setTimeout((function(){o?(o.src=e,n(o)):r("Unable to load iframe")}),t)}))}function Rb(e){var t=Nb();return t.src=e,t}function Nb(){var e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Mb(e){document.body===e.parentNode&&document.body.removeChild(e)}function qb(e){return qb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qb(e)}function Gb(){var e=Lb(),t=e.m(Gb),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Fb(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Gb=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new zb(e,t)},AsyncIterator:Ub,async:function(e,t,n,o,a){return(r(t)?Db:Hb)(i(e),t,n,o,a)},keys:Bb,values:Fb}})()}function Fb(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(qb(e)+" is not iterable")}function Bb(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Hb(e,t,n,r,o){var i=Db(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Db(e,t,n,r,o){return new Ub(Lb().w(e,t,n,r),o||Promise)}function Ub(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof zb?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Kb(Ub.prototype),Kb(Ub.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Kb(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Lb(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Kb(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Kb(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Kb(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Kb(f,"constructor",s),Kb(s,"constructor",u),u.displayName="GeneratorFunction",Kb(s,o,"GeneratorFunction"),Kb(f),Kb(f,o,"Generator"),Kb(f,r,(function(){return this})),Kb(f,"toString",(function(){return"[object Generator]"})),(Lb=function(){return{w:i,m:p}})()}function Kb(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Kb=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Kb(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Kb(e,t,n,r)}function zb(e,t){this.v=e,this.k=t}function Qb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qb(Object(n),!0).forEach((function(t){Yb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yb(e,t,n){return(t=Xb(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vb(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Jb(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Vb(i,r,o,a,c,"next",e)}function c(e){Vb(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Zb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xb(r.key),r)}}function Xb(e){var t=function(e){if("object"!=qb(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=qb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qb(t)?t:t+""}function $b(e,t,n){return t=tw(t),function(e,t){if(t&&("object"==qb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ew()?Reflect.construct(t,n||[],tw(e).constructor):t.apply(e,n))}function ew(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ew=function(){return!!e})()}function tw(e){return tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tw(e)}function nw(e,t){return nw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nw(e,t)}var rw=function(e){function t(e,n,r,o,i,a,c,u,s,l,f){var p;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(p=$b(this,t,[e,n,r,o,i,a,u,l,f])).apiId=c,p.nativeStorage=s,p}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nw(e,t)}(t,e),function(e,t){return t&&Zb(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:(r=Jb(Gb().mark((function e(t){var n,r,o,i,a;return Gb().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.SilentIframeClientAcquireToken,t.correlationId),t.loginHint||t.sid||t.account&&t.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),(n=Wb({},t)).prompt?n.prompt!==S.NONE&&n.prompt!==S.NO_SESSION&&(this.logger.warning("SilentIframeClient. Replacing invalid prompt ".concat(n.prompt," with ").concat(S.NONE)),n.prompt=S.NONE):n.prompt=S.NONE,e.next=6,ts(this.initializeAuthorizationRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(n,So.Silent);case 6:return cf((r=e.sent).authority),o=this.initializeServerTelemetryManager(this.apiId),e.prev=9,e.next=12,ts(this.createAuthCodeClient.bind(this),yo.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,t.correlationId)({serverTelemetryManager:o,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account});case 12:return i=e.sent,e.next=15,ts(this.silentTokenHelper.bind(this),yo.SilentIframeClientTokenHelper,this.logger,this.performanceClient,t.correlationId)(i,r);case 15:case 29:return e.abrupt("return",e.sent);case 18:if(e.prev=18,e.t0=e.catch(9),e.t0 instanceof re&&(e.t0.setCorrelationId(this.correlationId),o.cacheFailedRequest(e.t0)),i&&e.t0 instanceof re&&e.t0.errorCode===To.INVALID_GRANT_ERROR){e.next=23;break}throw e.t0;case 23:return this.performanceClient.addFields({retryError:e.t0.errorCode},this.correlationId),e.next=26,ts(this.initializeAuthorizationRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(n,So.Silent);case 26:return a=e.sent,e.next=29,ts(this.silentTokenHelper.bind(this),yo.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,a);case 30:case"end":return e.stop()}}),e,this,[[9,18]])}))),function(e){return r.apply(this,arguments)})},{key:"logout",value:function(){return Promise.reject(ia(ki))}},{key:"silentTokenHelper",value:(n=Jb(Gb().mark((function e(t,n){var r,o,i,a,c,u,s,l,f,p,h;return Gb().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.correlationId,this.performanceClient.addQueueMeasurement(yo.SilentIframeClientTokenHelper,r),e.next=4,ts(this.initializeAuthorizationCodeRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(n);case 4:return o=e.sent,e.next=7,ts(t.getAuthCodeUrl.bind(t),yo.GetAuthCodeUrl,this.logger,this.performanceClient,r)(Wb(Wb({},n),{},{nativeBroker:zm.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,n.authenticationScheme)}));case 7:return i=e.sent,a=new ag(t,this.browserStorage,o,this.logger,this.performanceClient),e.next=11,ts(Pb,yo.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait);case 11:return c=e.sent,u=this.config.auth.OIDCOptions.serverResponseType,e.next=15,ts(Eb,yo.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(c,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,u);case 15:if(s=e.sent,!(l=es(cg,yo.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(s,u,this.logger)).accountId){e.next=24;break}if(this.logger.verbose("Account id found in hash, calling WAM for token"),this.nativeMessageHandler){e.next=21;break}throw ia(Ki);case 21:return f=new Em(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,l.accountId,this.browserStorage,r),p=ol.parseRequestState(this.browserCrypto,n.state),h=p.userRequestState,e.abrupt("return",ts(f.acquireToken.bind(f),yo.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)(Wb(Wb({},n),{},{state:h,prompt:n.prompt||S.NONE})));case 24:return e.abrupt("return",ts(a.handleCodeResponse.bind(a),yo.HandleCodeResponse,this.logger,this.performanceClient,r)(l,n));case 25:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]);var n,r}(Ey);function ow(e){return ow="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ow(e)}function iw(){var e=fw(),t=e.m(iw),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,aw(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(iw=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new hw(e,t)},AsyncIterator:lw,async:function(e,t,n,o,a){return(r(t)?sw:uw)(i(e),t,n,o,a)},keys:cw,values:aw}})()}function aw(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ow(e)+" is not iterable")}function cw(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function uw(e,t,n,r,o){var i=sw(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function sw(e,t,n,r,o){return new lw(fw().w(e,t,n,r),o||Promise)}function lw(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof hw?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(pw(lw.prototype),pw(lw.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),pw(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function fw(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return pw(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(pw(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,pw(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,pw(f,"constructor",s),pw(s,"constructor",u),u.displayName="GeneratorFunction",pw(s,o,"GeneratorFunction"),pw(f),pw(f,o,"Generator"),pw(f,r,(function(){return this})),pw(f,"toString",(function(){return"[object Generator]"})),(fw=function(){return{w:i,m:p}})()}function pw(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}pw=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){pw(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},pw(e,t,n,r)}function hw(e,t){this.v=e,this.k=t}function dw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dw(Object(n),!0).forEach((function(t){vw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vw(e,t,n){return(t=ww(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mw(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function gw(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){mw(i,r,o,a,c,"next",e)}function c(e){mw(i,r,o,a,c,"throw",e)}a(void 0)}))}}function bw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ww(r.key),r)}}function ww(e){var t=function(e){if("object"!=ow(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ow(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ow(t)?t:t+""}function kw(e,t,n){return t=Ow(t),function(e,t){if(t&&("object"==ow(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Sw()?Reflect.construct(t,n||[],Ow(e).constructor):t.apply(e,n))}function Sw(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Sw=function(){return!!e})()}function Ow(e){return Ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ow(e)}function Cw(e,t){return Cw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Cw(e,t)}var Tw=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kw(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cw(e,t)}(t,e),function(e,t){return t&&bw(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:(r=gw(iw().mark((function e(t){var n,r,o,i,a=this;return iw().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.SilentRefreshClientAcquireToken,t.correlationId),e.next=3,ts(iy,yo.InitializeBaseRequest,this.logger,this.performanceClient,t.correlationId)(t,this.config,this.performanceClient,this.logger);case 3:return n=e.sent,r=yw(yw({},t),n),t.redirectUri&&(r.redirectUri=this.getRedirectUri(t.redirectUri)),o=this.initializeServerTelemetryManager(61),e.next=9,this.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});case 9:return i=e.sent,e.abrupt("return",ts(i.acquireTokenByRefreshToken.bind(i),yo.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,t.correlationId)(r).catch((function(e){throw e.setCorrelationId(a.correlationId),o.cacheFailedRequest(e),e})));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"logout",value:function(){return Promise.reject(ia(ki))}},{key:"createRefreshTokenClient",value:(n=gw(iw().mark((function e(t){var n;return iw().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ts(this.getClientConfiguration.bind(this),yo.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t.serverTelemetryManager,requestAuthority:t.authorityUrl,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});case 2:return n=e.sent,e.abrupt("return",new pv(n,this.performanceClient));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]);var n,r}(Ey);function Aw(e){return Aw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Aw(e)}function Iw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pw(r.key),r)}}function Pw(e){var t=function(e){if("object"!=Aw(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Aw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Aw(t)?t:t+""}var xw=function(){return function(e,t){return t&&Iw(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isBrowserEnvironment="undefined"!=typeof window,this.config=t,this.storage=n,this.logger=r,this.cryptoObj=o}),[{key:"loadExternalTokens",value:function(e,t,n){if(!this.isBrowserEnvironment)throw ia(xi);var r=t.id_token?kt(t.id_token,mc):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.authority?new Ns(Ns.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||Bc()):void 0,a=this.loadAccount(e,n.clientInfo||t.client_info||"",r,i),c=this.loadIdToken(t,a.homeAccountId,a.environment,a.realm),u=this.loadAccessToken(e,t,a.homeAccountId,a.environment,a.realm,n),s=this.loadRefreshToken(t,a.homeAccountId,a.environment);return this.generateAuthenticationResult(e,{account:a,idToken:c,accessToken:u,refreshToken:s},r,i)}},{key:"loadAccount",value:function(e,t,n,r){if(this.logger.verbose("TokenCache - loading account"),e.account){var o=Vn.createFromAccountInfo(e.account);return this.storage.setAccount(o),o}if(!r||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),ia(Mi);var i=Vn.generateHomeAccountId(t,r.authorityType,this.logger,this.cryptoObj,n),a=null==n?void 0:n.tid,c=Ch(this.storage,r,i,mc,n,t,r.hostnameAndPort,a,void 0,void 0,this.logger);return this.storage.setAccount(c),c}},{key:"loadIdToken",value:function(e,t,n,r){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");var o=It(t,n,e.id_token,this.config.auth.clientId,r);return this.storage.setIdTokenCredential(o),o}},{key:"loadAccessToken",value:function(e,t,n,r,o,i){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");var a=t.scope?_n.fromString(t.scope):new _n(e.scopes),c=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,u=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+(new Date).getTime()/1e3,s=Pt(n,r,t.access_token,this.config.auth.clientId,o,a.printScopes(),c,u,mc);return this.storage.setAccessTokenCredential(s),s}},{key:"loadRefreshToken",value:function(e,t,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");var r=xt(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(r),r}},{key:"generateAuthenticationResult",value:function(e,t,n,r){var o,i,a,c,u="",s=[],l=null;null!=t&&t.accessToken&&(u=t.accessToken.secret,s=_n.fromString(t.accessToken.target).asArray(),l=new Date(1e3*Number(t.accessToken.expiresOn)),c=new Date(1e3*Number(t.accessToken.extendedExpiresOn)));var f=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:s,account:f.getAccountInfo(),idToken:(null===(o=t.idToken)||void 0===o?void 0:o.secret)||"",idTokenClaims:n||{},accessToken:u,fromCache:!0,expiresOn:l,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:(null===(i=t.refreshToken)||void 0===i?void 0:i.familyId)||"",tokenType:(null==t||null===(a=t.accessToken)||void 0===a?void 0:a.tokenType)||"",state:e.state||"",cloudGraphHostName:f.cloudGraphHostName||"",msGraphHost:f.msGraphHost||"",fromNativeBroker:!1}}}])}();function Ew(e){return Ew="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ew(e)}function jw(e,t,n){return t=Rw(t),function(e,t){if(t&&("object"==Ew(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_w()?Reflect.construct(t,n||[],Rw(e).constructor):t.apply(e,n))}function _w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_w=function(){return!!e})()}function Rw(e){return Rw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rw(e)}function Nw(e,t){return Nw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nw(e,t)}var Mw=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=jw(this,t,[e])).includeRedirectUri=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nw(e,t)}(t,e),function(e){return Object.defineProperty(e,"prototype",{writable:!1}),e}(t)}(od);function qw(e){return qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qw(e)}function Gw(){var e=Lw(),t=e.m(Gw),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Fw(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Gw=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new zw(e,t)},AsyncIterator:Uw,async:function(e,t,n,o,a){return(r(t)?Dw:Hw)(i(e),t,n,o,a)},keys:Bw,values:Fw}})()}function Fw(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(qw(e)+" is not iterable")}function Bw(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Hw(e,t,n,r,o){var i=Dw(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function Dw(e,t,n,r,o){return new Uw(Lw().w(e,t,n,r),o||Promise)}function Uw(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof zw?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Kw(Uw.prototype),Kw(Uw.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Kw(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Lw(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Kw(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Kw(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Kw(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Kw(f,"constructor",s),Kw(s,"constructor",u),u.displayName="GeneratorFunction",Kw(s,o,"GeneratorFunction"),Kw(f),Kw(f,o,"Generator"),Kw(f,r,(function(){return this})),Kw(f,"toString",(function(){return"[object Generator]"})),(Lw=function(){return{w:i,m:p}})()}function Kw(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Kw=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Kw(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Kw(e,t,n,r)}function zw(e,t){this.v=e,this.k=t}function Qw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ww(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qw(Object(n),!0).forEach((function(t){Yw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yw(e,t,n){return(t=Zw(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vw(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Jw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Zw(r.key),r)}}function Zw(e){var t=function(e){if("object"!=qw(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=qw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qw(t)?t:t+""}function Xw(e,t,n){return t=ek(t),function(e,t){if(t&&("object"==qw(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$w()?Reflect.construct(t,n||[],ek(e).constructor):t.apply(e,n))}function $w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($w=function(){return!!e})()}function ek(e){return ek=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ek(e)}function tk(e,t){return tk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tk(e,t)}var nk=function(e){function t(e,n,r,o,i,a,c,u,s,l){var f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(f=Xw(this,t,[e,n,r,o,i,a,u,s,l])).apiId=c,f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tk(e,t)}(t,e),function(e,t){return t&&Jw(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"acquireToken",value:(n=Gw().mark((function e(t){var n,r,o,i,a,c;return Gw().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code){e.next=2;break}throw ia(Gi);case 2:return e.next=4,ts(this.initializeAuthorizationRequest.bind(this),yo.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(t,So.Silent);case 4:return n=e.sent,r=this.initializeServerTelemetryManager(this.apiId),e.prev=6,o=Ww(Ww({},n),{},{code:t.code}),e.next=10,ts(this.getClientConfiguration.bind(this),yo.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,t.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account});case 10:return i=e.sent,a=new Mw(i),this.logger.verbose("Auth code client created"),c=new ag(a,this.browserStorage,o,this.logger,this.performanceClient),e.next=16,ts(c.handleCodeResponseFromServer.bind(c),yo.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},n,!1);case 16:return e.abrupt("return",e.sent);case 19:throw e.prev=19,e.t0=e.catch(6),e.t0 instanceof re&&(e.t0.setCorrelationId(this.correlationId),r.cacheFailedRequest(e.t0)),e.t0;case 23:case"end":return e.stop()}}),e,this,[[6,19]])})),r=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){Vw(i,r,o,a,c,"next",e)}function c(e){Vw(i,r,o,a,c,"throw",e)}a(void 0)}))},function(e){return r.apply(this,arguments)})},{key:"logout",value:function(){return Promise.reject(ia(ki))}}]);var n,r}(Ey);function rk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ok(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ok(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ok(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ik(e){return ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ik(e)}function ak(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ck(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ak(Object(n),!0).forEach((function(t){uk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ak(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uk(e,t,n){return(t=kk(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sk(){var e=yk(),t=e.m(sk),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,lk(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(sk=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new mk(e,t)},AsyncIterator:dk,async:function(e,t,n,o,a){return(r(t)?hk:pk)(i(e),t,n,o,a)},keys:fk,values:lk}})()}function lk(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ik(e)+" is not iterable")}function fk(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function pk(e,t,n,r,o){var i=hk(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function hk(e,t,n,r,o){return new dk(yk().w(e,t,n,r),o||Promise)}function dk(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof mk?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(vk(dk.prototype),vk(dk.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),vk(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function yk(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return vk(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(vk(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,vk(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,vk(f,"constructor",s),vk(s,"constructor",u),u.displayName="GeneratorFunction",vk(s,o,"GeneratorFunction"),vk(f),vk(f,o,"Generator"),vk(f,r,(function(){return this})),vk(f,"toString",(function(){return"[object Generator]"})),(yk=function(){return{w:i,m:p}})()}function vk(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}vk=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){vk(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},vk(e,t,n,r)}function mk(e,t){this.v=e,this.k=t}function gk(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function bk(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){gk(i,r,o,a,c,"next",e)}function c(e){gk(i,r,o,a,c,"throw",e)}a(void 0)}))}}function wk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kk(r.key),r)}}function kk(e){var t=function(e){if("object"!=ik(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ik(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ik(t)?t:t+""}function Sk(e){var t=null==e?void 0:e.idTokenClaims;return null!=t&&t.tfp||null!=t&&t.acr?"B2C":null!=t&&t.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===(null==t?void 0:t.tid)?"MSA":"AAD":void 0}function Ok(e,t){try{of(e)}catch(e){throw t.end({success:!1},e),e}}var Ck=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.operatingContext=t,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=t.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Wu(this.logger,this.performanceClient):gt,this.eventHandler=new Af(this.logger),this.browserStorage=this.isBrowserEnvironment?new zl(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,Gs(this.config.auth),this.performanceClient):Ql(this.config.auth.clientId,this.logger);var n={cacheLocation:_o,temporaryCacheLocation:_o,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new zl(this.config.auth.clientId,n,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new xw(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return function(e,t,n){return t&&wk(e.prototype,t),n&&wk(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(e,[{key:"trackPageVisibility",value:function(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}},{key:"initialize",value:(O=bk(sk().mark((function e(t){var n,r,o;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.trace("initialize called"),!this.initialized){e.next=4;break}return this.logger.info("initialize has already been called, exiting early."),e.abrupt("return");case 4:if(this.isBrowserEnvironment){e.next=9;break}return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(uf),e.abrupt("return");case 9:if(n=(null==t?void 0:t.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,o=this.performanceClient.startMeasurement(yo.InitializeClientApplication,n),this.eventHandler.emitEvent("msal:initializeStart"),!r){e.next=23;break}return e.prev=14,e.next=17,zm.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient);case 17:this.nativeExtensionProvider=e.sent,e.next=23;break;case 20:e.prev=20,e.t0=e.catch(14),this.logger.verbose(e.t0);case 23:if(this.config.cache.claimsBasedCachingEnabled){e.next=27;break}return this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),e.next=27,ts(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),yo.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,n)(this.performanceClient,n);case 27:this.initialized=!0,this.eventHandler.emitEvent(uf),o.end({allowNativeBroker:r,success:!0});case 30:case"end":return e.stop()}}),e,this,[[14,20]])}))),function(e){return O.apply(this,arguments)})},{key:"handleRedirectPromise",value:(k=bk(sk().mark((function e(t){var n,r;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.verbose("handleRedirectPromise called"),rf(this.initialized),!this.isBrowserEnvironment){e.next=7;break}return n=t||"",void 0===(r=this.redirectResponse.get(n))?(r=this.handleRedirectPromiseInternal(t),this.redirectResponse.set(n,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),e.abrupt("return",r);case 7:return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"handleRedirectPromiseInternal",value:(w=bk(sk().mark((function e(t){var n,r,o,i,a,c,u,s,l=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),o=r&&zm.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t,i=o?null==r?void 0:r.correlationId:this.browserStorage.getTemporaryCache(Bo,!0)||"",a=this.performanceClient.startMeasurement(yo.AcquireTokenRedirect,i),this.eventHandler.emitEvent("msal:handleRedirectStart",So.Redirect),o&&this.nativeExtensionProvider?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),u=new Em(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,865,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId),c=ts(u.handleRedirectPromise.bind(u),yo.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),s=this.createRedirectClient(i),c=ts(s.handleRedirectPromise.bind(s),yo.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(t,a)),e.abrupt("return",c.then((function(e){return e?(n.length<l.getAllAccounts().length?(l.eventHandler.emitEvent(lf,So.Redirect,e),l.logger.verbose("handleRedirectResponse returned result, login success")):(l.eventHandler.emitEvent(hf,So.Redirect,e),l.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:Sk(e.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),l.eventHandler.emitEvent(vf,So.Redirect),e})).catch((function(e){var t=e;throw n.length>0?l.eventHandler.emitEvent(df,So.Redirect,null,t):l.eventHandler.emitEvent(ff,So.Redirect,null,t),l.eventHandler.emitEvent(vf,So.Redirect),a.end({success:!1},t),e})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"acquireTokenRedirect",value:(b=bk(sk().mark((function e(t){var n,r,o,i,a,c,u,s,l=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getRequestCorrelationId(t),this.logger.verbose("acquireTokenRedirect called",n),(r=this.performanceClient.startMeasurement(yo.AcquireTokenPreRedirect,n)).add({accountType:Sk(t.account),scenarioId:t.scenarioId}),(o=t.onRedirectNavigate)?t.onRedirectNavigate=function(e){var t="function"==typeof o?o(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t}:(i=this.config.auth.onRedirectNavigate,this.config.auth.onRedirectNavigate=function(e){var t="function"==typeof i?i(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t}),a=this.getAllAccounts().length>0,e.prev=7,af(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),a?this.eventHandler.emitEvent(pf,So.Redirect,t):this.eventHandler.emitEvent(sf,So.Redirect,t),this.nativeExtensionProvider&&this.canUseNative(t)?(u=new Em(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,zo,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),this.nativeInternalStorage,n),c=u.acquireTokenRedirect(t,r).catch((function(e){if(e instanceof Uy&&Ly(e))return l.nativeExtensionProvider=void 0,l.createRedirectClient(n).acquireToken(t);if(e instanceof Xs)return l.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),l.createRedirectClient(n).acquireToken(t);throw l.browserStorage.setInteractionInProgress(!1),e}))):(s=this.createRedirectClient(n),c=s.acquireToken(t)),e.next=14,c;case 14:return e.abrupt("return",e.sent);case 17:throw e.prev=17,e.t0=e.catch(7),r.end({success:!1},e.t0),a?this.eventHandler.emitEvent(df,So.Redirect,null,e.t0):this.eventHandler.emitEvent(ff,So.Redirect,null,e.t0),e.t0;case 22:case"end":return e.stop()}}),e,this,[[7,17]])}))),function(e){return b.apply(this,arguments)})},{key:"acquireTokenPopup",value:function(e){var t=this,n=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(yo.AcquireTokenPopup,n);r.add({scenarioId:e.scenarioId,accountType:Sk(e.account)});try{this.logger.verbose("acquireTokenPopup called",n),Ok(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(e){return Promise.reject(e)}var o,i=this.getAllAccounts();return i.length>0?this.eventHandler.emitEvent(pf,So.Popup,e):this.eventHandler.emitEvent(sf,So.Popup,e),o=this.canUseNative(e)?this.acquireTokenNative(ck(ck({},e),{},{correlationId:n}),Qo).then((function(e){return t.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,requestId:e.requestId,accountType:Sk(e.account)}),e})).catch((function(r){if(r instanceof Uy&&Ly(r))return t.nativeExtensionProvider=void 0,t.createPopupClient(n).acquireToken(e);if(r instanceof Xs)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(n).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),r})):this.createPopupClient(n).acquireToken(e),o.then((function(e){return i.length<t.getAllAccounts().length?t.eventHandler.emitEvent(lf,So.Popup,e):t.eventHandler.emitEvent(hf,So.Popup,e),r.end({success:!0,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Sk(e.account)}),e})).catch((function(e){return i.length>0?t.eventHandler.emitEvent(df,So.Popup,null,e):t.eventHandler.emitEvent(ff,So.Popup,null,e),r.end({success:!1},e),Promise.reject(e)}))}},{key:"trackPageVisibilityWithMeasurement",value:function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}},{key:"ssoSilent",value:(g=bk(sk().mark((function e(t){var n,r,o,i,a,c,u=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.getRequestCorrelationId(t),i=ck(ck({},t),{},{prompt:t.prompt,correlationId:o}),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(yo.SsoSilent,o),null===(n=this.ssoSilentMeasurement)||void 0===n||n.add({scenarioId:t.scenarioId,accountType:Sk(t.account)}),Ok(this.initialized,this.ssoSilentMeasurement),null===(r=this.ssoSilentMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",o),this.eventHandler.emitEvent("msal:ssoSilentStart",So.Silent,i),this.canUseNative(i)?a=this.acquireTokenNative(i,863).catch((function(e){if(e instanceof Uy&&Ly(e))return u.nativeExtensionProvider=void 0,u.createSilentIframeClient(i.correlationId).acquireToken(i);throw e})):(c=this.createSilentIframeClient(i.correlationId),a=c.acquireToken(i)),e.abrupt("return",a.then((function(e){var t;return u.eventHandler.emitEvent("msal:ssoSilentSuccess",So.Silent,e),null===(t=u.ssoSilentMeasurement)||void 0===t||t.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Sk(e.account)}),e})).catch((function(e){var t;throw u.eventHandler.emitEvent("msal:ssoSilentFailure",So.Silent,null,e),null===(t=u.ssoSilentMeasurement)||void 0===t||t.end({success:!1},e),e})).finally((function(){document.removeEventListener("visibilitychange",u.trackPageVisibilityWithMeasurement)})));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"acquireTokenByCode",value:(v=bk(sk().mark((function e(t){var n,r,o,i,a,c=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getRequestCorrelationId(t),this.logger.trace("acquireTokenByCode called",n),r=this.performanceClient.startMeasurement(yo.AcquireTokenByCode,n),Ok(this.initialized,r),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",So.Silent,t),r.add({scenarioId:t.scenarioId}),e.prev=6,!t.code||!t.nativeAccountId){e.next=11;break}throw ia(Bi);case 11:if(!t.code){e.next=20;break}return o=t.code,(i=this.hybridAuthCodeResponses.get(o))?(this.logger.verbose("Existing acquireTokenByCode request found",n),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",n),i=this.acquireTokenByCodeAsync(ck(ck({},t),{},{correlationId:n})).then((function(e){return c.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",So.Silent,e),c.hybridAuthCodeResponses.delete(o),r.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Sk(e.account)}),e})).catch((function(e){throw c.hybridAuthCodeResponses.delete(o),c.eventHandler.emitEvent(yf,So.Silent,null,e),r.end({success:!1},e),e})),this.hybridAuthCodeResponses.set(o,i)),e.next=17,i;case 17:return e.abrupt("return",e.sent);case 20:if(!t.nativeAccountId){e.next=32;break}if(!this.canUseNative(t,t.nativeAccountId)){e.next=29;break}return e.next=24,this.acquireTokenNative(ck(ck({},t),{},{correlationId:n}),866,t.nativeAccountId).catch((function(e){throw e instanceof Uy&&Ly(e)&&(c.nativeExtensionProvider=void 0),e}));case 24:return a=e.sent,r.end({accountType:Sk(a.account),success:!0}),e.abrupt("return",a);case 29:throw ia(Di);case 30:e.next=33;break;case 32:throw ia(Fi);case 33:e.next=40;break;case 35:throw e.prev=35,e.t0=e.catch(6),this.eventHandler.emitEvent(yf,So.Silent,null,e.t0),r.end({success:!1},e.t0),e.t0;case 40:case"end":return e.stop()}}),e,this,[[6,35]])}))),function(e){return v.apply(this,arguments)})},{key:"acquireTokenByCodeAsync",value:(y=bk(sk().mark((function e(t){var n,r,o,i=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.trace("acquireTokenByCodeAsync called",t.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(yo.AcquireTokenByCodeAsync,t.correlationId),null===(n=this.acquireTokenByCodeAsyncMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),r=this.createSilentAuthCodeClient(t.correlationId),e.next=7,r.acquireToken(t).then((function(e){var t;return null===(t=i.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=i.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!1},e),e})).finally((function(){document.removeEventListener("visibilitychange",i.trackPageVisibilityWithMeasurement)}));case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"acquireTokenFromCache",value:(d=bk(sk().mark((function e(t,n){var r;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.performanceClient.addQueueMeasurement(yo.AcquireTokenFromCache,t.correlationId),e.t0=n,e.next=0===e.t0||1===e.t0||2===e.t0?4:6;break;case 4:return r=this.createSilentCacheClient(t.correlationId),e.abrupt("return",ts(r.acquireToken.bind(r),yo.SilentCacheClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t));case 6:throw it(Fe);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"acquireTokenByRefreshToken",value:(h=bk(sk().mark((function e(t,n){var r;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.performanceClient.addQueueMeasurement(yo.AcquireTokenByRefreshToken,t.correlationId),e.t0=n,e.next=0===e.t0||2===e.t0||3===e.t0||4===e.t0?4:6;break;case 4:return r=this.createSilentRefreshClient(t.correlationId),e.abrupt("return",ts(r.acquireToken.bind(r),yo.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t));case 6:throw it(Fe);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"acquireTokenBySilentIframe",value:(p=bk(sk().mark((function e(t){var n;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.performanceClient.addQueueMeasurement(yo.AcquireTokenBySilentIframe,t.correlationId),n=this.createSilentIframeClient(t.correlationId),e.abrupt("return",ts(n.acquireToken.bind(n),yo.SilentIframeClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"logout",value:(f=bk(sk().mark((function e(t){var n;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getRequestCorrelationId(t),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",n),e.abrupt("return",this.logoutRedirect(ck({correlationId:n},t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"logoutRedirect",value:(l=bk(sk().mark((function e(t){var n,r;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getRequestCorrelationId(t),af(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),r=this.createRedirectClient(n),e.abrupt("return",r.logout(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"logoutPopup",value:function(e){try{var t=this.getRequestCorrelationId(e);return of(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}}},{key:"clearCache",value:(s=bk(sk().mark((function e(t){var n,r;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isBrowserEnvironment){e.next=3;break}return this.logger.info("in non-browser environment, returning early."),e.abrupt("return");case 3:return n=this.getRequestCorrelationId(t),r=this.createSilentCacheClient(n),e.abrupt("return",r.logout(t));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getAllAccounts",value:function(e){return Wl(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}},{key:"getAccount",value:function(e){return Yl(e,this.logger,this.browserStorage)}},{key:"getAccountByUsername",value:function(e){return Vl(e,this.logger,this.browserStorage)}},{key:"getAccountByHomeId",value:function(e){return Jl(e,this.logger,this.browserStorage)}},{key:"getAccountByLocalId",value:function(e){return Zl(e,this.logger,this.browserStorage)}},{key:"setActiveAccount",value:function(e){Xl(e,this.browserStorage)}},{key:"getActiveAccount",value:function(){return $l(this.browserStorage)}},{key:"hydrateCache",value:(u=bk(sk().mark((function e(t,n){var r;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.verbose("hydrateCache called"),r=Vn.createFromAccountInfo(t.account,t.cloudGraphHostName,t.msGraphHost),this.browserStorage.setAccount(r),!t.fromNativeBroker){e.next=8;break}return this.logger.verbose("Response was from native broker, storing in-memory"),e.abrupt("return",this.nativeInternalStorage.hydrateCache(t,n));case 8:return e.abrupt("return",this.browserStorage.hydrateCache(t,n));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"acquireTokenNative",value:(c=bk(sk().mark((function e(t,n,r){var o;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.trace("acquireTokenNative called"),this.nativeExtensionProvider){e.next=3;break}throw ia(Ki);case 3:return o=new Em(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,n,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId),e.abrupt("return",o.acquireToken(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"canUseNative",value:function(e,t){if(this.logger.trace("canUseNative called"),!zm.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case S.NONE:case S.CONSENT:case S.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = ".concat(e.prompt," is not compatible with native flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))}},{key:"getNativeAccountId",value:function(e){var t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}},{key:"createPopupClient",value:function(e){return new xg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}},{key:"createRedirectClient",value:function(e){return new yb(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}},{key:"createSilentIframeClient",value:function(e){return new rw(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}},{key:"createSilentCacheClient",value:function(e){return new nm(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}},{key:"createSilentRefreshClient",value:function(e){return new Tw(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}},{key:"createSilentAuthCodeClient",value:function(e){return new nk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.nativeExtensionProvider,e)}},{key:"addEventCallback",value:function(e,t){return this.eventHandler.addEventCallback(e,t)}},{key:"removeEventCallback",value:function(e){this.eventHandler.removeEventCallback(e)}},{key:"addPerformanceCallback",value:function(e){return nf(),this.performanceClient.addPerformanceCallback(e)}},{key:"removePerformanceCallback",value:function(e){return this.performanceClient.removePerformanceCallback(e)}},{key:"enableAccountStorageEvents",value:function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}},{key:"disableAccountStorageEvents",value:function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}},{key:"handleAccountCacheChange",value:function(e){try{var t;null!==(t=e.key)&&void 0!==t&&t.includes(m)&&this.eventHandler.emitEvent("msal:activeAccountChanged");var n=e.newValue||e.oldValue;if(!n)return;var r=JSON.parse(n);if("object"!==ik(r)||!Vn.isAccountEntity(r))return;var o=Dr.toObject(new Vn,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent("msal:accountAdded",void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent("msal:accountRemoved",void 0,o))}catch(e){return}}},{key:"getTokenCache",value:function(){return this.tokenCache}},{key:"getLogger",value:function(){return this.logger}},{key:"setLogger",value:function(e){this.logger=e}},{key:"initializeWrapperLibrary",value:function(e,t){this.browserStorage.setWrapperMetadata(e,t)}},{key:"setNavigationClient",value:function(e){this.navigationClient=e}},{key:"getConfiguration",value:function(){return this.config}},{key:"getPerformanceClient",value:function(){return this.performanceClient}},{key:"isBrowserEnv",value:function(){return this.isBrowserEnvironment}},{key:"getRequestCorrelationId",value:function(e){return null!=e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Bc():i.EMPTY_STRING}},{key:"loginRedirect",value:(a=bk(sk().mark((function e(t){var n;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",n),e.abrupt("return",this.acquireTokenRedirect(ck({correlationId:n},t||Wo)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loginPopup",value:function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(ck({correlationId:t},e||Wo))}},{key:"acquireTokenSilent",value:(o=bk(sk().mark((function e(t){var n,r,o,a,c,u,s,l=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getRequestCorrelationId(t),(r=this.performanceClient.startMeasurement(yo.AcquireTokenSilent,n)).add({cacheLookupPolicy:t.cacheLookupPolicy,scenarioId:t.scenarioId}),Ok(this.initialized,r),this.logger.verbose("acquireTokenSilent called",n),o=t.account||this.getActiveAccount()){e.next=8;break}throw ia(Si);case 8:if(r.add({accountType:Sk(o)}),a={clientId:this.config.auth.clientId,authority:t.authority||i.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:o.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,shrOptions:t.shrOptions},c=JSON.stringify(a),void 0!==(u=this.activeSilentTokenRequests.get(c))){e.next=28;break}return this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n),s=ts(this.acquireTokenSilentAsync.bind(this),yo.AcquireTokenSilentAsync,this.logger,this.performanceClient,n)(ck(ck({},t),{},{correlationId:n}),o).then((function(e){return l.activeSilentTokenRequests.delete(c),r.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),e})).catch((function(e){throw l.activeSilentTokenRequests.delete(c),r.end({success:!1},e),e})),this.activeSilentTokenRequests.set(c,s),e.t0=ck,e.t1=ck,e.t2={},e.next=21,s;case 21:return e.t3=e.sent,e.t4=(0,e.t1)(e.t2,e.t3),e.t5={},e.t6={state:t.state},e.abrupt("return",(0,e.t0)(e.t4,e.t5,e.t6));case 28:return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),r.discard(),e.t7=ck,e.t8=ck,e.t9={},e.next=35,u;case 35:return e.t10=e.sent,e.t11=(0,e.t8)(e.t9,e.t10),e.t12={},e.t13={state:t.state},e.abrupt("return",(0,e.t7)(e.t11,e.t12,e.t13));case 40:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"acquireTokenSilentAsync",value:(r=bk(sk().mark((function e(t,n){var r,o,i,a,c=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){return c.trackPageVisibility(t.correlationId)},this.performanceClient.addQueueMeasurement(yo.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(pf,So.Silent,t),t.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},t.correlationId),document.addEventListener("visibilitychange",r),e.next=7,ts(cy,yo.InitializeSilentRequest,this.logger,this.performanceClient,t.correlationId)(t,n,this.config,this.performanceClient,this.logger);case 7:return o=e.sent,i=t.cacheLookupPolicy||0,a=this.acquireTokenSilentNoIframe(o,i).catch(function(){var e=bk(sk().mark((function e(t){var n,r,a,u,s,l;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Tk(t,i)){e.next=30;break}if(c.activeIframeRequest){e.next=8;break}return c.activeIframeRequest=[new Promise((function(e){n=e})),o.correlationId],c.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),e.abrupt("return",ts(c.acquireTokenBySilentIframe.bind(c),yo.AcquireTokenBySilentIframe,c.logger,c.performanceClient,o.correlationId)(o).then((function(e){return n(!0),e})).catch((function(e){throw n(!1),e})).finally((function(){c.activeIframeRequest=void 0})));case 8:if(5===i){e.next=26;break}return r=rk(c.activeIframeRequest,2),a=r[0],u=r[1],c.logger.verbose("Iframe request is already in progress, awaiting resolution for request with correlationId: ".concat(u),o.correlationId),(s=c.performanceClient.startMeasurement(yo.AwaitConcurrentIframe,o.correlationId)).add({awaitIframeCorrelationId:u}),e.next=15,a;case 15:if(l=e.sent,s.end({success:l}),!l){e.next=22;break}return c.logger.verbose("Parallel iframe request with correlationId: ".concat(u," succeeded. Retrying cache and/or RT redemption"),o.correlationId),e.abrupt("return",c.acquireTokenSilentNoIframe(o,i));case 22:throw c.logger.info("Iframe request with correlationId: ".concat(u," failed. Interaction is required.")),t;case 24:e.next=28;break;case 26:return c.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),e.abrupt("return",ts(c.acquireTokenBySilentIframe.bind(c),yo.AcquireTokenBySilentIframe,c.logger,c.performanceClient,o.correlationId)(o));case 28:e.next=31;break;case 30:throw t;case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",a.then((function(e){return c.eventHandler.emitEvent(hf,So.Silent,e),t.correlationId&&c.performanceClient.addFields({fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId},t.correlationId),e})).catch((function(e){throw c.eventHandler.emitEvent(df,So.Silent,null,e),e})).finally((function(){document.removeEventListener("visibilitychange",r)})));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"acquireTokenSilentNoIframe",value:(n=bk(sk().mark((function e(t,n){var r=this;return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zm.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)||!t.account.nativeAccountId){e.next=5;break}return this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),e.abrupt("return",this.acquireTokenNative(t,61).catch(function(){var e=bk(sk().mark((function e(t){return sk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Uy&&Ly(t))){e.next=4;break}throw r.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),r.nativeExtensionProvider=void 0,it(Fe);case 4:throw t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),e.abrupt("return",ts(this.acquireTokenFromCache.bind(this),yo.AcquireTokenFromCache,this.logger,this.performanceClient,t.correlationId)(t,n).catch((function(e){if(1===n)throw e;return r.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",So.Silent,t),ts(r.acquireTokenByRefreshToken.bind(r),yo.AcquireTokenByRefreshToken,r.logger,r.performanceClient,t.correlationId)(t,n)})));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}],[{key:"createController",value:(t=bk(sk().mark((function t(n,r){var o;return sk().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new e(n),t.next=3,o.initialize(r);case 3:return t.abrupt("return",o);case 4:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)})}]);var t,n,r,o,a,c,u,s,l,f,p,h,d,y,v,g,b,w,k,O}();function Tk(e,t){var n=!(e instanceof Xs&&e.subError!==Ds),r=e.errorCode===To.INVALID_GRANT_ERROR||e.errorCode===Fe,o=n&&r||e.errorCode===Fs||e.errorCode===Hs,i=Zo.includes(t);return o&&i}function Ak(e){return Ak="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ak(e)}function Ik(){var e=Rk(),t=e.m(Ik),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,Pk(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ik=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Mk(e,t)},AsyncIterator:_k,async:function(e,t,n,o,a){return(r(t)?jk:Ek)(i(e),t,n,o,a)},keys:xk,values:Pk}})()}function Pk(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Ak(e)+" is not iterable")}function xk(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Ek(e,t,n,r,o){var i=jk(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function jk(e,t,n,r,o){return new _k(Rk().w(e,t,n,r),o||Promise)}function _k(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof Mk?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(Nk(_k.prototype),Nk(_k.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Nk(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function Rk(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Nk(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Nk(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Nk(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Nk(f,"constructor",s),Nk(s,"constructor",u),u.displayName="GeneratorFunction",Nk(s,o,"GeneratorFunction"),Nk(f),Nk(f,o,"Generator"),Nk(f,r,(function(){return this})),Nk(f,"toString",(function(){return"[object Generator]"})),(Rk=function(){return{w:i,m:p}})()}function Nk(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Nk=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Nk(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Nk(e,t,n,r)}function Mk(e,t){this.v=e,this.k=t}function qk(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Gk(e,t){return Fk.apply(this,arguments)}function Fk(){return(e=Ik().mark((function e(t,n){var r;return Ik().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Ja(t),e.next=3,r.initialize();case 3:return e.abrupt("return",Ck.createController(r,n));case 4:case"end":return e.stop()}}),e)})),Fk=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){qk(i,r,o,a,c,"next",e)}function c(e){qk(i,r,o,a,c,"throw",e)}a(void 0)}))}).apply(this,arguments);var e}var Bk="NESTED_APP_AUTH_UNAVAILABLE";function Hk(e){return Hk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hk(e)}function Dk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Uk(r.key),r)}}function Uk(e){var t=function(e){if("object"!=Hk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Hk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Hk(t)?t:t+""}var Lk=function(){return function(e,t){return t&&Dk(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientId=t,this.clientCapabilities=n,this.crypto=r,this.logger=o}),[{key:"toNaaTokenRequest",value:function(e){var t,n;n=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));var r=(new pp).addClientCapabilitiesToClaims(e.claims,this.clientCapabilities),o=e.scopes||a;return{platformBrokerId:null===(t=e.account)||void 0===t?void 0:t.homeAccountId,clientId:this.clientId,authority:e.authority,scope:o.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:this.crypto.createNewGuid(),claims:In.isEmptyObj(r)?void 0:r,state:e.state,authenticationScheme:e.authenticationScheme||G.BEARER,extraParameters:n}}},{key:"fromNaaTokenResponse",value:function(e,t,n){if(!t.token.id_token||!t.token.access_token)throw it(se);var r=new Date(1e3*(n+(t.token.expires_in||0))),o=kt(t.token.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,t.token.id_token,o),a=t.token.scope||e.scope;return{authority:t.token.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:a.split(" "),account:i,idToken:t.token.id_token,idTokenClaims:o,accessToken:t.token.access_token,fromCache:!1,expiresOn:r,tokenType:e.authenticationScheme||G.BEARER,correlationId:e.correlationId,extExpiresOn:r,state:e.state}}},{key:"fromNaaAccountInfo",value:function(e,t,n){var r=n||e.idTokenClaims,o=e.localAccountId||(null==r?void 0:r.oid)||(null==r?void 0:r.sub)||"",i=e.tenantId||(null==r?void 0:r.tid)||"",a=e.homeAccountId||"".concat(o,".").concat(i),c=e.username||(null==r?void 0:r.preferred_username)||"",u=e.name||(null==r?void 0:r.name),s=new Map,l=Ln(a,o,i,r);return s.set(i,l),{homeAccountId:a,environment:e.environment,tenantId:i,username:c,localAccountId:o,name:u,idToken:t,idTokenClaims:r,tenantProfiles:s}}},{key:"fromBridgeError",value:function(e){if(!function(e){return void 0!==e.status}(e))return new re("unknown_error","An unknown error occurred");switch(e.status){case"USER_CANCEL":return new ot(Qe);case"NO_NETWORK":return new ot(ze);case"ACCOUNT_UNAVAILABLE":return new ot(Re);case"DISABLED":return new ot(Ve);case Bk:return new ot(e.code||Ve,e.description);case"TRANSIENT_ERROR":case"PERSISTENT_ERROR":return new _f(e.code,e.description);case"USER_INTERACTION_REQUIRED":return new Xs(e.code,e.description);default:return new re(e.code,e.description)}}},{key:"toAuthenticationResultFromCache",value:function(e,t,n,r,o){if(!t||!n)throw it(se);var i=kt(t.secret,this.crypto.base64Decode),a=n.target||r.scopes.join(" ");return{authority:n.environment||e.environment,uniqueId:e.localAccountId,tenantId:e.tenantId,scopes:a.split(" "),account:e,idToken:t.secret,idTokenClaims:i||{},accessToken:n.secret,fromCache:!0,expiresOn:new Date(1e3*Number(n.expiresOn)),tokenType:r.authenticationScheme||G.BEARER,correlationId:o,extExpiresOn:new Date(1e3*Number(n.extendedExpiresOn)),state:r.state}}}])}();function Kk(e){return Kk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kk(e)}function zk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qk(r.key),r)}}function Qk(e){var t=function(e){if("object"!=Kk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Kk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Kk(t)?t:t+""}function Wk(e,t,n){return t=Vk(t),function(e,t){if(t&&("object"==Kk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Yk()?Reflect.construct(t,n||[],Vk(e).constructor):t.apply(e,n))}function Yk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Yk=function(){return!!e})()}function Vk(e){return Vk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vk(e)}function Jk(e,t){return Jk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jk(e,t)}var Zk="unsupported_method",Xk="This method is not supported in nested app environment.",$k=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=Wk(this,t,[e,n]),Object.setPrototypeOf(r,t.prototype),r.name="NestedAppAuthError",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jk(e,t)}(t,e),function(e,t,n){return n&&zk(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,0,[{key:"createUnsupportedError",value:function(){return new t(Zk,Xk)}}])}(re);function eS(e){return eS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eS(e)}function tS(e){return function(e){if(Array.isArray(e))return nS(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return nS(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nS(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function rS(){var e=sS(),t=e.m(rS),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,oS(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(rS=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new fS(e,t)},AsyncIterator:uS,async:function(e,t,n,o,a){return(r(t)?cS:aS)(i(e),t,n,o,a)},keys:iS,values:oS}})()}function oS(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(eS(e)+" is not iterable")}function iS(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function aS(e,t,n,r,o){var i=cS(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function cS(e,t,n,r,o){return new uS(sS().w(e,t,n,r),o||Promise)}function uS(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof fS?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(lS(uS.prototype),lS(uS.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),lS(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function sS(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return lS(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(lS(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,lS(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,lS(f,"constructor",s),lS(s,"constructor",u),u.displayName="GeneratorFunction",lS(s,o,"GeneratorFunction"),lS(f),lS(f,o,"Generator"),lS(f,r,(function(){return this})),lS(f,"toString",(function(){return"[object Generator]"})),(sS=function(){return{w:i,m:p}})()}function lS(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}lS=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){lS(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},lS(e,t,n,r)}function fS(e,t){this.v=e,this.k=t}function pS(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function hS(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){pS(i,r,o,a,c,"next",e)}function c(e){pS(i,r,o,a,c,"throw",e)}a(void 0)}))}}function dS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dS(Object(n),!0).forEach((function(t){vS(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vS(e,t,n){return(t=gS(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gS(r.key),r)}}function gS(e){var t=function(e){if("object"!=eS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=eS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==eS(t)?t:t+""}var bS=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.operatingContext=t;var n=this.operatingContext.getBridgeProxy();if(void 0===n)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=n,this.config=t.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=t.isBrowserEnvironment()?new Wu(this.logger,this.performanceClient):gt,this.browserStorage=this.operatingContext.isBrowserEnvironment()?new zl(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,Gs(this.config.auth)):Ql(this.config.auth.clientId,this.logger),this.eventHandler=new Af(this.logger),this.nestedAppAuthAdapter=new Lk(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger);var r=this.bridgeProxy.getAccountContext();r&&Xl(Yl(r,this.logger,this.browserStorage),this.browserStorage)}return function(e,t,n){return t&&mS(e.prototype,t),n&&mS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(e,[{key:"initialize",value:function(){return Promise.resolve()}},{key:"ensureValidRequest",value:function(e){return null!=e&&e.correlationId?e:yS(yS({},e),{},{correlationId:this.browserCrypto.createNewGuid()})}},{key:"acquireTokenInteractive",value:(l=hS(rS().mark((function e(t){var n,r,o,i,a,c,u;return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureValidRequest(t),this.eventHandler.emitEvent(pf,So.Popup,n),null==(r=this.performanceClient.startMeasurement(yo.AcquireTokenPopup,n.correlationId))||r.add({nestedAppAuthRequest:!0}),e.prev=4,o=this.nestedAppAuthAdapter.toNaaTokenRequest(n),i=Ot(),e.next=9,this.bridgeProxy.getTokenInteractive(o);case 9:return a=e.sent,c=yS({},this.nestedAppAuthAdapter.fromNaaTokenResponse(o,a,i)),e.next=13,this.hydrateCache(c,t);case 13:return this.browserStorage.setActiveAccount(c.account),this.eventHandler.emitEvent(hf,So.Popup,c),r.add({accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),r.end({success:!0,requestId:c.requestId}),e.abrupt("return",c);case 20:throw e.prev=20,e.t0=e.catch(4),u=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(df,So.Popup,null,e.t0),r.end({success:!1},e.t0),u;case 26:case"end":return e.stop()}}),e,this,[[4,20]])}))),function(e){return l.apply(this,arguments)})},{key:"acquireTokenSilentInternal",value:(s=hS(rS().mark((function e(t){var n,r,o,i,a,c,u,s;return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureValidRequest(t),this.eventHandler.emitEvent(pf,So.Silent,n),e.next=4,this.acquireTokenFromCache(n);case 4:if(!(r=e.sent)){e.next=8;break}return this.eventHandler.emitEvent(hf,So.Silent,r),e.abrupt("return",r);case 8:return null==(o=this.performanceClient.startMeasurement(yo.SsoSilent,n.correlationId))||o.increment({visibilityChangeCount:0}),null==o||o.add({nestedAppAuthRequest:!0}),e.prev=11,i=this.nestedAppAuthAdapter.toNaaTokenRequest(n),a=Ot(),e.next=16,this.bridgeProxy.getTokenSilent(i);case 16:return c=e.sent,u=this.nestedAppAuthAdapter.fromNaaTokenResponse(i,c,a),e.next=20,this.hydrateCache(u,t);case 20:return this.browserStorage.setActiveAccount(u.account),this.eventHandler.emitEvent(hf,So.Silent,u),null==o||o.add({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),null==o||o.end({success:!0,requestId:u.requestId}),e.abrupt("return",u);case 27:throw e.prev=27,e.t0=e.catch(11),s=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(df,So.Silent,null,e.t0),null==o||o.end({success:!1},e.t0),s;case 33:case"end":return e.stop()}}),e,this,[[11,27]])}))),function(e){return s.apply(this,arguments)})},{key:"acquireTokenFromCache",value:(u=hS(rS().mark((function e(t){var n,r,o,i;return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=this.performanceClient.startMeasurement(yo.AcquireTokenSilent,t.correlationId))||n.add({nestedAppAuthRequest:!0}),!t.claims){e.next=5;break}return this.logger.verbose("Claims are present in the request, skipping cache lookup"),e.abrupt("return",null);case 5:r=null,e.t0=t.cacheLookupPolicy,e.next=0===e.t0||1===e.t0||2===e.t0?9:13;break;case 9:return e.next=11,this.acquireTokenFromCacheInternal(t);case 11:return r=e.sent,e.abrupt("break",14);case 13:return e.abrupt("return",null);case 14:if(!r){e.next=19;break}return this.eventHandler.emitEvent(hf,So.Silent,r),null==n||n.add({accessTokenSize:null===(o=r)||void 0===o?void 0:o.accessToken.length,idTokenSize:null===(i=r)||void 0===i?void 0:i.idToken.length}),null==n||n.end({success:!0}),e.abrupt("return",r);case 19:return this.logger.error("Cached tokens are not found for the account, proceeding with silent token request."),this.eventHandler.emitEvent(df,So.Silent,null),null==n||n.end({success:!1}),e.abrupt("return",null);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"acquireTokenFromCacheInternal",value:(c=hS(rS().mark((function e(t){var n,r,o,i,c,u,s,l;return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.bridgeProxy.getAccountContext(),o=null,r&&(i=Yl(r,this.logger,this.browserStorage),o=i||t.account),o){e.next=6;break}return this.logger.verbose("No active account found, falling back to the host"),e.abrupt("return",Promise.resolve(null));case 6:if(this.logger.verbose("active account found, attempting to acquire token silently"),c=yS(yS({},t),{},{correlationId:t.correlationId||this.browserCrypto.createNewGuid(),authority:t.authority||o.environment,scopes:null!==(n=t.scopes)&&void 0!==n&&n.length?t.scopes:tS(a)}),u=this.browserStorage.getTokenKeys(),s=this.browserStorage.getAccessToken(o,c,u,o.tenantId,this.performanceClient,c.correlationId)){e.next=15;break}return this.logger.verbose("No cached access token found"),e.abrupt("return",Promise.resolve(null));case 15:if(!Tt(s.cachedAt)&&!Ct(s.expiresOn,this.config.system.tokenRenewalOffsetSeconds)){e.next=18;break}return this.logger.verbose("Cached access token has expired"),e.abrupt("return",Promise.resolve(null));case 18:if(l=this.browserStorage.getIdToken(o,u,o.tenantId,this.performanceClient,c.correlationId)){e.next=22;break}return this.logger.verbose("No cached id token found"),e.abrupt("return",Promise.resolve(null));case 22:return e.abrupt("return",this.nestedAppAuthAdapter.toAuthenticationResultFromCache(o,l,s,c,c.correlationId));case 23:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"acquireTokenPopup",value:(i=hS(rS().mark((function e(t){return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenInteractive(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"acquireTokenRedirect",value:function(e){throw $k.createUnsupportedError()}},{key:"acquireTokenSilent",value:(o=hS(rS().mark((function e(t){return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenSilentInternal(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"acquireTokenByCode",value:function(e){throw $k.createUnsupportedError()}},{key:"acquireTokenNative",value:function(e,t,n){throw $k.createUnsupportedError()}},{key:"acquireTokenByRefreshToken",value:function(e,t){throw $k.createUnsupportedError()}},{key:"addEventCallback",value:function(e,t){return this.eventHandler.addEventCallback(e,t)}},{key:"removeEventCallback",value:function(e){this.eventHandler.removeEventCallback(e)}},{key:"addPerformanceCallback",value:function(e){throw $k.createUnsupportedError()}},{key:"removePerformanceCallback",value:function(e){throw $k.createUnsupportedError()}},{key:"enableAccountStorageEvents",value:function(){throw $k.createUnsupportedError()}},{key:"disableAccountStorageEvents",value:function(){throw $k.createUnsupportedError()}},{key:"getAllAccounts",value:function(e){return Wl(this.logger,this.browserStorage,this.isBrowserEnv(),e)}},{key:"getAccount",value:function(e){return Yl(e,this.logger,this.browserStorage)}},{key:"getAccountByUsername",value:function(e){return Vl(e,this.logger,this.browserStorage)}},{key:"getAccountByHomeId",value:function(e){return Jl(e,this.logger,this.browserStorage)}},{key:"getAccountByLocalId",value:function(e){return Zl(e,this.logger,this.browserStorage)}},{key:"setActiveAccount",value:function(e){return Xl(e,this.browserStorage)}},{key:"getActiveAccount",value:function(){return $l(this.browserStorage)}},{key:"handleRedirectPromise",value:function(e){return Promise.resolve(null)}},{key:"loginPopup",value:function(e){return this.acquireTokenInteractive(e||Wo)}},{key:"loginRedirect",value:function(e){throw $k.createUnsupportedError()}},{key:"logout",value:function(e){throw $k.createUnsupportedError()}},{key:"logoutRedirect",value:function(e){throw $k.createUnsupportedError()}},{key:"logoutPopup",value:function(e){throw $k.createUnsupportedError()}},{key:"ssoSilent",value:function(e){return this.acquireTokenSilentInternal(e)}},{key:"getTokenCache",value:function(){throw $k.createUnsupportedError()}},{key:"getLogger",value:function(){return this.logger}},{key:"setLogger",value:function(e){this.logger=e}},{key:"initializeWrapperLibrary",value:function(e,t){}},{key:"setNavigationClient",value:function(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}},{key:"getConfiguration",value:function(){return this.config}},{key:"isBrowserEnv",value:function(){return this.operatingContext.isBrowserEnvironment()}},{key:"getBrowserCrypto",value:function(){return this.browserCrypto}},{key:"getPerformanceClient",value:function(){throw $k.createUnsupportedError()}},{key:"getRedirectResponse",value:function(){throw $k.createUnsupportedError()}},{key:"clearCache",value:(r=hS(rS().mark((function e(t){return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw $k.createUnsupportedError();case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"hydrateCache",value:(n=hS(rS().mark((function e(t,n){var r;return rS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.verbose("hydrateCache called"),r=Vn.createFromAccountInfo(t.account,t.cloudGraphHostName,t.msGraphHost),this.browserStorage.setAccount(r),e.abrupt("return",this.browserStorage.hydrateCache(t,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}],[{key:"createController",value:(t=hS(rS().mark((function t(n){var r;return rS().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(n),t.abrupt("return",Promise.resolve(r));case 2:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,n,r,o,i,c,u,s,l}();function wS(e){return wS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wS(e)}function kS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SS(e,t,n){return(t=MS(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OS(){var e=xS(),t=e.m(OS),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,CS(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(OS=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new jS(e,t)},AsyncIterator:PS,async:function(e,t,n,o,a){return(r(t)?IS:AS)(i(e),t,n,o,a)},keys:TS,values:CS}})()}function CS(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(wS(e)+" is not iterable")}function TS(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function AS(e,t,n,r,o){var i=IS(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function IS(e,t,n,r,o){return new PS(xS().w(e,t,n,r),o||Promise)}function PS(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof jS?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(ES(PS.prototype),ES(PS.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ES(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function xS(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ES(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ES(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ES(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ES(f,"constructor",s),ES(s,"constructor",u),u.displayName="GeneratorFunction",ES(s,o,"GeneratorFunction"),ES(f),ES(f,o,"Generator"),ES(f,r,(function(){return this})),ES(f,"toString",(function(){return"[object Generator]"})),(xS=function(){return{w:i,m:p}})()}function ES(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ES=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){ES(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},ES(e,t,n,r)}function jS(e,t){this.v=e,this.k=t}function _S(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function RS(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){_S(i,r,o,a,c,"next",e)}function c(e){_S(i,r,o,a,c,"throw",e)}a(void 0)}))}}function NS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,MS(r.key),r)}}function MS(e){var t=function(e){if("object"!=wS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=wS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wS(t)?t:t+""}var qS=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkName=t,this.sdkVersion=n,this.accountContext=r,this.capabilities=o}return function(e,t,n){return t&&NS(e.prototype,t),n&&NS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(e,[{key:"getTokenInteractive",value:function(e){return this.getToken("GetTokenPopup",e)}},{key:"getTokenSilent",value:function(e){return this.getToken("GetToken",e)}},{key:"getToken",value:(r=RS(OS().mark((function t(n,r){var o;return OS().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequest(n,{tokenParams:r});case 2:return o=t.sent,t.abrupt("return",{token:e.validateBridgeResultOrThrow(o.token),account:e.validateBridgeResultOrThrow(o.account)});case 4:case"end":return t.stop()}}),t,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"getHostCapabilities",value:function(){var e;return null!==(e=this.capabilities)&&void 0!==e?e:null}},{key:"getAccountContext",value:function(){return this.accountContext?this.accountContext:null}},{key:"sendRequest",value:function(t,n){var r=e.buildRequest(t,n);return new Promise((function(t,n){var o={requestId:r.requestId,method:r.method,resolve:t,reject:n};e.bridgeRequests.push(o),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))}))}}],[{key:"initializeNestedAppAuthBridge",value:(n=RS(OS().mark((function t(){var n;return OS().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==window){t.next=2;break}throw new Error("window is undefined");case 2:if(void 0!==window.nestedAppAuthBridge){t.next=4;break}throw new Error("window.nestedAppAuthBridge is undefined");case 4:return t.prev=4,window.nestedAppAuthBridge.addEventListener("message",(function(t){var n="string"==typeof t?t:t.data,r=JSON.parse(n),o=e.bridgeRequests.find((function(e){return e.requestId===r.requestId}));void 0!==o&&(e.bridgeRequests.splice(e.bridgeRequests.indexOf(o),1),r.success?o.resolve(r):o.reject(r.error))})),t.next=8,new Promise((function(t,n){var r=e.buildRequest("GetInitContext"),o={requestId:r.requestId,method:r.method,resolve:t,reject:n};e.bridgeRequests.push(o),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))}));case 8:return n=t.sent,t.abrupt("return",e.validateBridgeResultOrThrow(n.initContext));case 12:throw t.prev=12,t.t0=t.catch(4),window.console.log(t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[4,12]])}))),function(){return n.apply(this,arguments)})},{key:"buildRequest",value:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kS(Object(n),!0).forEach((function(t){SS(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({messageType:"NestedAppAuthRequest",method:e,requestId:Bc(),sendTime:Date.now(),clientLibrary:To.MSAL_SKU,clientLibraryVersion:Aa},t)}},{key:"validateBridgeResultOrThrow",value:function(e){if(void 0===e)throw{status:Bk};return e}},{key:"create",value:(t=RS(OS().mark((function t(){var n;return OS().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initializeNestedAppAuthBridge();case 2:return n=t.sent,t.abrupt("return",new e(n.sdkName,n.sdkVersion,n.accountContext,n.capabilities));case 4:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}]);var t,n,r}();function GS(e){return GS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GS(e)}function FS(){var e=KS(),t=e.m(FS),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,BS(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(FS=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new QS(e,t)},AsyncIterator:LS,async:function(e,t,n,o,a){return(r(t)?US:DS)(i(e),t,n,o,a)},keys:HS,values:BS}})()}function BS(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(GS(e)+" is not iterable")}function HS(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function DS(e,t,n,r,o){var i=US(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function US(e,t,n,r,o){return new LS(KS().w(e,t,n,r),o||Promise)}function LS(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof QS?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(zS(LS.prototype),zS(LS.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),zS(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function KS(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return zS(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(zS(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,zS(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,zS(f,"constructor",s),zS(s,"constructor",u),u.displayName="GeneratorFunction",zS(s,o,"GeneratorFunction"),zS(f),zS(f,o,"Generator"),zS(f,r,(function(){return this})),zS(f,"toString",(function(){return"[object Generator]"})),(KS=function(){return{w:i,m:p}})()}function zS(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}zS=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){zS(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},zS(e,t,n,r)}function QS(e,t){this.v=e,this.k=t}function WS(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function YS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,VS(r.key),r)}}function VS(e){var t=function(e){if("object"!=GS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=GS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==GS(t)?t:t+""}function JS(e,t,n){return t=XS(t),function(e,t){if(t&&("object"==GS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ZS()?Reflect.construct(t,n||[],XS(e).constructor):t.apply(e,n))}function ZS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ZS=function(){return!!e})()}function XS(e){return XS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},XS(e)}function $S(e,t){return $S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$S(e,t)}qS.bridgeRequests=[];var eO=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=JS(this,t,arguments)).bridgeProxy=void 0,e.accountContext=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$S(e,t)}(t,e),function(e,t){return t&&YS(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"getModuleName",value:function(){return t.MODULE_NAME}},{key:"getId",value:function(){return t.ID}},{key:"getBridgeProxy",value:function(){return this.bridgeProxy}},{key:"initialize",value:(n=FS().mark((function e(){var t;return FS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"undefined"==typeof window){e.next=11;break}if("function"!=typeof window.__initializeNestedAppAuth){e.next=5;break}return e.next=5,window.__initializeNestedAppAuth();case 5:return e.next=7,qS.create();case 7:t=e.sent,this.accountContext=t.getAccountContext(),this.bridgeProxy=t,this.available=void 0!==t;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),this.logger.infoPii("Could not initialize Nested App Auth bridge (".concat(e.t0,")"));case 16:return this.logger.info("Nested App Auth Bridge available: ".concat(this.available)),e.abrupt("return",this.available);case 18:case"end":return e.stop()}}),e,this,[[0,13]])})),r=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){WS(i,r,o,a,c,"next",e)}function c(e){WS(i,r,o,a,c,"throw",e)}a(void 0)}))},function(){return r.apply(this,arguments)})}]);var n,r}(_a);function tO(e){return tO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tO(e)}function nO(){var e=uO(),t=e.m(nO),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,rO(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(nO=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new lO(e,t)},AsyncIterator:cO,async:function(e,t,n,o,a){return(r(t)?aO:iO)(i(e),t,n,o,a)},keys:oO,values:rO}})()}function rO(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(tO(e)+" is not iterable")}function oO(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function iO(e,t,n,r,o){var i=aO(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function aO(e,t,n,r,o){return new cO(uO().w(e,t,n,r),o||Promise)}function cO(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof lO?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(sO(cO.prototype),sO(cO.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),sO(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function uO(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return sO(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(sO(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,sO(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,sO(f,"constructor",s),sO(s,"constructor",u),u.displayName="GeneratorFunction",sO(s,o,"GeneratorFunction"),sO(f),sO(f,o,"Generator"),sO(f,r,(function(){return this})),sO(f,"toString",(function(){return"[object Generator]"})),(uO=function(){return{w:i,m:p}})()}function sO(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}sO=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){sO(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},sO(e,t,n,r)}function lO(e,t){this.v=e,this.k=t}function fO(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function pO(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){fO(i,r,o,a,c,"next",e)}function c(e){fO(i,r,o,a,c,"throw",e)}a(void 0)}))}}function hO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dO(r.key),r)}}function dO(e){var t=function(e){if("object"!=tO(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=tO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==tO(t)?t:t+""}eO.MODULE_NAME="",eO.ID="NestedAppOperatingContext";var yO=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=n||new Ck(new Ja(t))}return function(e,t,n){return t&&hO(e.prototype,t),n&&hO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(e,[{key:"initialize",value:(o=pO(nO().mark((function e(t){return nO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.controller.initialize(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"acquireTokenPopup",value:(r=pO(nO().mark((function e(t){return nO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.controller.acquireTokenPopup(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"acquireTokenRedirect",value:function(e){return this.controller.acquireTokenRedirect(e)}},{key:"acquireTokenSilent",value:function(e){return this.controller.acquireTokenSilent(e)}},{key:"acquireTokenByCode",value:function(e){return this.controller.acquireTokenByCode(e)}},{key:"addEventCallback",value:function(e,t){return this.controller.addEventCallback(e,t)}},{key:"removeEventCallback",value:function(e){return this.controller.removeEventCallback(e)}},{key:"addPerformanceCallback",value:function(e){return this.controller.addPerformanceCallback(e)}},{key:"removePerformanceCallback",value:function(e){return this.controller.removePerformanceCallback(e)}},{key:"enableAccountStorageEvents",value:function(){this.controller.enableAccountStorageEvents()}},{key:"disableAccountStorageEvents",value:function(){this.controller.disableAccountStorageEvents()}},{key:"getAccount",value:function(e){return this.controller.getAccount(e)}},{key:"getAccountByHomeId",value:function(e){return this.controller.getAccountByHomeId(e)}},{key:"getAccountByLocalId",value:function(e){return this.controller.getAccountByLocalId(e)}},{key:"getAccountByUsername",value:function(e){return this.controller.getAccountByUsername(e)}},{key:"getAllAccounts",value:function(e){return this.controller.getAllAccounts(e)}},{key:"handleRedirectPromise",value:function(e){return this.controller.handleRedirectPromise(e)}},{key:"loginPopup",value:function(e){return this.controller.loginPopup(e)}},{key:"loginRedirect",value:function(e){return this.controller.loginRedirect(e)}},{key:"logout",value:function(e){return this.controller.logout(e)}},{key:"logoutRedirect",value:function(e){return this.controller.logoutRedirect(e)}},{key:"logoutPopup",value:function(e){return this.controller.logoutPopup(e)}},{key:"ssoSilent",value:function(e){return this.controller.ssoSilent(e)}},{key:"getTokenCache",value:function(){return this.controller.getTokenCache()}},{key:"getLogger",value:function(){return this.controller.getLogger()}},{key:"setLogger",value:function(e){this.controller.setLogger(e)}},{key:"setActiveAccount",value:function(e){this.controller.setActiveAccount(e)}},{key:"getActiveAccount",value:function(){return this.controller.getActiveAccount()}},{key:"initializeWrapperLibrary",value:function(e,t){return this.controller.initializeWrapperLibrary(e,t)}},{key:"setNavigationClient",value:function(e){this.controller.setNavigationClient(e)}},{key:"getConfiguration",value:function(){return this.controller.getConfiguration()}},{key:"hydrateCache",value:(n=pO(nO().mark((function e(t,n){return nO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.controller.hydrateCache(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"clearCache",value:function(e){return this.controller.clearCache(e)}}],[{key:"createPublicClientApplication",value:(t=pO(nO().mark((function t(n){var r,o;return nO().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Gk(n);case 2:return r=t.sent,o=new e(n,r),t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,n,r,o}();function vO(e){return mO.apply(this,arguments)}function mO(){return(mO=pO(nO().mark((function e(t){var n,r;return nO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new eO(t),e.next=3,n.initialize();case 3:if(!n.isAvailable()){e.next=6;break}return r=new bS(n),e.abrupt("return",new yO(t,r));case 6:return e.abrupt("return",gO(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gO(e){return bO.apply(this,arguments)}function bO(){return bO=pO(nO().mark((function e(t){var n;return nO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new yO(t),e.next=3,n.initialize();case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),bO.apply(this,arguments)}function wO(e){var t=e||{},n=t.firstName,r=void 0===n?"":n,o=t.lastName,i=void 0===o?"":o,a=t.email,c=void 0===a?"":a,u=t.phone,s=void 0===u?"":u,l=t.jobTitle,f=void 0===l?"":l,p=t.team,h=void 0===p?"":p,d=t.office,y=void 0===d?"":d;return'\n\n\x3c!--[if mso]>\n<style>\n  /* Outlook (Word)  wycz podkrelenia i wymu kolor */\n  #akmf-sig a,\n  #akmf-sig span.MsoHyperlink,\n  #akmf-sig span.MsoHyperlinkFollowed {\n    text-decoration: none !important;\n    color: #000000 !important;\n    border: none !important;\n  }\n</style>\n<![endif]--\x3e\n<style>\n  /* iOS/macOS Mail  nie maluj auto-linkw na niebiesko */\n  #akmf-sig a[x-apple-data-detectors]{\n    color: inherit !important;\n    text-decoration: none !important;\n    border-bottom: 0 !important;\n  }\n</style>\n\x3c!--[if mso]>\n<style>\n  /* Word/Outlook  zamie Poppins na Segoe UI/Arial */\n  .use-poppins { font-family: \'Segoe UI\', Arial, Helvetica, sans-serif !important; }\n</style>\n<![endif]--\x3e\n<div id="akmf-sig" class="use-poppins" style="font-family:\'Poppins\',\'Segoe UI\',Arial,Helvetica,sans-serif;">\n  \x3c!-- JEDNA TABELA NA CA STOPK --\x3e\n  <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%"\n         style="mso-table-lspace:0;mso-table-rspace:0;">\n    <tr>\n      <td align="left" style="padding:0;">\n\n        \x3c!-- Szeroko logiczna 600px (skalowanie do 100%) --\x3e\n        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="600"\n               style="width:600px;max-width:100%;mso-table-lspace:0;mso-table-rspace:0;">\n          \x3c!-- Imi i nazwisko --\x3e\n          <tr>\n            <td style="padding:0 0 0 0; font-size:14pt; line-height:1.5; font-weight:700;display:block; text-decoration:none; text-underline:none;\n            color:#000000 !important; border:0; outline:0;\n            -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n            mso-line-height-rule:exactly; font-family:\'Poppins\',Arial,Helvetica,sans-serif; ">\n              '.concat(r," ").concat(i,"\n            </td>\n          </tr>\n\n          \x3c!-- Stanowisko --\x3e\n          <tr>\n            <td style=\"padding:0; font-size:8pt; line-height:1.5;display:block; text-decoration:none; text-underline:none;\n            color:#000000 !important; border:0; outline:0;\n            -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n            mso-line-height-rule:exactly; font-family:'Poppins',Arial,Helvetica,sans-serif;\">\n              ").concat(f,"\n          </tr>\n\n          \x3c!-- Zesp --\x3e\n          <tr>\n            <td style=\"padding:0; font-size:8pt; line-height:1.5;display:block; text-decoration:none; text-underline:none;\n            color:#000000 !important; border:0; outline:0;\n            -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n            mso-line-height-rule:exactly; font-family:'Poppins',Arial,Helvetica,sans-serif;\">\n              ").concat(h,"\n            </td>\n          </tr>\n\n          \x3c!-- Departament --\x3e\n          <tr>\n            <td style=\"padding:0; font-size:8pt; line-height:1.5;display:block; text-decoration:none; text-underline:none;\n            color:#000000 !important; border:0; outline:0;\n            -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n            mso-line-height-rule:exactly; font-family:'Poppins',Arial,Helvetica,sans-serif;\">\n              ").concat(y,'\n            </td>\n          </tr>\n\n          \x3c!-- odstp --\x3e\n          <tr><td style="height:10pt; line-height:10pt; font-size:0;">&nbsp;</td></tr>\n\n          \x3c!-- Telefon --\x3e\n          <tr>\n            <td style="padding:0; font-size:12pt; line-height:1.5;">\n              <a href="tel:').concat(s,'" x-apple-data-detectors="true"\n                 style="display:block; text-decoration:none; text-underline:none;\n                        color:#000000 !important; border:0; outline:0;\n                        -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n                        mso-line-height-rule:exactly; font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n                <b style="font-weight:700; color:#000000 !important; text-decoration:none !important;">\n                  <font color="#000000" style="text-decoration:none; font-weight:700;">\n                    ').concat(s,'\n                  </font>\n                </b>\n              </a>\n            </td>\n          </tr>\n\n          \x3c!-- E-mail --\x3e\n          <tr>\n            <td style="padding:0; font-size:12pt; line-height:1.5;">\n              <a href="mailto:').concat(c,'" x-apple-data-detectors="true"\n                 style="display:block; text-decoration:none; text-underline:none;\n                        color:#000000 !important; border:0; outline:0;\n                        -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n                        mso-line-height-rule:exactly; font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n                <b style="font-weight:700; color:#000000 !important; text-decoration:none !important;">\n                  <font color="#000000" style="text-decoration:none; font-weight:700;">\n                    ').concat(c,'\n                  </font>\n                </b>\n              </a>\n            </td>\n          </tr>\n\n          \x3c!-- odstp --\x3e\n          <tr><td style="height:8pt; line-height:8pt; font-size:0;">&nbsp;</td></tr>\n\n          \x3c!-- Firma --\x3e\n          <tr>\n            <td style="padding:0; font-size:8pt; line-height:1.5;display:block; text-decoration:none; text-underline:none;\n            color:#000000 !important; border:0; outline:0;\n            -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n            mso-line-height-rule:exactly; font-family:\'Poppins\',Arial,Helvetica,sans-serif;">\n              Aplikacje Krytyczne Sp. z o.o.\n            </td>\n          </tr>\n\n          \x3c!-- Adres --\x3e\n          <tr>\n            <td style="padding:0; font-size:8pt; line-height:1.5;display:block; text-decoration:none; text-underline:none;\n            color:#000000 !important; border:0; outline:0;\n            -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;\n            mso-line-height-rule:exactly; font-family:\'Poppins\',Arial,Helvetica,sans-serif;">\n              ul. Chmielna 132/134, 00-805 Warszawa\n            </td>\n          </tr>\n\n          \x3c!-- odstp --\x3e\n          <tr><td style="height:10pt; line-height:10pt; font-size:0;">&nbsp;</td></tr>\n\n\x3c!-- ===== IKONY i LOGO (tabela odporna na Outlook + font Poppins) ===== --\x3e\n<tr>\n  <td style="padding:0; line-height:0; font-size:0; mso-line-height-rule:exactly;\n             font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n\n    <table role="presentation" cellpadding="0" cellspacing="0" border="0"\n           style="font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n      <tr>\n        \x3c!-- LinkedIn --\x3e\n        <td valign="middle" style="padding:0; mso-line-height-rule:exactly;">\n          <a href="https://www.linkedin.com/company/akmf/" target="_blank"\n             style="display:block; text-decoration:none !important; text-underline:none;\n                    color:inherit !important; border:0 !important; outline:0 !important;\n                    font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n            <img src="').concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABUCAYAAAAcaxDBAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAS/SURBVHgB7Z1fTFtVHMe/59a4h24dW3Qs2UgK7GUbcbxp0GQ1oejeHJKgJho1WdxexETmkwQWEl+GD+iD6B7Q+DBJlGGi8Q8Y4YXoi4Jh6MtKzfbQ6ZKVQh+2ZL07v8vaFFa6c3t+LLnc3ycplNtD03z6u+f3O+f09ihU4bF4e0LBfUFBHVcKcX2oDuEkCxdzBbjzLtTEjfTU9GYNVaWDJDIC9OtHExAq4KYLrnPy//Tk3MZHIhsP7Iu39zsKn2MtIoWKqDp9xp6O1jUhn03NlD+yTui+puSoDtl3IBihpSaiexvj+ZtL3xaPlYRSZIpM/+j80loeqV4f+ng82eoo908INaNcPJvRycqhPxxVuATBClfpJK5RXkZX+BWCNRSlTkTXmRBYuKNd6lNeHYPAgoJz3NE/WyHwoNw4JaWwDifZ0SVTnQOBFRHKjAhlRoQy8wiYaDhQj1NvnMSJjmfQcLAeudwqFhavYOybn71bWGAR2v1iBwb7ziAW21k6Rvfbnjrm3Uj20EdfIgxEdu5pGoAFJGv84ofYsePRTduQ1GUdsX/M/YPtjnUf2tvzqlG7l3QUhwFroRR9Jhw9csjrW7c71kIbDu43b3tAhD4QyuamLK/ksd2xFrrw9xWjdlevXcflRbO2QcZa6NCwWTk09vVPCAPWZRNFHs2zVEtOVOCf7vkAYcBaKDH7+7wntkVn8t1lxX0ul8fHI2N4r28Yt27dRhhQ9Y3tLhhpOdLsjZKKQ8+wwTaWLxJGieXIbBMzIpQZ61O+7cknjNsuLKaQW1nd0uchYrui3jC3mCBpYoaSZu4hDCysk1ImNWnctvPld3VF8NeWPA+9Ic8n20rzsZW4ei2D2d/mvfnZzV6HLexJ6WFD8wPD588aTdLQvEN3F92e8+TSoIR78jvQfWjL4Wb88v2I8YxXOSSX3ojB98+Ak8AKJZnjF4fWrRLUwqk3OzH13Yjud+2ep0gghVJ0jX46YC2zCA1GaAmHg0AK7e15zdc8rAndXR3eIqMtAY3QrZmopjfK9tSXwr4Mqlu7u5KwQYRu4ETyadgQ+DqUpgg/Gx3HZb1ysHxvOYYqAOoTj+rffvE+R6C7lLV5Xv8EWuiPk7N4++z5+9a1aDREkit9AMMEGnFdGK3tsoPAnvIk8/W3+qsuEtIoqPOVXviFyqhaCazQvsFPjNrR/KzpuleRlsOHUCuBFEqRR2NxUy7o09/PcncsFkWtBFOozxVUSlY/6C7CFJsRWGjKJj+fCdgtQh9MrWWQX0IjdHnFvA+1QUZKzIhQZkQoMyKUGRHKjAhlRoQyI0KZEaHMiFBmRCgzIpQZEcqMCGVGhDIjQpkRocyIUGZEKDMilBn2SxPDjkQoMyKUGRKahcCC7juzJDQNgQUFzDtw3RkILBRcd85RUBMQWIhol9732OvSib4lPAHBApW+vjTZ6GV55eIcBCsKLryrxrytK1azqfSuvU0UrQkIvlEK5/5bmvqK7pf2Alm9mZqO7mlu1FblW8N9oHPQF5mlqdIeKut2q8lnUxMSqeZQZJbL9I5Vari22Qou6VI1DqESMzrvDGQq7Pylqv3X/nh7wtuOQSnqBugq//BuoQb3X514pqk0ylTZQu0uOTdo2VpJWRYAAAAASUVORK5CYII=",'" width="28" height="28" alt="LinkedIn"\n                 style="display:block; border:0; outline:0; -ms-interpolation-mode:bicubic;">\n          </a>\n        </td>\n\n        <td width="11" style="font-size:0; line-height:0;">&nbsp;</td>\n\n        \x3c!-- Strona WWW --\x3e\n        <td valign="middle" style="padding:0; mso-line-height-rule:exactly;">\n          <a href="https://www.akmf.pl/" target="_blank"\n             style="display:block; text-decoration:none !important; text-underline:none;\n                    color:inherit !important; border:0 !important; outline:0 !important;\n                    font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n            <img src="').concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIQAAABUCAYAAABDep+IAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAfUSURBVHgB7ZxNaFxVFMfPnQQRm8ZpF6ZgC2MqaprBxoW0JqBZNGWysorgqmIXCl2lULsQ/Gp1UdBFd4oLW3AhBT8qCDNNFFIh0wQXttJaEJuOtEKy6rSmYCH2ec8kM3Pueffe92b6XqGZ84M2703mvf/ce//3nnPuvFaBh2xuNPsAdE8ogFFQKgcQ5EC4H6lCAOf0z+8VLJ9aqExXXG9Uthc35UZzAXQf178dBWHNEQTBiQz8d9hmjC7+Ql9u1wFQma+0GZ4CYU2ilBoKVOb1nmz/7VvV+Vn6O8MQj+R2va8UHNWHD4KwplE4xgoK67L9oE1xpv56wxC4MqyaQegg9JiP6pXiRn2lqOUQtZxBdf+qD7MgdByBTjozwfIzmFNk8IU7qusDEDN0LHpVyOoF4XjteHV1uAJCx3M7WN6Q0eXlHhAEjd5zOoAh40UQBKglmC9kdAAZAkGoEeRwhZBkUlhF1QwhCA3EEIKBGEIwEEMIBmIIwUAMIRiIIQQDMYRgIIYQDMQQgoEYQjAQQwgGYgjBQAwhGIghBAMxhGAghhAMxBCCgRhCMBBDCAZiCMGgGxJieMfTjeMbN5fg4qX5yGsGB/rh4d6exvnVa4tw9e9F7zW969dBftvWkFan6se5phVU32O7AkiAP859B72rjcMOeXLopchrfvrhMxgkjTv5zWmYOPSJ95o3970MR97d3zifOPSxvm6yLf1ffv4Stmze1Dj//Itv4b2PPvVe89bEXv3nNa/+1WsL8OzzeyEN/Q9129/QfcD1kyKxkFGcKjeO0fV0oG1sebQv9J7C2AhEUdg9bJyX536z6m/Z3Oe9z+DAVmMwkHF2bxvDO7db9S9cutx4De+blj7vs+JkGZIkMUOUZ88b53QJtcE7FokzkPmBZodc/P1ybTba9Atj/s7NWwwbZyCHdzQ/N2rW9UtsYOj7bIxY2o/6vet7nNdg/3D9m/8sQZIkZojSlNkh4xGz3TVgvoFEE/WSmDtDTMD1bYajvPrKbruGZyD5PYtTM9bjlff6J0TBsRr4Vgn+2bhmEiRmCIzb5bnmAEWFjBHHgOU91/FVp0Q6hOtHzVC60hganoEcH7OHK6SW3F1rJne+8MdnOmVwwNN+9tmoflIkWnaWZ5sfcKXR9s7lM502zNeRdIZi5/MO4fouU3J9DD1x9AdZdk+vQ6hBfeGPfy56n7grhE0/CZI1xJwZx50DQoyCDStNmh3pvm67U8v2msuQdKZjp9Is3TWQofht0S+ysOUKf1Qf8wCq78pjeL/Y9JMg4RVCJzk3m0mOK4+gM72ozcDLJttA8vhNTeTSd+URdGAxD+Gx2DaQfIm36aO5qH4+hrFReyaUkG/3XoOc/Po0pEHiO5V0lthmOp9puMxi/Kfx1zaQPH7PzNrjJ+1cW8fychf1efy3DSSP3zZ9bActP23hh+tj2Lt46TIzcnhCFMaeM3TSyB+QxA1Byz9bHkEHiTaMxl/bQBqd6Cm3zs758whXHkL1bQMZt9yj5act/HD9eh5AJ5JNP7/t8aZ+SuECSdwQofKPDS51Om0Y31iiRuKriq/cigo/9Jzq+xJSfu7bGYwKP/Tc1DcnEjVSaFVLeDOKkrghQuUfW/7pOW0Yj7+0A/gsL02dBZ++kbWz2WbqNwfPl5ByU/uWax5+ePtHHPolT0Lq2h1Ng1S+7aSzDQezvvvGt2tpw3j8pQNJ84eVDl8Ar75jP4Tr0zzAZ2S6qtHdUReu8BfeWHPr0zyGmjOO/t2QjiHmzOUvv62/dkxnB932rUNXDGqkqHKP4wo/XJ/nAdTIVJPGb14RxNGvm9IIVxH6NI8wqrIUdicpKa0QrPxb7Vy6XWtrWJFt7KCRQvE7RrnlCj9R+tzIOIC2qqRV/boR6MDa8hCuj7qoT1c1vteRNKk9IEM/eL0j6HaxLQ5iOOBGclUlPmzhJ7yxFL4PNzIOSNTuaBx9vEc7+mgkV1WSFqkZgmbN2LGYBzSfF3A3jM4c7AxXVRIFDz9R2851qJHRSK6qpBV9bmxfHmDso9Tab69K0iI1Q5RYHD1IHirxNewCGSg+Q1spt3j4OfLO/lj63MiuqqRV/YMTzQdmfHkI3UdBE+WNcjPd/AFJzRC8/IvbsFLoQRd7VRKFb/fRl4f49F27o63q+/KQYugLsvb02yXVh2xdM9HXMF5+Ne5lqUqisHV8VB7CjUz1W30YpR19bqS70W+HVA1hy4jjNKxsMUw75ZZVP0Yctn+Tee/0bUZK8rlJH+muECxrRuI0zP7VduvLJS//kDh5iH0g29Pn3Ev9dkjsqWthbSD/UEcwEEMIBmIIwUAMIRiIIQQDMYRgIIYQDMQQgoEYQjAQQwgGYgjBQAwhGIghBAMxhGAghhAMxBCCARriLxAETQBQRUNcAUHQKIDzmSCAMyAISACnMg/B8jEQBMAVovtUplKZrurjaRA6miBQJxYqpUqtylBB9z79owpCp6KTya7DeNCFfy1V/6z2bOy/rQ8LIHQeCt5evDJZwsOu+mu3rs/Prt/YrxNNGAWhY1AKDi/O/3i0ft5Ff7l0fX5arxQ39OFO/edBENYy1drKQMyAdPF31VaK7BMnAxVs0MvFEAhrkTM6bxyvhwmK8l21KVfIBbC8R79rjz7F/yghC8L9CO5GV3R4mP73zvKx6kplaeV/1KpDcBsGkj8AAAAASUVORK5CYII=",'" width="44" height="28" alt="Strona WWW"\n                 style="display:block; border:0; outline:0; -ms-interpolation-mode:bicubic;">\n          </a>\n        </td>\n\n        <td width="11" style="font-size:0; line-height:0;">&nbsp;</td>\n\n        \x3c!-- Kariera --\x3e\n        <td valign="middle" style="padding:0; mso-line-height-rule:exactly;">\n          <a href="https://www.akmf.pl/kariera" target="_blank"\n             style="display:block; text-decoration:none !important; text-underline:none;\n                    color:inherit !important; border:0 !important; outline:0 !important;\n                    font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n            <img src="').concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIQAAABUCAYAAABDep+IAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAi4SURBVHgB7ZtfTBRHHMd/e5DGVAT0oZgo5kpNU8W0NmmjxaQlKVhITGrRhLSpRkyw2ofiAzZpUiwGH0ylifShWkmKUVNDYil9AqEP2EaK8aHF+CdpFGnQBJ68Q0hqQt3Od2FgZm7vbvf2vBb4fRLkdm9vbtj5zvf3m9+sFiUgP1ya/wxl11lEpWRZYSI7TMx8JEI2/SF+/2TRVOfocN9wvAstt5Mrw6Vhm7LbxLulxCw4bNs+E6J/jrgJI8s8URAuO0hW6IIQw0vELEgsy9poW6E9OflFjycjQwPqe5ognguXfWFZdEy8XELMgsbCGFtUsTS/iIQoLsvzs4KAM8yIgVlEiDEvFU4RlU7h5BBOzmBl/y5e5hOz6LBF0hmyp15FThHCiSdWViOxGBYtwhXyhSG0Oa9n3OEeMYuex/bU8pBYXm4nhhGImtNBhIx3iWHISTDfCokAspEYxsEOwyE4mWRmsBxBMMwsLAhGgwXBaLAgGA0WBKPBgmA0WBCMBguC0WBBMBosCEaDBcFosCAYDRYEo8GCYDRYEIwGC4LRYEEwGiwIRoMFwWiwIBgNFgSjkU0BKV5XRHm5OQmvGXkwRiP3xyiTbSWjZNPL2vGNW0M0/miCgpK7bCmVbH6F1qxeSbm5S51z4+OTov071H/1OqUDs++4H7gv6cAqeL7MpgBc++U8Fa4uSHrdyP1R6h8YpOaWc3E777Wt8fEJ6uq5krCtRGDAOr5v1s41nzhLzV+fo1TBINXX7XbajkfQfjvf49L309910OGjJykdZCxkFIoZU73zHbr263mq/2QXBSFXuEiQtqqrymPP7dxKqVC4qsAZoI4LXyUUAwjab5DOvrsROGSoONZ4+07M+Q3r1s7aJ6g/uJuiwp5b237MSFsqCEmVW7fEnIdgMcv92LojhgvNzmfNvo88GHXCBN7Ddxave0G7Bv3Ge3WfHic/uIkO7fvtezzSKgjcgKoP6l3fq62poqaGA7PHsNf2i71x43Y621KpKC9xZqr7e1s831Q3MSCWY4Bv3LrrhAftenFdfd0uqt4xN5sxs3Fdg0e7rxT9M8WXSt8TkbGQ0drW4cROyfRMLaFUcGureme5p8+q9hoVg9F/ddD1vWS0HD+kDU77xR56e9t+J08yxQCQQ9UdOq71G9TurYpJEuNRUf6GdnxTCE/te+6yHApKRped7T9c0o5NGw3S1ob1ydvCrC7ZNGe53b391N3TP3ssrTcZmOWqdcMR4AxuQjBpbjkbE95Ut4tH3kz+IenqvUKnxcRQ3091gqn8p3WIvLyllEnM+Nt+8ZIQVo92zotL7BMhS6VmfyP5oaHpG3r9zQ9nf/Z4+DxCnQqEDEGrIlTDUapkVBBm/ItGJylVTHv00pY62Ij3iLlm2EAsTmS9cJlixY0QIhAO/OLUDpQfP31HnyFk/O7qnXM4CD5o2MioIMwl02/KQPhlX8172vHN23cTXm+GC1UEiP+SZNa7Yf1a7RjW/bRxC3WSWIfzlkvF46kLwqncibjc8mW9FgMxK1R1+2mv6fMDMW2ZN8ZEvR4gXEj8WG/x+iLtWE3snhZuoU79frXvWIkEIa3LTnR8dKjX07XJ4i5s2azIIeS4VTIRk5NRvWNu5shwIYH13hAOI2ehtF63ZaxZWo8+Sj3seUXNWdz6jslQO3MN+o57lGp5P+NJJTpatu2AU2dIhJPxiz9O/THFgAIQlnLdSZxm+rNz+QvKxybmcjCe9UbHg+93+CEmZ3EJs6bTVlelnlxmRBAQQbeItYebTjpr9WRiSAaWeRjA10SGnixUADN3aT0TW9X0ar0QocqaVcn3XoKwb6++olHDhcSsfQQpZac1ZKBj8aqLqbQly7ooV7d92zj7Xp4oXWNDx+vupBqDMfBuqwKv1mseo5aSSi7kFXW5aYYLFbXvqZThJWkVRLqRN18mjTLZwx+MVYaX3Umz3IuBRwnZDTMkwXrN74BlYzbK8jdWJEF2SRNhhjo/fU+1lP2/FoQKQkSlsg+BzSGIJNk2slnulfmIF2C95mBjUK6IG105M3OLxTIUs7jbh0sgLzBt3cxhnO83Qh2qsV4qsrLvqWyJz5snpmDzp42SL/YTEmGWe/0irdekVSkZy34U+sglsCmGDTn5E2/Dyqtw3fBahjeZNw4BMBAIG9IeccMSzU6z3Os4SpKqIm5krbLMc7Ne5DfYj6idKY7hMxjkqvfrEzqWU0Np+DhGAG7uYIY6rIySFd/MvsMl/IaNeSUI2DVWKmqCiY2h/oHrrgmmmy17KTNDdDI0xbNe1D5QpJK1CwweHnyR+yPOFvhMjQICRj6CFYO59d4g/h63Ppmh7vDRU576jiWq7NN0Gf6Ur0cD591DtigVq2txmWCaxJSqfew5qKEpkfXWfNQYs3OJEIWnp/4c7HSKdPjBo4HIedzEYIYf+Z1qqPPTd0wOtR2/O6Dz8qlr02Kdp4+MGB5T7vVQr5CYxZ9463o4FpwCxTE/lUG0j+W5mxiAW6jzitmm3x3QeSkIzBjzJpkJprlF3dXjfRWA9v3sgKIvGGAIoz/Ohh0KWniGA9ch18B3xMMUoJ88wNy99bsDGvipa8Yd5A2wbAxQVIhhPMMl71RhQTAa/D+3GA0WBKPBgmA0WBCMBguC0WBBMBosCEaDBcFosCAYDRYEo8GCYDRYEIwGC4LRYEEwGiwIRgOC+IsYRmATRSCIe8QwAotoMGTbdJkYBtjUGXqWpk4QwxAcIrszNDzcFxGv+4hZ1Ni2dWZ0uHvYWWVYdnaN+BUhZrEiksmsI3iRhX8mInciOSuKHouXFcQsPiz6bOxeTzdeZslzkw+HBpatKBKJJpUSs2iwLDoyNvTzMXmcpb458XCoTzhFVLzcLH6WELOQiTjOoIgBZJlXOU6R/2K7bdnLhV1sJGYhclnkjZUyTKhYiT61MlwRtmlqu7hquzjE/57NJ2Y+gmr0sAgPfX8/mToRmV5ZuvIvxLzy9BstY0oAAAAASUVORK5CYII=",'" width="44" height="28" alt="Kariera"\n                 style="display:block; border:0; outline:0; -ms-interpolation-mode:bicubic;">\n          </a>\n        </td>\n\n        <td width="11" style="font-size:0; line-height:0;">&nbsp;</td>\n\n        \x3c!-- RODO --\x3e\n        <td valign="middle" style="padding:0; mso-line-height-rule:exactly;">\n          <a href="https://www.akmf.pl/polityka-prywatnosci/" target="_blank"\n             style="display:block; text-decoration:none !important; text-underline:none;\n                    color:inherit !important; border:0 !important; outline:0 !important;\n                    font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n            <img src="').concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIQAAABUCAYAAABDep+IAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAhpSURBVHgB7ZtfTBRHHMd/e5CmqQqnD4XE0lzRNFVJtQ9Gg2lLIlJITWqpCbEpRpr4h5diUmjSpChIH4zwAH2oVZNC1NSaWGofjBRsgjZQGpu0GtEXRVo1gScPCklNqNv57rF0Zm7vbu9ujwvc75Mct7s3OzO7853f/OY3g0FR8AdK/M9Qdp1BVEKGESAyA8QsRIJk0h/i+weDZi6OjfaPRkpoOF3MD5QETMruFL+WELPoME2zy0f/NjsJI0u/kBcoPUiG75wQwyvELEoMw9hgGr49S/2FT6aDI0Pyb4ogng+UHjYMOioOnyVmUWOgjQ0qX+IvJCGKq/b1OUHAMsyKgckgRJuXCEsxYVsKy4ewfAYj+3dx6Ccm4zCF0+kzZ16DT+HDhadGVhOxGDIWYRX8wiB0Wsez1uE+MRnPE3NmuU9ML3cQwwhEzOkghox3iGHIcjDf9IkBZAMxjIUZgIVgZ5KZxbAEwTBzsCAYBRYEo8CCYBRYEIwCC4JRYEEwCiwIRoEFwSiwIBgFFgSjwIJgFFgQjAILglFgQTAKLAhGgQXBKLAgGAUWBKPAgmAUWBCMQjalgHVrCik3Z2nUNA8ejdODh+OULAUv5FHxpvXWt82t2/doWHxQhut8VuYpeTjhVZ1lije9KsrNT7r+XpESQXSdOBLz5YIHD8docOgGtXWcievhc5YtoX01lVS1862o5SB/5H3+u96YedYf3E1V75WRG1Bn5InvRBrNrv++DyspJ0rHsctxU3+vMPJeKjXJY65fO+tKEDJt7aep7YszMdOhR3W0Nli9yi0QRuWu+qiNhzzdCkLGbb1tIIT6uuqoQtC53DtAh1qOz4vFSLkgJien6dadu2FpitasFi9liXKtseVLOtX5fcR86+t2Wy9TB2Z8WJQxMTllCcUpb1DX0Bqxt+mCGPz1RliagpX5jkJ3IzirjGOijJ1lEesPIBSn+rstI1lSLgiYvcr36x3T6Q2MBt34ejVN/j0VlhY960hjrXINjYYhAWXoFG9eT3vFPRXbipXrlbs+FvfdDEuvCyK/cBs5AcHBSqHusjjQYFvfrnWsu9OzAtT9ZGe36DTh96AuTmWkWhRpnWW0dZxWLAIc0Yqy4rB0cPh0MTQKE4qX4yQGgOs1+w9bL12m80SzGMPdm2sdNAqsDEQOx2+ujkIoHa3Owg81brWUxziVbq+1nt9JDABlbHzjAzp/oVcro4FSSdqnnd9e+FE5X7dmVViasJ7VDiF1kxucRLev5l1KFqu3ClHIs46Ksi2W9dDR619zoEnMJO6SG+o+aVWGL1i+RHwdt6RdELqJzc1Vx05YB8wmbNAA8ThxQO+Je+HdJ2ElbDDEocFkYOZl0HiyA4ye71YMNnAo9TxTRdoFoc8WJiamlXP0Ohk0bryg4U66GJoSAUOT3IPXrV2liK1c82H0IcwNiEvoViLeWZxb0i6IqkrVeftF8+7LtYa73DtIiYCpm4zT0JQosi8BsRWtLZw73yIaT06HoSYRerTnRjAuFaRNEAjOtHxWGzYcXO5THzxX6m3o6ZG8+FgM37mnnBcUeNfDbt3W8p61ehCHHG/461FiYrDK0OufIguRkkilDExo9zdtyjU9VGuDOISO/EIjeeSJkOuBD2GjTwPtZ9NjCcnUX7csC1YQ6CXFm6ObNwSvIIaevsSGg0xAd4J1X8srUi6IaMDUQgSRgjMgdN3ucYn36twc7yyCDmZCMvZUFEKXSar+ueq9iQ6dsUi5DwEvHAEWfGr2Nym/5QqTevLr7qimVB470aiJmkoMXUq+2rifDEVa3rZ5h88jxymScQT1+Mawh/WXmRenEi8l5DAOKNMn+BKxgkT6g1dVJjYH12czPX0D5BX61FIOjcvlWMOnQ+DKDXrsYWDoJqWCeZ9l1DW0hQWJdJMrg0BOskElp+CW03pGIjgFnmT0WZMeuEq0jAU7ZOjAnOpBomjxeaegUou2rhGLzhNNynkiwS0nIDSnBSsZPXAFB7v+o2rysgwvSUsc4pTmROIlRTOlSC+PxVhCxlJyLEuBWAemvEVrV89dQz5ebDgpEoGt7nNtSs+FP+QUeNKtIjbjuBFFPGV4RVoEgV7fqqkcViJSAyM9FpLklwpR/HTpuGVOsWVPBud44b/9fFaZ8kIMkZbi3QCHFv5Cl7A4Vy59pTQUnNRDnx93vA8N2KitR0AU16+dCQ0H0pAJEVubgI7Vx1WGV6Rt2olej/UE2/O2HcxIC1fWfgOxZIweb8804lkOtsXgtneNjfSRW7BE3RijoWyrJNc3nvpj2NmjzdJSQZr3Q6iNH8vBtJec4zX5MLNbtx/w3NRCZHv2H7ZWPN1EIUN7HKrj2qgbCtqF9n54GamNRFoDU3C4MC0r3xZa0bQdzGhmHY2KrXAQE5wtfcf1/+nG5zaoeiUEa/os1iPsgFqkzTnR8xizYjL2voYK8exO2/1gEQbF1DJa0C4VpGQL3XyDCOCLQhT4xgufEL1qPl9islj7KGeDW+mu/6IQBOMd/J9bjAILglFgQTAKLAhGgQXBKLAgGAUWBKPAgmAUWBCMAguCUWBBMAosCEaBBcEosCAYBRYEowBB/EkMIzCJghDEfWIYgUF0w2eadJUYBph00fcczbQTwxAsRPZF3+hof1Ac9xOT0Zim0TU22jNqzTIMM7tGfAWJyVSEM5nVjIMs/JkK3g0uXVH4RByWE5N5GPTp+P3eHhxm2demH48MLVtRKBxNKiEmYzAMah4fuXLUPs+Sf5x6PNIvLMWEONwsPs8Ss5gJWpZBEgPI0lNZlsL/8nnTMJcLc7GBmMXIVeE3VtjDhIwR7a78QHnApJkdItUOcYp/0/YTsxBBNHpUDA/9/zydaQ+GZpaO/ActjbEgg1NskQAAAABJRU5ErkJggg==",'" width="44" height="28" alt="RODO"\n                 style="display:block; border:0; outline:0; -ms-interpolation-mode:bicubic;">\n          </a>\n        </td>\n      </tr>\n    </table>\n\n    \x3c!-- odstp pionowy --\x3e\n    <div style="height:14px; line-height:14px; font-size:0;">&nbsp;</div>\n\x3c!-- LOGO dolne --\x3e\n<div style="line-height:1; mso-line-height-rule:at-least;">\n  <a href="https://www.akmf.pl/" target="_blank"\n     style="display:inline-block; text-decoration:none !important; text-underline:none;\n            border:0 !important; outline:0 !important; color:inherit !important;\n            font-family:\'Poppins\', Arial, Helvetica, sans-serif;">\n    <img src="').concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAABwCAYAAADogILwAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAB2pSURBVHgB7Z1tVttI1sdvlQ35OJ4VtLKCJhuIYQXBZGbO6UA6ZgVJVtBmBSErgExC+pxnutuwAtu9gSYriHsF44/TgKuee/VCjF2SZUsqleT7O0eB2MYvcqn+dV9LQAU56w9a27fgQQN2FIAnpPgO6CcewSNEC/9pzf3ZBEBP6Kf2f4exVvpP0HCNx+TlP/eGkBMf/zPYFU3xCopG6S9Hz/dOgWEYhtl4mlABUMC9bQW7Woo2ivYuCrYHW8F9Mv3TtEKhBxHegAuB+zsv+iP8V1/jP9dTpUdTCcPjzt4Y1kBKWliILhSNEPSmay3o9N2v+z0wDMNsEs4KOlm5aIHvSyGe+QIuvwlxcYgd/GenIUW3ASTyw2ul9QimcJmnBc+kA8//GX4nuyjqeyzqDMMwyTgl6CTisinb+OsbWHSZl4DYwQXFDp6l12jBj9GCH96APmFxKZ5QzLv0+zbIAYs6wzBMMit4rIvj4y+D/U/94QDFfID/7YETYr6ARwKD4vKV3uu/fx10gSmEWTEP8UJR94BhGIYxUpqF7ie2gXwNzljj6RHoBka3/C5a7T9NlTr58fneOTC5YBDzCI8tdYZhmHhKsdA/9QdvyNIFd63xtHgNKc9Q2L+yxZ6dBDGPYEudYRgmhuLzzGYIY+Q4aUflZbVjrKbqrRS4SJH+5ywWDaPDg/YuVBzy1myB6JPnI+WfjG9AsaXOMAwzgxVBJ4sKJ+yzFSbsqkPlbztQNDUQ9DD0QrkTq54vFnWGYZgZCne5h+71PzZIzInixbwGZBBzgt3vDMMwMxQm6DRZUza4APkOqh0nZwogo5hHsKgzDMOEFCLoFCvfQKucSUlOYh7hi/pFf8BeEYZhNprcBZ1c7GE9uQcMM0fOYh7hAYs6wzAbTq6C/rk/ehe62BlmgYLEPKLFos4wzCaTi6BH8XIdNIlhmAUKFvMIFnWGYTaWzIIeTdQcL2fisCTmESzqDMNsJJkE3fJEzVSQksYIizrDMBvH2oLOYs4so+QxwqLOMMxGsbagU6tOYDFnYnBkwceizjDMxrCWoAfZ7BwzLx0NQ3AQx7w3LOoMw2wEK2+fenE1+kkrzmYvHQUnh8/bPXAM6tqGYu6U90YATOgAh4jO02Gn/QQYxiFo50i8XryXz/d64BB0zTSnsONvfoUoDROpYHz4r71rYHxW2pzl4y+DfdnwJ2umTNwWc6eaCuEAHwtQez84tokLebmozFPdqb2X/9wbgiU+/TYcCyG+S/nwiQZ9rZT+MJUwLGIjHNP7mSp1/OPzvXOwgI3Xv+iP9Pxtcd87iWnDtFOjxY2YaDto/NG6AfUYv/NSF8LUdVQ0xSv0CO9DYgtxfYnHyWGnOHH/Gec3FWz7/YA8r+G411gGGga+lqd2udNkjWLOTWPKhsU8Na6KOYEzPE1Q0Gg2fgJ3aVFojQSGvlta0ANTGHQN4bk2jYeJFKoLFvjYH+xCcA23GgpK+75JyKm3CXUdxTHYhaX7gYh9wd1J0wt66Eb1gCkPFvPUuCzmZIVBeK7QAt6lnANwH1rQ92miBaYQtjT0wHANaRAntsax0NCNfm/KxisoAQrrhkK+u8rfTe/cCquVQSpBpxMMnNFeLizmqXFZzAkpxYOJslmhnBScaPsVWYBUCj9uLeSigKKr/ajz9BQsQNfy7HugxabtBZyvNcpf2KzMXRM2Ppa+VND9rSnXPMGlovWfD44qw2KeGtfF3J805ywPKeVrqA6tKi1AqoALrnYCXey7izfac7vTxl6ptCZmTi873u8CS7Pct4N6c2fRWn9Bl9RQanWNy5PrG5zQ475YsizwA+/gKsZTWu4IXIEKIb4Hl2ExT43rYk74btXFVNQWWUI2k+NmURre3wn1wArE68QTWqLVCAtWIy5A6LYeMLnwCORrXbKrnTAtKiRa7Hit94oWy2Chm5CjhZ4KJVTvDuD6+ODbewnLUXe0lrXO76DEO/RAjJc9LlHQg1ifcM/Vjl+uFuryFuB89stdRjgoh7O3BVmFuDLFyQsn2ja4BIt5aqog5gS6NI1jLEyOG0IZaDXB62g8dyv9f/i5//vf0PU6P1l6tDhmiyg7dC0ZN7UiV/uBHVc7MZMMN09rS/lx9ULfS8xCl8AxJt4eHjw9N90ZZrXTcQ41hsQ8TZVJrKDTBdsA6VIG7gQtiQ/ogjo/PMivNCEUgHM6SNynWvZMVol1WMxTUxUxn02GmydKjnNNJKfT6QfZWLR+toPPwfW/GQmvpQVsutoJPxkupohZysYzKFDQQ+vcOOcqUJ2XnXI8V1UkNoa+HcT1PHABdAlSTeTLg/abIusMSRCODtpdia+lcfEAZcFinpqqiDnRWBIrdzI23TBnDqu7ZWVEzDLCZGNv4Q68/m2O5/lkuHmKTo7bgpg4Pc77LOarYRT0MBGuC2WDbicc3U8OUchtWi6zwi5gedwiV1jMU1MlMT8LY31Jj6HkONcyyGfLmGbhjOJsyCYYk41pTNu+/tFN2132GNkUBSZuimemW+VcXgezHKPLfZuSXlS5E7fGuInNGJKJUCgeX/RHPfxZePjB/8zPnzo3iFnMs4MxwjewvC9jqzn1M40voWRoYYGWU9fkChUJiadMWgzd4IDOrdoDy0iQKUKMorCQkLHeHI25Hw6qcW3bYBvEu0/9ofHc34J+G30vC4JetnVOk8UU1LFLrpbDTrv3sT8YNvAi1IWJmjg+6pgTP8qExTw7CTFCuggfWOSNRoMsIauCjp6Bn3DRmnrBSlUlwOQPudqf2x3TCXkd82MzKlfsQY6ESckLKK2GwMzgd8KLQZ9AuFfFgss9rEX0oASiidrFuAm9J3pvxbjgxfEhi3kqqibmhLG+10e9nb+ljGYeq0DnX8L0BJhcKcPVTsw3OfKhUKdWHxYfa69fgrYd6qwJi4Iuy8lsr8JETe8tf1FnMU9LFcWcMF1TWsPVYcffAGTRjdYor4f2MjSok6qd/yqAAtbyvaMWMTU58hHqXAmjl6hla7EpgZMu1+GBoCfUIhZKlSbqfEWdxTwtVRXzuGuKyi/9X0yWUNDMw7UJbUI5HuEihMmf1iNonIFFwt7xC9xgyCf0ki4sNvPeTOh/Mdsaa+HO3FMlHgh6XEZrkVRxoo5EHTLtsc1inpaqijlhuqbo87zo7PkWUJwltOVClQmh9Z/USU6CemKrp/imQuGWT78OrJUumpscifMowUqBej9/b96bCYWvtbhwEA23O3hahjx6VEptOmDm/N0nxdGXJEA+A8uECXBjqBgkLmh9dWRMY4hkWMzTUmUxj0uGm00qI0vooj9aSI4rupnHLKbWryGTVToxMqsgznEkdBduxfAMjpvL44LHe1wynIDp1cx/h2Co7sk7OQ7d/te0UJi9LcolKasdsmvcCvUmzZi4t9DDchm7bj4FJ1VuHOC/d5wMV/ojFvPUVFnMia2Y/aTV3fSBmz3OErKWHEetX/EcGw4W84KYqukoZu5ohVtVF4opGW7Wc0QEicCLFQ15J8eph4uIe/J2728C9xa6kHYTcfzB42ADlVW5Ear3CD0b6crZWMzTUnUxJ0TMxCea4tWn/nBmQpWenxY1h2z6k+4QmFqSMHfsfO6P3r3otN9CAVCTI1MyHCXm4bg8e3ib9gxPketmQrQnx3bgCWjNvfYulVMedtpOVFX8z19suc29hY7xFKvu9jIaKBQBWTEUNlj+SBbztNRBzD/+MqAFsme6DyfT7sPjobtx5pH7vPd4faG5Q4PqmO6jDVuK8tD4TY7MtObHJsSM4TytZzoPJi9VSO8CFxnLKgDoOim6SmAL4spP3cG30MNMXIsThzivU+kLuaY+938f6viJmcU8Pdd/oZhX3d0rGrm0yiykmYfryOUlXJO6hANobwqcf0+kYSMs2ZQkZE/y/KxJG6GsQmA9D3by2lvjDuD0EcArs6dTdLdxcYvCfqmm+gpfPDgfAhcglA0vxfe4+NjXSpElnynvJG7cbUP8lsE22iA37/wdDpMe4l8TvoUulvSYzps6NqaYxn4mFvMVuL6pgZjH1veuQbj3+EaBoYp3ODa/xh5aWu2kVzRoEPTAvHOd9yjnHS/jmxytjsqxKiqFp7NFwi4bso8LnYF/4O80VkJPQiuPUrctEGemMQfxi+prG/MVfd6kayLa2ClwuWubroR6WecR5gQSFvMVqIWYE3H1vWviudw5jskHGbjeF8a+73oPwje5kGfjsLz7JQQJ0mnCl2aEn4tiG7ViUnSxBBa6sR6xGOYzfOvEjJVOMaEOi3lqaiPmhOl6orwAHBN7SUfcZMbZvvWHjBzqwme6Dy3Rszziw3FNjtAQuVw6NmMy8vPul0CNi2juXKdxF7rfvwOL+O16HWu01AxXWFbi53QC6lxXGMTSR3Rhdl4WuG/7urCYF09cfS/Vnqcp0fzc//2VqSa3qJ2uGHc46uyd4vf/zJCLE3WRy5RI7Dc5Eou3T++m75fNyzj+rnHuWMgLKaJfAl4nlz/j6ykteyjSq4ScPLCFhpEQqguOIZsW4+dTra6g5vxF+7ezmKelVmJOGDe78Jmmcs3F1eRGMTKm3giYkpfG4HrP1kXOz+sQ5q1w0xhZdI2aatKL6pdAHoujg3YXQxGPfc8VbRhj7sw5ofuoOZKKqRjIDa3/xNe6Io/F4UF718XQcdNqQty0/H2ei8ZFcaJsVAjE3KUSqNqJOXEL+thUU5628xdZadQpbOEOCblwdLDrgUPcCrJG9Wp/JCA3jK8vIdcxeeOLEqR6DRIJ/P7p8S3D36zN8bfnnSf1Z/0Lph3j+2pCYddwKJrn4QFzHuXcqx2OOrulllP/EP89JROOJ3Hx2+AUhJVt8SaHnfbfgbEKiznDMMxmILUtF6yGL8BYhcWcYRhmc5AgxN/AAhh3cC6uXGdYzBmGYTYLiZbz6v76NdAaWNAtwWLOMAyzeUhhyUIXavW6QmZ1WMwZhmE2E8qbtDLxywIzIZkAFnOGYZjNJadimOXcAAt6kbgo5kLDBxZzhmEYOzSBqTyuivmLg3YXGIZhGCtYs9CZYggaLbjnZmcxZxiGsYs1Qd92S3BqQ+DOVm/BLXYu+iPeUIRhGMYiUlN/WgsIt3qI14pgx5/1tx0siB6LOsMwjD2sWeh3ii30ImFRZxiG2Wwkms5fwQJCWNwEZkOJ9hIGtyoKWNQZhmEsIMGSy70hGt8DUzi0lzBa6rRjEIs6wzDMBiGFpYlfg2YL3RLBfuwuivrvZ8AwDMMUgtTCWkvW1sf/DHaBsYKboq67LOoMwzDFQNun2ts0pQH7wFiDRZ1hGGZzkHcWBV0K+QpqTtC1zR1Y1BmGYTYDSY1JbNWiQ83d7v/+ddClrm0s6mlgUWcYhskTQf98+m1wKYR8BhYQIIYvOk/3oIZ86g8H+Pl2wRdOtRcIqTu4uRubOD/sPHWtfp5hGAhaS2/fgqfEtzkD47STw3+5NbetC82JSsH+nYRzNG7HUHECQe8P3giQ78AS6k7tvfzn3hBqxMf+YFcGYhnBop6aeon6RX+k52+LG/MXV6OfQEFv8VmynZOf+wNPgVylx8REg75WSn/48Tk1KcpGOM7+MN2X9vpHQ+NcGMJ0OGmNX3Taj2EFLsh7JmUuHqEbUI9Xnfwvfhud4ht/PX97WgMHhdXbDs6n4bpVx0FjqXzwRRzkaxwPu6GBYgTvH+qpfv/yH1Qqux4ffx30pJQZSlrVkyxz7My4GIc7Q47T/q15fGq8bnczz2VxYz8JpdSJ3ynuFmAIFmk0G7WrScaBP/+ZWux+T8tmut9pkjaJOQmWhOkJ2KVFk3cDJzdckHz131sGaJwpUMbPkOb6p9ePm9BEMH4rxY1QPTBccySaQagumS3tj5MFMdcarvIScxLyz/3ROxTz/+J/e0liTvj3S9iFstAwytFgogVTP9jsqrr4gn4cnBRrEzwN4jrF0umCjBn8LOqp2TxR3wZh9IppFMIfynX/+dZg1nF7B3BKi5P52+n6//Tr4E3S324/9HZ9Q0HZ52YtkjZRwkXUuyQh+fjLYD9mcTNpCJV4HtNC3zV95+haWu35dIlziFDnkC94DhrWPNVF8K2Xu1YfwCKyKc+qvhoi6DM0kl1GLOqp2RxRD6wysb94D7na83OfZoDGbSaLhURsGrO/gMBrJu65Q4vVW/gbcotKdQoVhb5XcrEb7mo9gvg5RDZiwqEK3uexuJkJw3mwIg1psex5BhoLxVwnNAdVt6vlvaArAWvHQdbESxrEVQFdYTTBeEsexqKemvqLOrmTTYvAklztSXhbCrqQgZcdjJVreG+4yyhiceeGIM9FYOlWFwFTWuAYXO/wxjQ/+DkWMYubw+ftHmQkCK2sn1MzvStn7tAx4Zyc6C3zILnKvaCH9ehWvxwaxJ+vRpWtTfeTCdMnLrCop6beoh7GQ73522242jWItxjb3ps7OibXOCFlI3P1S3z8GN7Mh97izk1Wz4WUMDR8bv8AQy8OjE1/iHt8lmxo+n7jxEjMuXvDHIuu+bH55BFsJ4s5fWcnlAR42GmL6KBENErEozFz18zWafROwik9f9yBHo0FQ7M463zmNTAM4lxYWMMobkzS0ZRw3oweSyvfi98GH/CTvAaLaAWnKHJfXMsGX0boplo13uKLOg6UjktZ/nTu8fPsuZX97os61K2kzc+3MC4C7bja9d302jT2UDyG20FW/IPvP489GGhu+dgfHEt04c/fFybIDcP34AkwZ7WLjJ6LcKE0Nt33qT+ciKDg5x6t1fjlQTHX6FFn7/Rz//dnlEvw4DXDBLmoysBf3AjD4obyCJ5nX/jFhTbCN/OeFmImj0g4V9NxDhkJn99oTNB4wHOyEJZC8XoPFsCwcJ/mRWe0SeivvscrgQf7oZfgdieiWJ0HFSF0U/VhPVo4UAaueSbctdRHf9Qh14KIy7dwwdXuT6zmPJpWHtcm7QJoih/PJsjFJcI5kCSYOxqmiQlyZDDElezl4WoPX8sc8sQFw+FB+03Z4Q0MyRiNywZY06nKadMDQSf1j0naKBrKqh1U4cSF9aBrJZDMgp6JcxdFXaI7Lc79WhI74diovKiHMWNv/nZXBEvFZyznMrHHxY8pQS4Udc/wV64kCeZKQllfmFtgNhjikgxX5SwI/Xnzt+e5YMgKhmT2F28V55avFa9K84+cv0HB9ArKwXlRD0s7Mot5hIuiThcLxedY1PNFNsEzlwS5I1hCirbh5klellpC/LhFMUvD7RPHkgRzJb6sD2IXN8tcrmlpKvNGWQUnm6UmLhxQ0njwHkFjXY+sVRYE/TaIi5TlavHrX9M0WrDNJ1948xPzCBb11FRc1Be7lLmS1R41FDH2UtDwBXKE4sdpvYAaRO1c7bMklfXNk/dYiVm8gSuLS3M4wLp1fg+FhugagVIRO9RZz3j0gwS+BUGnQWYr6SCGVtityomStvvJTvkLnULEhEU9NbVxvxNluNqDRJ/h19mDkuFiG4rk37wj1vX+8DEwPuo8PYWak1DW94C8xwouqlqGFxmBAzhmnd8TlBaWqks71CbXdKBrfZceIE1/Ra4gKD85qkctKKlLEpQElS2s1T1pDVjUU1MLUc+zZeeK4HkT3sPDvFAtqjyIxtUyo6GK7V3XhbLJk6+x/MMyWuu/L9zmSEKslGJxHsTFhsXF7xiPuMVDz+VSa6OgO2ClR3iy4VsUZzZj6yTktHMaZaNDzi72JFjUU1N5URcCvnf5/QelYsWJKlqm8SJW0fau6xK63o1Z7zbDMkLo/0LJkOvYFPoRwm6HwMNOu0e9CEz30TztWj+RCBl3R1zCRjmILrkFSdiLLPafFfJlGxMUBYt6aqou6s52SqRmHn+BelK0qE6nRhGbuJJlbRMq6wNDg5upUh/sLW5E6SIl9GIjnWB3vfV3dFuXo4N2Nz7fQw6kEN+BY8QK+ioJG/YQXRJbcsVTmcvF/2VfJZGIU1yEYollCvksLOqpqbSomzqllY968qLztGOlBrlhdPE64fYtAw3a4mfX14Ybd8q8luJ22Csz8/4vmHYAjP3qW9qyVtDcS14D0wFhT/1m0hNQwsbn/u/D+Y5GDuD5ZS7S33t6TINTKz1CIbyWGiY3WzCen5DCgdpqTmEH3Z1ekOXpfyHhABbgEqGow4tn7Q/gCCTqP4cd5bTFUMQSIlHfc7nPtxDiEuOWC/kg4SZFT2y9d1ywdnCSut4OuxbCXPxcBeVM18DUG+F351to69tUfr5QD0og7Iz3gNA6P4eSoOsS57yOdmDOo/3njw6S91qXsIQ0Gakl49GuVSTwfsx7S/5B+/mi0OvZg24jtz3F5IOaV3+nK6ctO7bUU+O8pT69nb6Pcd9529A4A0tM76ZUVz4OG5ss5MnIYBc0D5hao2MWbfj9vy7jOnLROo9wdM4zslTQkzYTYIqHRT01zot66L4zLI71fhm7O8VVszyyuMBgyiGhK2hru4Tvf8vQ6CZICAz6/JdNqIMx1687LBV0YpVmEEz+sKinxmlRD6tHkvYH98AicdUsFGJzL7bP5M00Nnte74d7KHiwhLzGLI7/hb7tGKMeulTtEHq1OuAwzbQPJOviUVCT7QFjnaBUYuQddtrOeEscjqn/EcbUx+AYlM188dvoPZof8xNYK7SMrdZfk5WO8XR6Lw8WQbO7oDH1ZEmO1E5YWXSupvpKKhjfbAXWKeUhoSm4K4T4PlzQZ0qejmskc3M3/ZBiwTCxmTtD5+yiPzg2dX60wNKNklJZ6ASdNO346mQD6LnSQS/CUUvd6X0B4hqJzO48Zovwuj5x4b0w9qEcqSVNbbqUdxTmJn2N8pCkkK+DiqDspW5xu75tN+Uges3YQ0vr5Wxhk58SDCuxv+x8pBZ0glwOOqYBAmMNFvV0OCvqSSWhlLBpu2lFEFJb/O7CMEBV6/yZFOQQG/YgA2EnUA8qBjWegVJEPZmVBJ2gix8c/CAbBot6OpwV9eQe3v4ezFaFNG4XtLCMiakxGbdNbmUZq6IhXkNF8UU9RR9+m6ws6ERSWzzGGj3XXKIs6quR0MPbehc5ciOaEl/DMiYPmFpD1+6LTvsx/nqy6vW7vaaF7ZeqOdDIKwuHB+03LmnhWoJOJLfFY2wghNwHx3BV1LcAnDtXSa73MrrIxWQ9UxlTydtGMrYgYy3o4Y/jMth9zeyK1/pPvP+KQrA3a17rfiOZGnArFBlWTjRjSp3lboIy37eDblNWY36M2ziX/a7g5Oi5Hyqywg2oxws3Ns0TI7ne0VJ5bHyiDFcnfQfG523Gx0oT30sB2H69OG5BYwxZP3QbS/v1xq68j7BU7Dw8/C6bZIUrXNzdBeI9OT7Inll+K0jQVQ+yICATNxIu8T0MIQO0MKeqmi0tT4XQI8gBPDdv1jk3GU9H8GUHHwSc3VKutuAKGl0+u+AoKOpe6S0TUcw3cbMPhmE2j7Vd7hG0OiH3u2vJAUz5lO5+ZzFnGGaDyCzoEZQcAJz9zsxRmqizmDMMs2HkJuiEn/0e1Kk73e+WsYt1UWcxZxhmA8lV0AmqU89Q08jUFGuizmLOMMyGkrugEzR5/4WiznF1ZpbCRZ3FnGGYDaYQQScoWS6Iq6tjttaZiMJEncWcYZgNpzBBjwg6UKm9Dess50STAVfJXdRZzBmGYYoXdIImcCptk0HDjfqKnYaRoi5LSnGoYQm5iTqLOcMwjI8VQY+gSfyw035SOzd8KOTU5MXfdINJRWZRZzFnGIa5x6qgR5AbPtgIoOLCzkKembVFncWcYRjmAaUIekQk7KpaMfYJvtcrFvL8WFnUWcwZhmEWKFXQI0gUv8XY1bHW+gu4Blrjwc5C6jG+130W8nxJLeos5gzDMEYy7baWN7O7/NDGHlOAfaHlPghog30mKOJftFCXtwCXxwf+e2MKJNqlTYPsg2kHPxZzhmGYWDLvtmYD2tGtSRM8iruknwK+x5tbkC++gCvKwkcRv8OfVEsPa3Dx66ALUp5B0Ti+29q6BNs1zm3Ly2LOMAyTiFMWehyhsA7Dw4cseBRdD1ckO1pBSwhJv3vBvdozPY9G0RYgJvhzTL9Lra6VhEko3mNgnCDaXzgSdQ3i7dHzp9b2M2cYhqkilbDQqwYtNpSCXSgYpWHy8h97l1BTQs8MJR7W9jMyDMPkxf8Diybn+dkLwekAAAAASUVORK5CYII=",'" width="187" alt="Aplikacje Krytyczne"\n         style="display:block; height:auto; border:0; outline:0; -ms-interpolation-mode:bicubic;">\n  </a>\n</div>\n\n  </td>\n</tr>\n\n\n\n        </table>\n      </td>\n    </tr>\n  </table>\n</div>\n\n\n')}function kO(e){return kO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kO(e)}function SO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function OO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SO(Object(n),!0).forEach((function(t){CO(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function CO(e,t,n){return(t=function(e){var t=function(e){if("object"!=kO(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=kO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==kO(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TO(){var e=jO(),t=e.m(TO),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function i(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,i){return t.resultName=o,n(r.d,AO(e),i)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(TO=function(){return{wrap:function(t,n,r,o){return e.w(i(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new RO(e,t)},AsyncIterator:EO,async:function(e,t,n,o,a){return(r(t)?xO:PO)(i(e),t,n,o,a)},keys:IO,values:AO}})()}function AO(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(kO(e)+" is not iterable")}function IO(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function PO(e,t,n,r,o){var i=xO(e,t,n,r,o);return i.next().then((function(e){return e.done?e.value:i.next()}))}function xO(e,t,n,r,o){return new EO(jO().w(e,t,n,r),o||Promise)}function EO(e,t){function n(r,o,i,a){try{var c=e[r](o),u=c.value;return u instanceof RO?t.resolve(u.v).then((function(e){n("next",e,i,a)}),(function(e){n("throw",e,i,a)})):t.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,a)}))}catch(e){a(e)}}var r;this.next||(_O(EO.prototype),_O(EO.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),_O(this,"_invoke",(function(e,o,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}),!0)}function jO(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return _O(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function h(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],h=p.p,d=i[2];n>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),c=l,u=d;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(_O(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_O(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,_O(f,"constructor",s),_O(s,"constructor",u),u.displayName="GeneratorFunction",_O(s,o,"GeneratorFunction"),_O(f),_O(f,o,"Generator"),_O(f,r,(function(){return this})),_O(f,"toString",(function(){return"[object Generator]"})),(jO=function(){return{w:i,m:p}})()}function _O(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_O=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){_O(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},_O(e,t,n,r)}function RO(e,t){this.v=e,this.k=t}function NO(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function MO(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){NO(i,r,o,a,c,"next",e)}function c(e){NO(i,r,o,a,c,"throw",e)}a(void 0)}))}}var qO,GO=document.getElementById("sideload-msg"),FO=document.getElementById("btnSignIn"),BO=document.getElementById("item-subject"),HO=document.getElementById("signature-preview"),DO=document.getElementById("chkOverrideClientSignature"),UO="[TP]",LO=function(e,t){var n=(new Date).toISOString();void 0!==t?console.log("".concat(UO," ").concat(n," ").concat(e),t):console.log("".concat(UO," ").concat(n," ").concat(e))},KO=!1,zO={auth:{clientId:"878d3b23-1c7b-436e-b6bd-6500251cb62d",authority:"https://login.microsoftonline.com/common"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}};function QO(){return WO.apply(this,arguments)}function WO(){return WO=MO(TO().mark((function e(){var t,n,r,o,i,a,c,u,s,l,f,p;return TO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(KO){e.next=3;break}return BO&&(BO.innerText="PCA nie zostao zainicjalizowane. Sprawd logi."),e.abrupt("return");case 3:if(t={scopes:["User.Read","openid","profile"]},n=null,e.prev=5,!(r=qO.getAllAccounts()[0])){e.next=13;break}return e.next=10,qO.acquireTokenSilent(OO(OO({},t),{},{account:r}));case 10:o=e.sent,n=o.accessToken,LO("Got access token (silent).");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),LO("Silent token failed",e.t0);case 18:if(n){e.next=30;break}return e.prev=19,e.next=22,qO.acquireTokenPopup(t);case 22:i=e.sent,n=i.accessToken,LO("Got access token (popup)."),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(19),LO("Popup token failed",e.t1);case 30:if(n){e.next=33;break}return BO&&(BO.innerText="Nie udao si zalogowa. Sprbuj ponownie."),e.abrupt("return");case 33:return e.next=35,fetch("https://graph.microsoft.com/v1.0/me?$select=givenName,surname,mail,userPrincipalName,businessPhones,mobilePhone,jobTitle,department,officeLocation,displayName",{headers:{Authorization:"Bearer ".concat(n)}});case 35:if((a=e.sent).ok){e.next=43;break}return e.next=39,a.text();case 39:return c=e.sent,LO("Graph /me failed",{status:a.status,txt:c}),BO&&(BO.innerText="Nie udao si pobra danych z Microsoft Graph."),e.abrupt("return");case 43:return e.next=45,a.json();case 45:if(u=e.sent,LO("Graph /me fetched",u),s={firstName:u.givenName||"",lastName:u.surname||"",email:u.mail||u.userPrincipalName||"",phone:Array.isArray(u.businessPhones)&&u.businessPhones[0]||u.mobilePhone||"",jobTitle:u.jobTitle||"",team:u.department||"",office:u.officeLocation||"",displayName:u.displayName||"".concat(u.givenName||""," ").concat(u.surname||"").trim()},l=wO(s),LO("Built signature HTML",{len:(null==l?void 0:l.length)||0}),HO)try{HO.srcdoc=l,LO("Preview updated.")}catch(e){LO("Preview failed",e)}return BO&&(f=s.displayName||[s.firstName,s.lastName].filter(Boolean).join(" "),BO.innerHTML="Jeste zalogowany jako <b>".concat(f,"</b>.")),p=!(!DO||!DO.checked),e.next=55,YO(s,l,p);case 55:return e.prev=55,e.next=58,$O(l);case 58:LO("Signature inserted from taskpane."),e.next=64;break;case 61:e.prev=61,e.t2=e.catch(55),LO("Insert from taskpane failed",e.t2);case 64:case"end":return e.stop()}}),e,null,[[5,15],[19,27],[55,61]])}))),WO.apply(this,arguments)}function YO(e,t,n){return VO.apply(this,arguments)}function VO(){return VO=MO(TO().mark((function e(t,n,r){var o;return TO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,LO("Saving to roamingSettings...",{hasHtml:!!n,htmlLen:(null==n?void 0:n.length)||0,profile:t});try{localStorage.setItem("user_info",JSON.stringify(t))}catch(e){LO("localStorage set error (non-fatal)",e)}return Office.context.roamingSettings.set("user_info",JSON.stringify(t)),Office.context.roamingSettings.set("signature_html",n),Office.context.roamingSettings.set("override_olk_signature",r?"1":"0"),e.next=8,new Promise((function(e){Office.context.roamingSettings.saveAsync(function(){var t=MO(TO().mark((function t(r){var o,i,a,c;return TO().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:LO("roamingSettings.saveAsync",{status:null==r?void 0:r.status,error:null==r?void 0:r.error});try{o=Office.context.roamingSettings.get("signature_html"),LO("roamingSettings read-back signature_html len",(null==o?void 0:o.length)||0)}catch(e){LO("roamingSettings read-back error",e)}if(console.log("[TP] platform:",Office.context.platform),console.log("[TP] has sessionData:",!!Office.sessionData),console.log("[TP] has setAsync:",!(!Office.sessionData||!Office.sessionData.setAsync)),console.log("[TP] has getAsync:",!(!Office.sessionData||!Office.sessionData.getAsync)),t.prev=6,Office.context.platform!==Office.PlatformType.PC||null===(i=Office.sessionData)||void 0===i||!i.setAsync){t.next=17;break}return t.next=10,new Promise((function(e){return Office.sessionData.setAsync("signature_html",n,(function(){return e()}))}));case 10:return t.next=12,new Promise((function(e){return Office.sessionData.setAsync("isAuthenticated","1",(function(){return e()}))}));case 12:return console.log("[TP] sessionData set: signature_html + isAuthenticated=1"),t.next=15,new Promise((function(e){return Office.sessionData.getAsync("signature_html",(function(t){return e(null==t?void 0:t.value)}))}));case 15:a=t.sent,console.log("[TP] sessionData read-back len:",a?a.length:0);case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(6),console.log("[TP] sessionData set/get error:",t.t0);case 22:try{null===(c=Office.context.mailbox.item)||void 0===c||null===(c=c.notificationMessages)||void 0===c||c.replaceAsync("sig_saved",{type:"insightMessage",message:"Podpis zapisany w pamici dodatku.",icon:"Icon.16x16",persistent:!1},(function(){}))}catch(e){}e();case 24:case"end":return t.stop()}}),t,null,[[6,19]])})));return function(e){return t.apply(this,arguments)}}())}));case 8:try{r&&null!==(o=Office.context.mailbox.item)&&void 0!==o&&o.disableClientSignatureAsync&&(Office.context.mailbox.item.disableClientSignatureAsync((function(){})),LO("Client signature disabled on current item."))}catch(e){LO("disableClientSignatureAsync error (non-fatal)",e)}e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),LO("Error saving signature to storage",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),VO.apply(this,arguments)}function JO(e){return new Promise((function(t){return setTimeout(t,e)}))}function ZO(){return XO.apply(this,arguments)}function XO(){return XO=MO(TO().mark((function e(){var t,n,r,o,i=arguments;return TO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:10,n=i.length>1&&void 0!==i[1]?i[1]:150,r=0;case 3:if(!(r<t)){e.next=11;break}if(null===(o=Office)||void 0===o||null===(o=o.context)||void 0===o||null===(o=o.mailbox)||void 0===o||null===(o=o.item)||void 0===o||!o.body){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,JO(n);case 8:r++,e.next=3;break;case 11:throw new Error("Body nie jest gotowe do edycji.");case 12:case"end":return e.stop()}}),e)}))),XO.apply(this,arguments)}function $O(e){return eC.apply(this,arguments)}function eC(){return(eC=MO(TO().mark((function e(t){var n,r,o,i,a;return TO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ZO();case 2:if(o=Office.context.mailbox.item,i=o.itemType===Office.MailboxEnums.ItemType.Message,a="function"==typeof(null===(n=Office)||void 0===n||null===(n=n.context)||void 0===n||null===(n=n.requirements)||void 0===n?void 0:n.isSetSupported)&&Office.context.requirements.isSetSupported("Mailbox","1.10")&&(null===(r=o.body)||void 0===r?void 0:r.setSignatureAsync),LO("insertSignatureFromTaskpane method",{isMessage:i,canUseSetSignature:a}),!i||!a){e.next=10;break}return e.next=9,new Promise((function(e,n){o.body.setSignatureAsync(t,{coercionType:Office.CoercionType.Html},(function(t){return t.status===Office.AsyncResultStatus.Succeeded?e():n(t.error)}))}));case 9:return e.abrupt("return");case 10:return e.next=12,new Promise((function(e,n){o.body.setAsync("<br/><br/>"+t,{coercionType:Office.CoercionType.Html},(function(t){return t.status===Office.AsyncResultStatus.Succeeded?e():n(t.error)}))}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady(function(){var e=MO(TO().mark((function e(t){var n,r;return TO().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.host===Office.HostType.Outlook){e.next=2;break}return e.abrupt("return");case 2:return GO&&(GO.style.display="none"),(n=document.getElementById("app-body"))&&(n.style.display="flex"),FO&&(FO.onclick=QO),e.prev=6,e.next=9,vO(zO);case 9:qO=e.sent,(r=qO.getAllAccounts()[0])&&qO.setActiveAccount(r),KO=!0,LO("PCA initialized.",{accounts:qO.getAllAccounts()}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),LO("Error creating PCA",e.t0);case 19:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t){return e.apply(this,arguments)}}())}(),new URL(n(81499),n.b),new URL(n(58394),n.b),new URL(n(80517),n.b)}();
//# sourceMappingURL=taskpane.js.map